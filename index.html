<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facebook Ads Dashboard - Unified Analytics Platform</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #1877f2;
            --primary-dark: #166fe5;
            --success-color: #00a67e;
            --warning-color: #f5a623;
            --danger-color: #e74c3c;
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-primary: #1c1e21;
            --text-secondary: #65676b;
            --border-color: #dddfe2;
            --sidebar-width: 260px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.5;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: var(--sidebar-width);
            height: 100vh;
            background: var(--card-bg);
            border-right: 1px solid var(--border-color);
            padding: 0;
            overflow-y: auto;
            z-index: 100;
        }

        .logo {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 12px;
            min-height: 73px;
            display: flex;
            align-items: center;
            box-sizing: border-box;
        }

        .logo h1 {
            font-size: 18px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 0;
        }

        .logo h1 i {
            font-size: 24px;
        }

        .nav-section {
            padding: 8px 12px 0;
            margin-bottom: 20px;
        }

        .nav-section-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            padding: 0 8px;
            margin-bottom: 8px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-primary);
            text-decoration: none;
        }

        .nav-item:hover {
            background: var(--bg-color);
        }

        .nav-item.active {
            background: #e7f3ff;
            color: var(--primary-color);
        }

        .nav-item i {
            width: 20px;
            text-align: center;
            font-size: 16px;
        }

        .nav-item span {
            font-size: 14px;
            font-weight: 500;
        }

        .nav-item .badge {
            margin-left: auto;
            background: var(--danger-color);
            color: white;
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 10px;
        }

        /* Submenu Styles */
        .nav-item-parent {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-primary);
        }

        .nav-item-parent:hover {
            background: var(--bg-color);
        }

        .nav-item-parent.active {
            background: #e7f3ff;
            color: var(--primary-color);
        }

        .nav-item-parent .nav-item-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .nav-item-parent i.fa-chevron-down {
            font-size: 12px;
            transition: transform 0.3s;
        }

        .nav-item-parent.expanded i.fa-chevron-down {
            transform: rotate(180deg);
        }

        .submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            background: #f8f9fa;
            border-radius: 0 0 8px 8px;
            margin-top: -4px;
        }

        .submenu.open {
            max-height: 500px;
        }

        .submenu-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px 10px 44px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 13px;
        }

        .submenu-item:hover {
            background: #e9ecef;
            color: var(--text-primary);
        }

        .submenu-item.active {
            color: var(--primary-color);
            background: #e7f3ff;
        }

        .submenu-item i {
            font-size: 12px;
            width: 16px;
            text-align: center;
        }

        .submenu-item .submenu-badge {
            margin-left: auto;
            background: var(--primary-color);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
        }

        .submenu-item .submenu-badge.warning {
            background: var(--warning-color);
        }

        .submenu-item .submenu-badge.danger {
            background: var(--danger-color);
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: var(--card-bg);
            padding: 16px 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header-left h2 {
            font-size: 20px;
            font-weight: 600;
        }

        .header-left p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-color);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
        }

        .header-icon:hover {
            background: #e4e6e9;
        }

        .header-icon .notification-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: var(--danger-color);
            color: white;
            font-size: 10px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
        }

        /* Account Switcher Dropdown */
        .account-switcher {
            position: relative;
        }

        .account-switcher-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 16px;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 240px;
        }

        .account-switcher-btn:hover {
            border-color: var(--primary-color);
            background: #f8f9fa;
        }

        .account-switcher-btn .account-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: linear-gradient(135deg, #1877f2, #42b72a);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
        }

        .account-switcher-btn .account-info {
            flex: 1;
            text-align: left;
        }

        .account-switcher-btn .account-label {
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-weight: 500;
        }

        .account-switcher-btn .account-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            white-space: nowrap;
        }

        .account-switcher-btn .chevron {
            color: var(--text-secondary);
            transition: transform 0.2s;
        }

        .account-switcher-btn.open .chevron {
            transform: rotate(180deg);
        }

        .account-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            left: 0;
            min-width: 280px;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 200;
            display: none;
            overflow: hidden;
        }

        .account-dropdown.show {
            display: block;
        }

        .account-dropdown-header {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        .account-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .account-option:hover {
            background: #f8f9fa;
        }

        .account-option.active {
            background: #e7f3ff;
        }

        .account-option .option-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
        }

        .account-option .option-icon.connect {
            background: linear-gradient(135deg, #1877f2, #42b72a);
        }

        .account-option .option-icon.chatflow {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
        }

        .account-option .option-icon.psb {
            background: linear-gradient(135deg, #f59e0b, #ef4444);
        }

        .account-option .option-icon.email {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .account-option .option-info {
            flex: 1;
            min-width: 0;
        }

        .account-option .option-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            white-space: nowrap;
        }

        .account-option .option-status {
            font-size: 12px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .account-option .option-status .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--success-color);
        }

        .account-option .check-icon {
            color: var(--primary-color);
            font-size: 16px;
            opacity: 0;
        }

        .account-option.active .check-icon {
            opacity: 1;
        }

        /* Tabs */
        .tabs-container {
            display: flex;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: 20px;
            gap: 0;
        }

        .tab-btn {
            padding: 12px 24px;
            background: none;
            border: none;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover {
            color: var(--text-primary);
            background: #f8f9fa;
        }

        .tab-btn.active {
            color: var(--primary-color);
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary-color);
        }

        .tab-btn .tab-badge {
            background: var(--danger-color);
            color: white;
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 10px;
        }

        .tab-btn .tab-badge.success {
            background: var(--success-color);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Dashboard Sections - Hidden by default, shown when active */
        .dashboard-section {
            display: none;
        }

        .dashboard-section.active {
            display: block;
        }

        /* For metrics grid which uses CSS Grid */
        .metrics-grid.dashboard-section.active {
            display: grid;
        }

        /* Section Page Title */
        .section-page-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 24px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-page-title i {
            color: var(--primary-color);
        }

        /* Resolved Alerts */
        .alert-item.resolved {
            opacity: 0.8;
        }

        .resolution-note {
            margin-top: 10px;
            padding: 10px;
            background: #f0f9f4;
            border-left: 3px solid var(--success-color);
            border-radius: 4px;
            font-size: 13px;
        }

        /* History Filters */
        .history-filters {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }

        .history-table {
            font-size: 13px;
        }

        .alert-type-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .alert-type-badge.danger {
            background: #ffe0e0;
            color: var(--danger-color);
        }

        .alert-type-badge.warning {
            background: #fff3e0;
            color: #e67e22;
        }

        .alert-type-badge.success {
            background: #e0f7e9;
            color: var(--success-color);
        }

        /* Configure Alerts */
        .config-section {
            background: var(--bg-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .config-section h4 {
            margin-bottom: 16px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .config-section h4 i {
            color: var(--primary-color);
        }

        .config-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .config-grid.full-width {
            grid-template-columns: 1fr;
        }

        .config-item label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }

        .config-input-group {
            position: relative;
        }

        .config-input-group .currency {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 14px;
        }

        .config-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }

        .config-input-group .currency + .config-input {
            padding-left: 28px;
        }

        .config-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(24, 119, 242, 0.1);
        }

        .config-input.full {
            width: 100%;
        }

        .input-help {
            display: block;
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 6px;
        }

        .config-toggles {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 16px;
        }

        .toggle-item {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .toggle-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary-color);
        }

        .toggle-label {
            font-size: 13px;
            color: var(--text-primary);
        }

        .config-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: white;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .btn-secondary:hover {
            background: var(--bg-color);
        }

        /* Filter Bar */
        .filter-bar {
            background: var(--card-bg);
            padding: 16px 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-group label {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .filter-select {
            padding: 8px 32px 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            background: white url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2365676b' d='M6 8L1 3h10z'/%3E%3C/svg%3E") no-repeat right 10px center;
            appearance: none;
            cursor: pointer;
            min-width: 150px;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .refresh-btn {
            padding: 8px 16px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .refresh-btn:hover {
            background: var(--primary-dark);
        }

        .last-sync {
            font-size: 12px;
            color: var(--text-secondary);
            margin-left: auto;
        }

        /* Dashboard Content */
        .dashboard-content {
            padding: 24px;
        }

        /* Section scroll offset for sticky header */
        [id$="-section"] {
            scroll-margin-top: 140px;
        }

        /* Metrics Cards */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .metric-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
        }

        .metric-card .metric-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .metric-card .metric-label {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .metric-card .metric-label .info-icon {
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 12px;
        }

        .metric-card .metric-label .info-icon:hover {
            color: var(--primary-color);
        }

        .metric-card .metric-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .metric-card .metric-icon.blue {
            background: #e7f3ff;
            color: var(--primary-color);
        }

        .metric-card .metric-icon.green {
            background: #e6f7f1;
            color: var(--success-color);
        }

        .metric-card .metric-icon.orange {
            background: #fff4e5;
            color: var(--warning-color);
        }

        .metric-card .metric-icon.purple {
            background: #f3e8ff;
            color: #9333ea;
        }

        .metric-card .metric-icon.red {
            background: #fde8e8;
            color: var(--danger-color);
        }

        .metric-card .metric-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .metric-card .metric-change {
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .metric-card .metric-change.positive {
            color: var(--success-color);
        }

        .metric-card .metric-change.negative {
            color: var(--danger-color);
        }

        /* Pixel Status Card */
        .pixel-status {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .pixel-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .pixel-dot.active {
            background: var(--success-color);
        }

        .pixel-dot.inactive {
            background: var(--danger-color);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Tables */
        .table-section {
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 24px;
            overflow: hidden;
        }

        .table-header {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-start;
            align-items: center;
            gap: 12px;
        }

        .table-header .btn-primary {
            padding: 6px 14px;
            font-size: 12px;
        }

        .table-header h3 {
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .table-header h3 .count {
            background: var(--bg-color);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .table-filter {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .table-search-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .table-search-icon {
            position: absolute;
            left: 10px;
            color: #9ca3af;
            font-size: 12px;
            pointer-events: none;
        }

        .table-search-input {
            padding: 7px 12px 7px 30px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--card-bg);
            color: var(--text-primary);
            font-size: 13px;
            min-width: 180px;
            transition: all 0.2s ease;
        }

        .table-search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.15);
        }

        .table-search-input::placeholder {
            color: #9ca3af;
        }

        .table-status-filter {
            padding: 7px 14px 7px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--card-bg);
            color: var(--text-primary);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            min-width: 100px;
            transition: all 0.2s ease;
            border-left-width: 3px;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            padding-right: 30px;
        }

        .table-status-filter:hover {
            border-color: #9ca3af;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
        }

        .table-status-filter:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.15);
        }

        /* Active filter state - Green left border accent */
        .table-status-filter.filter-active {
            background: var(--card-bg);
            border-left-color: #22c55e;
            color: var(--text-primary);
        }

        .table-status-filter.filter-active::before {
            background: #22c55e;
        }

        /* Paused filter state - Orange left border accent */
        .table-status-filter.filter-paused {
            background: var(--card-bg);
            border-left-color: #f59e0b;
            color: var(--text-primary);
        }

        /* All filter state - Blue left border accent */
        .table-status-filter.filter-all {
            background: var(--card-bg);
            border-left-color: #3b82f6;
            color: var(--text-primary);
        }

        .table-actions {
            display: flex;
            gap: 8px;
        }

        .table-btn {
            padding: 6px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: white;
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .table-btn:hover {
            background: var(--bg-color);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            text-align: left;
            padding: 10px 16px;
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            background: #fafbfc;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            user-select: none;
            white-space: nowrap;
        }

        .data-table th:hover {
            background: #f0f2f5;
        }

        .data-table th .sort-icon {
            margin-left: 4px;
            opacity: 0.5;
        }

        .data-table th.sorted .sort-icon {
            opacity: 1;
            color: var(--primary-color);
        }

        .data-table td {
            padding: 10px 16px;
            font-size: 13px;
            border-bottom: 1px solid var(--border-color);
        }


        .data-table tr:last-child td {
            border-bottom: none;
        }

        .data-table tr:hover {
            background: #fafbfc;
        }

        .data-table .name-cell {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .data-table .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .data-table .status-badge.active {
            background: #e6f7f1;
            color: var(--success-color);
        }

        .data-table .status-badge.paused {
            background: #fff4e5;
            color: var(--warning-color);
        }

        .data-table .roas-value {
            font-weight: 600;
        }

        .data-table .roas-value.good {
            color: var(--success-color);
        }

        .data-table .roas-value.warning {
            color: var(--warning-color);
        }

        .data-table .roas-value.bad {
            color: var(--danger-color);
        }

        .data-table .action-btn {
            padding: 6px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .data-table .action-btn.view {
            background: #e7f3ff;
            color: var(--primary-color);
        }

        .data-table .action-btn.view:hover {
            background: #d0e8ff;
        }

        /* Creative Thumbnail with Hover Preview */
        .creative-thumbnail {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .creative-thumbnail:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border-color: var(--primary-color);
        }

        .creative-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Creative Preview Modal */
        .creative-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }

        .creative-modal.show {
            display: flex;
        }

        .creative-modal-content {
            position: relative;
            max-width: 500px;
            max-height: 80vh;
            background: white;
            border-radius: 12px;
            padding: 8px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .creative-modal-content img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            display: block;
        }

        .creative-modal-close {
            position: absolute;
            top: -12px;
            right: -12px;
            width: 32px;
            height: 32px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .creative-modal-close:hover {
            background: var(--danger-color);
            color: white;
        }

        /* Table Pagination - Professional Style */
        .table-pagination {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 24px;
            padding: 16px 20px;
            border-top: 1px solid var(--border-color);
            background: #fafbfc;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .pagination-left,
        .pagination-center,
        .pagination-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .pagination-select {
            padding: 4px 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: white;
            font-size: 13px;
            color: var(--text-primary);
            cursor: pointer;
        }

        .pagination-select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .pagination-input {
            width: 40px;
            padding: 4px 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            text-align: center;
            font-size: 13px;
            color: var(--text-primary);
        }

        .pagination-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .pagination-input::-webkit-outer-spin-button,
        .pagination-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .pagination-arrow {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-secondary);
        }

        .pagination-arrow:hover:not(:disabled) {
            background: var(--bg-color);
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .pagination-arrow:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        /* Task Management System */
        .task-tabs {
            display: flex;
            gap: 0;
            border-bottom: 1px solid var(--border-color);
            background: var(--card-bg);
        }

        .task-tab {
            padding: 14px 24px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .task-tab:hover {
            color: var(--text-color);
            background: var(--bg-color);
        }

        .task-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .task-tab .tab-count {
            background: var(--bg-color);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
        }

        .task-tab.active .tab-count {
            background: rgba(24, 119, 242, 0.1);
            color: var(--primary-color);
        }

        .task-content {
            display: none;
        }

        .task-content.active {
            display: block;
        }

        .task-list {
            padding: 0;
        }

        .task-item {
            border-bottom: 1px solid var(--border-color);
            background: var(--card-bg);
            transition: background 0.2s;
        }

        .task-item:hover {
            background: var(--bg-color);
        }

        .task-item-header {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            gap: 16px;
            cursor: pointer;
        }

        .task-priority {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            min-width: 70px;
            text-align: center;
        }

        .task-priority.critical {
            background: #fef2f2;
            color: #dc2626;
        }

        .task-priority.warning {
            background: #fff7ed;
            color: #f97316;
        }

        .task-priority.opportunity {
            background: #f0fdf4;
            color: #22c55e;
        }

        .task-info {
            flex: 1;
            min-width: 0;
        }

        .task-title {
            font-weight: 600;
            color: var(--text-color);
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .task-title .task-type {
            font-size: 11px;
            color: var(--text-secondary);
            font-weight: 500;
            background: var(--bg-color);
            padding: 2px 6px;
            border-radius: 3px;
        }

        .task-meta {
            display: flex;
            gap: 20px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .task-meta span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .task-metrics {
            display: flex;
            gap: 24px;
            font-size: 13px;
        }

        .task-metric {
            text-align: right;
        }

        .task-metric-label {
            color: var(--text-secondary);
            font-size: 11px;
            margin-bottom: 2px;
        }

        .task-metric-value {
            font-weight: 600;
            color: var(--text-color);
        }

        .task-status-select {
            padding: 6px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 12px;
            background: white;
            cursor: pointer;
            min-width: 100px;
        }

        .task-status-select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .task-expand-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: none;
            cursor: pointer;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .task-expand-btn:hover {
            background: var(--bg-color);
            color: var(--primary-color);
        }

        .task-expand-btn i {
            transition: transform 0.2s;
        }

        .task-item.expanded .task-expand-btn i {
            transform: rotate(180deg);
        }

        .task-details {
            display: none;
            padding: 0 20px 20px 20px;
            margin-left: 106px;
            border-top: 1px solid var(--border-color);
            background: var(--bg-color);
        }

        .task-item.expanded .task-details {
            display: block;
        }

        .task-details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding-top: 16px;
        }

        .task-detail-section h4 {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-bottom: 12px;
        }

        .task-threshold-info {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
        }

        .task-threshold-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            font-size: 13px;
        }

        .task-threshold-row:not(:last-child) {
            border-bottom: 1px solid var(--border-color);
        }

        .task-comments {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
        }

        .task-comment {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .task-comment:last-child {
            border-bottom: none;
        }

        .task-comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 12px;
        }

        .task-comment-author {
            font-weight: 600;
            color: var(--text-color);
        }

        .task-comment-time {
            color: var(--text-secondary);
        }

        .task-comment-text {
            font-size: 13px;
            color: var(--text-color);
            line-height: 1.5;
        }

        .task-add-comment {
            display: flex;
            gap: 8px;
            margin-top: 16px;
        }

        .task-comment-input {
            flex: 1;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 13px;
            resize: none;
        }

        .task-comment-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .task-comment-btn {
            padding: 10px 16px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
        }

        .task-comment-btn:hover {
            background: #1565c0;
        }

        .task-actions-row {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
        }

        .task-action-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: white;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .task-action-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .task-action-btn.primary {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .task-action-btn.primary:hover {
            background: #1565c0;
        }

        .task-action-btn.danger {
            color: #dc2626;
            border-color: #dc2626;
        }

        .task-action-btn.danger:hover {
            background: #fef2f2;
        }

        .no-tasks {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .no-tasks i {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.3;
        }

        .no-tasks p {
            font-size: 14px;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            position: relative;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-height: 90vh;
            overflow: hidden;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-close {
            width: 32px;
            height: 32px;
            border: none;
            background: var(--bg-color);
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: #fee2e2;
            color: #dc2626;
        }

        .modal-body {
            overflow-y: auto;
            max-height: calc(90vh - 140px);
        }

        /* Action Menu (Three Dots) */
        .action-menu {
            position: relative;
            display: inline-block;
        }

        .action-menu-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .action-menu-btn:hover {
            background: var(--bg-color);
            color: var(--text-color);
        }

        .action-menu-dropdown {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            min-width: 120px;
            z-index: 100;
            overflow: hidden;
        }

        .action-menu.open .action-menu-dropdown {
            display: block;
        }

        .action-menu-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 14px;
            font-size: 13px;
            color: var(--text-color);
            cursor: pointer;
            transition: background 0.2s;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
        }

        .action-menu-item:hover {
            background: var(--bg-color);
        }

        .action-menu-item.delete {
            color: #dc2626;
        }

        .action-menu-item.delete:hover {
            background: #fef2f2;
        }

        /* Ad Preview Tooltip */
        .ad-name {
            position: relative;
            cursor: pointer;
            color: var(--primary-color);
        }

        .ad-name:hover .ad-preview {
            display: block;
        }

        .ad-preview {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 100;
            width: 250px;
        }

        .ad-preview img {
            width: 100%;
            height: 140px;
            object-fit: cover;
            border-radius: 6px;
            margin-bottom: 8px;
            background: var(--bg-color);
        }

        .ad-preview .ad-info {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Country Section */
        .country-flag {
            width: 24px;
            height: 18px;
            border-radius: 2px;
            object-fit: cover;
        }

        /* Alerts Section */
        .alerts-panel {
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 24px;
        }

        .alert-item {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .alert-item:last-child {
            border-bottom: none;
        }

        .alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .alert-icon.warning {
            background: #fff4e5;
            color: var(--warning-color);
        }

        .alert-icon.danger {
            background: #fde8e8;
            color: var(--danger-color);
        }

        .alert-icon.success {
            background: #e6f7f1;
            color: var(--success-color);
        }

        .alert-content {
            flex: 1;
        }

        .alert-content h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .alert-content p {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .alert-meta {
            font-size: 12px;
            color: var(--text-secondary);
            display: flex;
            gap: 16px;
        }

        .alert-actions {
            display: flex;
            gap: 8px;
        }

        .alert-btn {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .alert-btn.primary {
            background: var(--primary-color);
            color: white;
            border: none;
        }

        .alert-btn.primary:hover {
            background: var(--primary-dark);
        }

        .alert-btn.secondary {
            background: white;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .alert-btn.secondary:hover {
            background: var(--bg-color);
        }

        /* Notification Panel */
        .notification-panel {
            position: fixed;
            top: 60px;
            right: 24px;
            width: 380px;
            max-height: 500px;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            border: 1px solid var(--border-color);
            z-index: 200;
            display: none;
            overflow: hidden;
        }

        .notification-panel.show {
            display: block;
        }

        .notification-header {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .notification-header h3 {
            font-size: 16px;
            font-weight: 600;
        }

        .mark-all-read {
            font-size: 13px;
            color: var(--primary-color);
            cursor: pointer;
        }

        .notification-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .notification-item {
            padding: 14px 16px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.2s;
        }

        .notification-item:hover {
            background: #fafbfc;
        }

        .notification-item.unread {
            background: #f0f7ff;
        }

        .notification-item .notif-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
        }

        .notification-item .notif-icon.sale {
            background: #e6f7f1;
            color: var(--success-color);
        }

        .notification-item .notif-icon.alert {
            background: #fde8e8;
            color: var(--danger-color);
        }

        .notification-item .notif-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .notification-item .notif-desc {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .notification-item .notif-time {
            font-size: 11px;
            color: var(--text-secondary);
        }

        /* Charts Section */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
            margin-bottom: 24px;
        }

        .chart-card {
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            padding: 20px;
        }

        .chart-card h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .chart-placeholder {
            height: 200px;
            background: var(--bg-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 220px;
            background-color: #333;
            color: #fff;
            text-align: left;
            padding: 10px 12px;
            border-radius: 6px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -110px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
            font-weight: 400;
            line-height: 1.5;
        }

        .tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* Name with tooltip - for Ad Sets and Ads tables */
        .name-with-tooltip {
            position: relative;
            cursor: pointer;
        }

        .name-with-tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 0;
            background-color: #1a1a2e;
            color: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 400;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s, visibility 0.2s;
            z-index: 1000;
            margin-bottom: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .name-with-tooltip::before {
            content: "";
            position: absolute;
            bottom: 100%;
            left: 20px;
            border-width: 6px;
            border-style: solid;
            border-color: #1a1a2e transparent transparent transparent;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s, visibility 0.2s;
            z-index: 1001;
            margin-bottom: -4px;
        }

        .name-with-tooltip:hover::after,
        .name-with-tooltip:hover::before {
            opacity: 1;
            visibility: visible;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .metrics-grid {
                grid-template-columns: 1fr;
            }

            .filter-bar {
                flex-direction: column;
                align-items: stretch;
            }

            .filter-group {
                flex-direction: column;
                align-items: stretch;
            }

            .last-sync {
                margin-left: 0;
                margin-top: 8px;
            }

            .data-table {
                display: block;
                overflow-x: auto;
            }
        }
        /* Auth Screen Styles */
        .auth-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #1877f2 0%, #0a4da6 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        .auth-card {
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 420px;
            padding: 40px;
        }
        .auth-logo {
            text-align: center;
            margin-bottom: 28px;
        }
        .auth-logo i {
            font-size: 36px;
            color: #1877f2;
            margin-bottom: 8px;
        }
        .auth-logo h2 {
            margin: 8px 0 4px;
            font-size: 22px;
            color: #1c1e21;
        }
        .auth-logo p {
            margin: 0;
            font-size: 14px;
            color: #65676b;
        }
        .auth-form-group {
            margin-bottom: 16px;
        }
        .auth-form-group label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            color: #444;
            margin-bottom: 6px;
        }
        .auth-form-group input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            font-family: 'Inter', sans-serif;
            box-sizing: border-box;
            transition: border-color 0.2s;
        }
        .auth-form-group input:focus {
            outline: none;
            border-color: #1877f2;
            box-shadow: 0 0 0 2px rgba(24,119,242,0.15);
        }
        .auth-btn {
            width: 100%;
            padding: 11px;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            transition: background 0.2s;
        }
        .auth-btn-primary {
            background: #1877f2;
            color: #fff;
        }
        .auth-btn-primary:hover {
            background: #166fe5;
        }
        .auth-btn-google {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background: #fff;
            color: #444;
            border: 1px solid #ddd;
            margin-top: 12px;
        }
        .auth-btn-google:hover {
            background: #f7f7f7;
        }
        .auth-btn-google img {
            width: 20px;
            height: 20px;
        }
        .auth-divider {
            display: flex;
            align-items: center;
            margin: 20px 0;
            color: #999;
            font-size: 13px;
        }
        .auth-divider::before, .auth-divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: #ddd;
        }
        .auth-divider::before { margin-right: 12px; }
        .auth-divider::after { margin-left: 12px; }
        .auth-toggle {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: #65676b;
        }
        .auth-toggle a {
            color: #1877f2;
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
        }
        .auth-toggle a:hover {
            text-decoration: underline;
        }
        .auth-error {
            color: #e74c3c;
            font-size: 13px;
            margin-top: 8px;
            display: none;
        }

        /* User Menu Dropdown */
        .user-menu-wrapper {
            position: relative;
        }
        .user-menu-dropdown {
            display: none;
            position: absolute;
            top: 48px;
            right: 0;
            background: #fff;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
            min-width: 220px;
            z-index: 100;
            overflow: hidden;
        }
        .user-menu-dropdown.show {
            display: block;
        }
        .user-menu-info {
            padding: 14px 16px;
            font-size: 13px;
            color: #65676b;
        }
        .user-menu-info strong {
            color: #1c1e21;
        }
        .user-menu-dropdown hr {
            margin: 0;
            border: none;
            border-top: 1px solid #eee;
        }
        .user-menu-dropdown button {
            width: 100%;
            padding: 12px 16px;
            border: none;
            background: none;
            font-size: 14px;
            color: #333;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Inter', sans-serif;
            transition: background 0.15s;
        }
        .user-menu-dropdown button:hover {
            background: #f2f3f5;
        }
    </style>
</head>
<body>
    <!-- Auth Screen -->
    <div id="auth-screen" class="auth-screen">
        <div class="auth-card">
            <div class="auth-logo">
                <i class="fab fa-facebook"></i>
                <h2>Ads Dashboard</h2>
                <p>Sign in to your account</p>
            </div>

            <!-- Login Form -->
            <div id="login-form">
                <div class="auth-form-group">
                    <label>Email</label>
                    <input type="email" id="login-email" placeholder="Enter your email">
                </div>
                <div class="auth-form-group">
                    <label>Password</label>
                    <input type="password" id="login-password" placeholder="Enter your password">
                </div>
                <div id="login-error" class="auth-error"></div>
                <button class="auth-btn auth-btn-primary" onclick="handleLogin()">Sign In</button>
                <div class="auth-divider">or</div>
                <button class="auth-btn auth-btn-google" onclick="handleGoogleSSO()">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google"> Continue with Google
                </button>
                <div class="auth-toggle">
                    Don't have an account? <a onclick="showSignup()">Create Account</a>
                </div>
            </div>

            <!-- Signup Form -->
            <div id="signup-form" style="display:none;">
                <div class="auth-form-group">
                    <label>Full Name</label>
                    <input type="text" id="signup-name" placeholder="Enter your full name">
                </div>
                <div class="auth-form-group">
                    <label>Email</label>
                    <input type="email" id="signup-email" placeholder="Enter your email">
                </div>
                <div class="auth-form-group">
                    <label>Password</label>
                    <input type="password" id="signup-password" placeholder="Create a password">
                </div>
                <div class="auth-form-group">
                    <label>Confirm Password</label>
                    <input type="password" id="signup-confirm" placeholder="Confirm your password">
                </div>
                <div id="signup-error" class="auth-error"></div>
                <button class="auth-btn auth-btn-primary" onclick="handleSignup()">Create Account</button>
                <div class="auth-divider">or</div>
                <button class="auth-btn auth-btn-google" onclick="handleGoogleSSO()">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google"> Continue with Google
                </button>
                <div class="auth-toggle">
                    Already have an account? <a onclick="showLogin()">Sign In</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="logo">
            <h1><i class="fab fa-facebook"></i> Ads Dashboard</h1>
        </div>

        <nav class="nav-section">
            <div class="nav-section-title">Menu</div>

            <!-- Dashboard with Submenu -->
            <div class="nav-menu-group">
                <div class="nav-item-parent active expanded" onclick="toggleSubmenu(this)">
                    <div class="nav-item-left">
                        <i class="fas fa-chart-line"></i>
                        <span>Dashboard</span>
                    </div>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="submenu open">
                    <a href="javascript:void(0)" class="submenu-item active" onclick="showSection('metrics-section', this)">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Overview Metrics</span>
                    </a>
                    <a href="javascript:void(0)" class="submenu-item" onclick="showSection('campaigns-section', this)">
                        <i class="fas fa-bullhorn"></i>
                        <span>Campaigns</span>
                    </a>
                    <a href="javascript:void(0)" class="submenu-item" onclick="showSection('adsets-section', this)">
                        <i class="fas fa-layer-group"></i>
                        <span>Ad Sets</span>
                    </a>
                    <a href="javascript:void(0)" class="submenu-item" onclick="showSection('ads-section', this)">
                        <i class="fas fa-ad"></i>
                        <span>Ads</span>
                    </a>
                    <a href="javascript:void(0)" class="submenu-item" onclick="showSection('country-section', this)">
                        <i class="fas fa-globe"></i>
                        <span>Country Performance</span>
                    </a>
                    <a href="javascript:void(0)" class="submenu-item" onclick="showSection('sales-creative-section', this)">
                        <i class="fas fa-palette"></i>
                        <span>Sales by Ad Creative</span>
                    </a>
                </div>
            </div>

            <!-- Alerts - Simple Link -->
            <a href="javascript:void(0)" class="nav-item" onclick="showSection('alerts-section', this)">
                <i class="fas fa-bell"></i>
                <span>Alerts</span>
            </a>

            <!-- Data Management with Submenu -->
            <div class="nav-menu-group">
                <div class="nav-item-parent" onclick="toggleSubmenu(this)">
                    <div class="nav-item-left">
                        <i class="fas fa-database"></i>
                        <span>Data Management</span>
                    </div>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="submenu">
                    <a href="javascript:void(0)" class="submenu-item" onclick="showSection('pabbly-revenue-section', this)">
                        <i class="fas fa-dollar-sign"></i>
                        <span>Sales Data</span>
                    </a>
                    <a href="javascript:void(0)" class="submenu-item" onclick="showSection('leads-data-section', this)">
                        <i class="fas fa-user-plus"></i>
                        <span>Leads Data</span>
                    </a>
                </div>
            </div>
        </nav>

        <nav class="nav-section">
            <div class="nav-section-title">Settings</div>

            <!-- Settings with Submenu -->
            <div class="nav-menu-group">
                <div class="nav-item-parent" onclick="toggleSubmenu(this)">
                    <div class="nav-item-left">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </div>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="submenu">
                    <a href="javascript:void(0)" class="submenu-item" onclick="showSection('facebook-connection-section', this)">
                        <i class="fab fa-facebook"></i>
                        <span>Facebook Connection</span>
                    </a>
                    <a href="javascript:void(0)" class="submenu-item" onclick="showSection('webhooks-section', this)">
                        <i class="fas fa-plug"></i>
                        <span>Webhook and API</span>
                    </a>
                    <a href="javascript:void(0)" class="submenu-item" onclick="showSection('alert-thresholds-section', this)">
                        <i class="fas fa-bell"></i>
                        <span>Alert & Budget Settings</span>
                    </a>
                    <a href="javascript:void(0)" class="submenu-item" onclick="showSection('user-management-section', this)">
                        <i class="fas fa-user-cog"></i>
                        <span>User Management</span>
                    </a>
                </div>
            </div>
        </nav>

        <nav class="nav-section">
            <div class="nav-section-title">Help</div>

            <!-- Best Practices (SOP) - Simple Link -->
            <a href="#" class="nav-item">
                <i class="fas fa-book"></i>
                <span>Best Practices (SOP)</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <!-- Account Switcher Dropdown -->
                <div class="account-switcher">
                    <div class="account-switcher-btn" onclick="toggleAccountDropdown()">
                        <div class="account-icon">
                            <i class="fas fa-plug"></i>
                        </div>
                        <div class="account-info">
                            <div class="account-label">Ad Account</div>
                            <div class="account-name" id="currentAccountName">Pabbly Connect</div>
                        </div>
                        <i class="fas fa-chevron-down chevron"></i>
                    </div>
                    <div class="account-dropdown" id="accountDropdown">
                        <div class="account-dropdown-header">Switch Ad Account</div>
                        <div class="account-option active" onclick="switchAccount('Pabbly Connect', 'connect')">
                            <div class="option-icon connect">
                                <i class="fas fa-plug"></i>
                            </div>
                            <div class="option-info">
                                <div class="option-name">Pabbly Connect</div>
                                <div class="option-status">
                                    <span class="status-dot"></span>
                                    Active &#8226; 5 Campaigns
                                </div>
                            </div>
                            <i class="fas fa-check check-icon"></i>
                        </div>
                        <div class="account-option" onclick="switchAccount('Pabbly Chatflow', 'chatflow')">
                            <div class="option-icon chatflow">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="option-info">
                                <div class="option-name">Pabbly Chatflow</div>
                                <div class="option-status">
                                    <span class="status-dot"></span>
                                    Active &#8226; 3 Campaigns
                                </div>
                            </div>
                            <i class="fas fa-check check-icon"></i>
                        </div>
                        <div class="account-option" onclick="switchAccount('Pabbly Email Marketing', 'email')">
                            <div class="option-icon email">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="option-info">
                                <div class="option-name">Pabbly Email Marketing</div>
                                <div class="option-status">
                                    <span class="status-dot"></span>
                                    Active &#8226; 2 Campaigns
                                </div>
                            </div>
                            <i class="fas fa-check check-icon"></i>
                        </div>
                        <div class="account-option" onclick="switchAccount('Pabbly PSB', 'psb')">
                            <div class="option-icon psb">
                                <i class="fas fa-credit-card"></i>
                            </div>
                            <div class="option-info">
                                <div class="option-name">Pabbly PSB</div>
                                <div class="option-status">
                                    <span class="status-dot"></span>
                                    Active &#8226; 4 Campaigns
                                </div>
                            </div>
                            <i class="fas fa-check check-icon"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="header-right">
                <div class="header-icon" onclick="toggleNotifications()">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">5</span>
                </div>
                <div class="header-icon">
                    <i class="fas fa-question-circle"></i>
                </div>
                <div class="user-menu-wrapper">
                    <div class="user-avatar" id="userAvatar" onclick="toggleUserMenu()" style="cursor:pointer;">AD</div>
                    <div class="user-menu-dropdown" id="userMenuDropdown">
                        <div class="user-menu-info">Signed in as<br><strong id="user-menu-email">admin@pabbly.com</strong></div>
                        <hr>
                        <button onclick="signOut()"><i class="fas fa-sign-out-alt"></i> Sign Out</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Notification Panel -->
        <div class="notification-panel" id="notificationPanel">
            <div class="notification-header">
                <h3>Notifications</h3>
                <span class="mark-all-read">Mark all as read</span>
            </div>
            <div class="notification-list">
                <div class="notification-item unread">
                    <div class="notif-icon sale">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="notif-title">New Sale Generated!</div>
                    <div class="notif-desc">Campaign "USA - Lifetime Deal" - $700</div>
                    <div class="notif-time">2 minutes ago</div>
                </div>
                <div class="notification-item unread">
                    <div class="notif-icon alert">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="notif-title">Alert: Low ROAS Detected</div>
                    <div class="notif-desc">Campaign "UK - Retargeting" ROAS: 0.6</div>
                    <div class="notif-time">15 minutes ago</div>
                </div>
                <div class="notification-item">
                    <div class="notif-icon sale">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="notif-title">New Sale Generated!</div>
                    <div class="notif-desc">Campaign "India - Tech" - $700</div>
                    <div class="notif-time">1 hour ago</div>
                </div>
                <div class="notification-item">
                    <div class="notif-icon sale">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="notif-title">Budget Increase Recommended</div>
                    <div class="notif-desc">Campaign "USA - Lifetime Deal" ROAS: 2.5</div>
                    <div class="notif-time">3 hours ago</div>
                </div>
            </div>
        </div>

        <!-- Dashboard Content -->
        <div class="dashboard-content">
            <!-- Section: Custom Date Range Report -->
            <div id="custom-range-header" class="dashboard-section active" style="margin-bottom: 16px;">
                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                    <div>
                        <h3 style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin: 0 0 6px 0;">
                            <i class="fas fa-chart-bar" style="color: var(--primary-color); margin-right: 6px;"></i>Custom Date Range Report
                        </h3>
                        <p style="font-size: 13px; color: var(--text-secondary); margin: 0;">
                            View your ad performance for any custom date range. Use the dropdown to switch between different time periods.
                        </p>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px; flex-shrink: 0;">
                        <select id="time-range-selector" onchange="handleTimeRangeChange()" style="padding: 6px 12px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--card-background); color: var(--text-primary); font-size: 13px; cursor: pointer;">
                            <option value="today">Today</option>
                            <option value="last7days">Last 7 Days</option>
                            <option value="last30days" selected>Last 30 Days</option>
                            <option value="last90days">Last 90 Days</option>
                            <option value="thismonth">This Month</option>
                            <option value="lastmonth">Last Month</option>
                        </select>
                        <button onclick="refreshDashboardData()" style="display: flex; align-items: center; gap: 6px; padding: 6px 14px; background: var(--primary-color); color: white; border: none; border-radius: 6px; font-size: 13px; font-weight: 500; cursor: pointer;">
                            <i class="fas fa-sync-alt"></i> Refresh
                        </button>
                        <span id="last-synced-time" style="font-size: 12px; color: var(--text-secondary); white-space: nowrap;">Last synced: 5 min ago</span>
                    </div>
                </div>
            </div>

            <!-- Metrics Cards -->
            <div id="metrics-section" class="metrics-grid dashboard-section active">
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-label">
                            Total Ad Spend
                            <span class="tooltip">
                                <i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltip-text">Total amount spent on Facebook ads in the selected time period. Data from Facebook Marketing API.</span>
                            </span>
                        </span>
                        <div class="metric-icon blue">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                    </div>
                    <div class="metric-value">$12,450</div>
                    <div class="metric-change positive">
                        <i class="fas fa-arrow-up"></i> 12.5% vs last period
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-label">
                            Total Revenue
                            <span class="tooltip">
                                <i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltip-text">Actual revenue from Pabbly Subscription Billing. This is REAL money received, not Facebook pixel estimates.</span>
                            </span>
                        </span>
                        <div class="metric-icon green">
                            <i class="fas fa-coins"></i>
                        </div>
                    </div>
                    <div class="metric-value" id="total-revenue-value">$18,900</div>
                    <div class="metric-sub" style="font-size: 14px; color: var(--text-secondary); margin-top: 4px;">
                        Total Sales: <span id="total-sales-count" style="font-weight: 600; color: var(--text-primary);">27</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-label">
                            ROAS
                            <span class="tooltip">
                                <i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltip-text">Pabbly Revenue Ã· Facebook Ad Spend. This shows your TRUE business ROAS based on actual sales. Target: Above 1.5</span>
                            </span>
                        </span>
                        <div class="metric-icon green">
                            <i class="fas fa-chart-line"></i>
                        </div>
                    </div>
                    <div class="metric-value" id="roas-value" style="color: var(--success-color);">1.52</div>
                    <div class="metric-change positive">
                        <i class="fas fa-arrow-up"></i> 8.2% vs last period
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-label">
                            Total Leads
                            <span class="tooltip">
                                <i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltip-text">Total leads captured via CRM integration. Avg CPL = Total Ad Spend Ã· Total Leads.</span>
                            </span>
                        </span>
                        <div class="metric-icon orange">
                            <i class="fas fa-user-plus"></i>
                        </div>
                    </div>
                    <div class="metric-value" id="total-leads-value">234</div>
                    <div class="metric-sub" style="font-size: 14px; color: var(--text-secondary); margin-top: 4px;">
                        Avg. CPL: <span id="cpl-value" style="font-weight: 600; color: var(--text-primary);">$52.76</span>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-label">
                            Pixel Status
                            <span class="tooltip">
                                <i class="fas fa-info-circle info-icon"></i>
                                <span class="tooltip-text">Shows whether Facebook Pixel is active on your landing pages. Checked every hour.</span>
                            </span>
                        </span>
                        <div class="metric-icon green">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="pixel-status">
                        <span class="pixel-dot active"></span>
                        <span style="font-size: 18px; font-weight: 600;">Active</span>
                    </div>
                    <div class="metric-change" style="color: var(--text-secondary);">
                        Last checked: 15 min ago
                    </div>
                </div>
            </div>

            <!-- Separator -->
            <div id="snapshot-header" class="dashboard-section active" style="margin: 28px 0 16px 0; border-top: 1px solid var(--border-color); padding-top: 24px;">
                <h3 style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin: 0 0 6px 0;">
                    <i class="fas fa-calendar-alt" style="color: var(--primary-color); margin-right: 6px;"></i>Quick Performance Snapshot
                </h3>
                <p style="font-size: 13px; color: var(--text-secondary); margin: 0;">
                    A fixed overview of your ad performance across three time periods &#8212; Today, Last 7 Days, and Last 30 Days. This data updates automatically and always reflects the most recent rolling periods.
                </p>
            </div>

            <!-- Time-based Performance Tables -->
            <div id="time-based-tables" class="dashboard-section active" style="margin-bottom: 24px;">
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
                    <!-- Daily Table -->
                    <div class="table-section" style="margin-bottom: 0;">
                        <div class="table-header">
                            <h3>
                                <i class="fas fa-calendar-day"></i> Today
                                <span style="display: block; font-size: 11px; font-weight: 400; color: var(--text-secondary); margin-top: 4px;" id="daily-date-range">Jan 27, 2026</span>
                            </h3>
                        </div>
                        <table class="data-table">
                            <tbody id="daily-metrics-tbody">
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">Ad Spend</td>
                                    <td style="text-align: right;"><strong id="daily-spend">$336.00</strong></td>
                                </tr>
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">Revenue</td>
                                    <td style="text-align: right;"><strong style="color: var(--success-color);" id="daily-revenue">$1,999.00</strong></td>
                                </tr>
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">ROAS</td>
                                    <td style="text-align: right;"><strong style="color: var(--success-color);" id="daily-roas">5.94</strong></td>
                                </tr>
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">Leads</td>
                                    <td style="text-align: right;"><strong id="daily-leads">39</strong></td>
                                </tr>
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">Cost Per Lead</td>
                                    <td style="text-align: right;"><strong id="daily-cpl">$8.61</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Weekly Table -->
                    <div class="table-section" style="margin-bottom: 0;">
                        <div class="table-header">
                            <h3>
                                <i class="fas fa-calendar-week"></i> This Week
                                <span style="display: block; font-size: 11px; font-weight: 400; color: var(--text-secondary); margin-top: 4px;" id="weekly-date-range">Jan 20 - Jan 26, 2026</span>
                            </h3>
                        </div>
                        <table class="data-table">
                            <tbody id="weekly-metrics-tbody">
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">Ad Spend</td>
                                    <td style="text-align: right;"><strong id="weekly-spend">$2,100.00</strong></td>
                                </tr>
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">Revenue</td>
                                    <td style="text-align: right;"><strong style="color: var(--success-color);" id="weekly-revenue">$8,400.00</strong></td>
                                </tr>
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">ROAS</td>
                                    <td style="text-align: right;"><strong style="color: var(--success-color);" id="weekly-roas">4.00</strong></td>
                                </tr>
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">Leads</td>
                                    <td style="text-align: right;"><strong id="weekly-leads">156</strong></td>
                                </tr>
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">Cost Per Lead</td>
                                    <td style="text-align: right;"><strong id="weekly-cpl">$13.46</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Monthly Table -->
                    <div class="table-section" style="margin-bottom: 0;">
                        <div class="table-header">
                            <h3>
                                <i class="fas fa-calendar-alt"></i> This Month
                                <span style="display: block; font-size: 11px; font-weight: 400; color: var(--text-secondary); margin-top: 4px;" id="monthly-date-range">Jan 1 - Jan 31, 2026</span>
                            </h3>
                        </div>
                        <table class="data-table">
                            <tbody id="monthly-metrics-tbody">
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">Ad Spend</td>
                                    <td style="text-align: right;"><strong id="monthly-spend">$12,345.67</strong></td>
                                </tr>
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">Revenue</td>
                                    <td style="text-align: right;"><strong style="color: var(--success-color);" id="monthly-revenue">$16,100.00</strong></td>
                                </tr>
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">ROAS</td>
                                    <td style="text-align: right;"><strong style="color: var(--success-color);" id="monthly-roas">1.31</strong></td>
                                </tr>
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">Leads</td>
                                    <td style="text-align: right;"><strong id="monthly-leads">234</strong></td>
                                </tr>
                                <tr>
                                    <td style="font-size: 13px; color: var(--text-secondary);">Cost Per Lead</td>
                                    <td style="text-align: right;"><strong id="monthly-cpl">$52.76</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Alerts Section with Tabs -->
            <div id="alerts-section" class="table-section dashboard-section">
                <div class="table-header">
                    <h3><i class="fas fa-bell"></i> Alerts <span class="count">7 Open</span></h3>
                </div>

                <!-- Task Tabs -->
                <div class="task-tabs">
                    <button class="task-tab active" onclick="switchTaskTab('needs-action')">
                        <i class="fas fa-exclamation-circle"></i>
                        Needs Action
                        <span class="tab-count">5</span>
                    </button>
                    <button class="task-tab" onclick="switchTaskTab('opportunities')">
                        <i class="fas fa-arrow-trend-up"></i>
                        Opportunities
                        <span class="tab-count">2</span>
                    </button>
                </div>

                <!-- Needs Action Tab Content -->
                <div id="needs-action" class="task-content active">
                    <div class="task-list">
                        <!-- Task 1 - Critical -->
                        <div class="task-item" data-task-id="1">
                            <div class="task-item-header" onclick="toggleTask(this)">
                                <span class="task-priority critical">Critical</span>
                                <div class="task-info">
                                    <div class="task-title">
                                        UK - Retargeting
                                        <span class="task-type">Campaign</span>
                                    </div>
                                    <div class="task-meta">
                                        <span><i class="fas fa-exclamation-triangle"></i> Low ROAS - Below threshold</span>
                                        <span><i class="fas fa-clock"></i> 4 days ago</span>
                                    </div>
                                </div>
                                <div class="task-metrics">
                                    <div class="task-metric">
                                        <div class="task-metric-label">Spend</div>
                                        <div class="task-metric-value">$2,847</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">Sales</div>
                                        <div class="task-metric-value">$980</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">ROAS</div>
                                        <div class="task-metric-value" style="color: #dc2626;">0.34</div>
                                    </div>
                                </div>
                                <select class="task-status-select" onclick="event.stopPropagation()">
                                    <option value="open" selected>Open</option>
                                    <option value="on-hold">On Hold</option>
                                    <option value="resolved">Resolved</option>
                                </select>
                                <button class="task-expand-btn">
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                            <div class="task-details">
                                <div class="task-details-grid">
                                    <div class="task-detail-section">
                                        <h4>Threshold Details</h4>
                                        <div class="task-threshold-info">
                                            <div class="task-threshold-row">
                                                <span>Spend Threshold</span>
                                                <span><strong>$700.00</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Current Spend</span>
                                                <span style="color: #dc2626;"><strong>$2,847.00</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Target ROAS</span>
                                                <span><strong>1.0</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Current ROAS</span>
                                                <span style="color: #dc2626;"><strong>0.34</strong></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="task-detail-section">
                                        <h4>Comments</h4>
                                        <div class="task-comments">
                                            <div class="task-comment">
                                                <div class="task-comment-header">
                                                    <span class="task-comment-author">John D.</span>
                                                    <span class="task-comment-time">2 days ago</span>
                                                </div>
                                                <div class="task-comment-text">Checked the ad creatives. Will try new targeting options.</div>
                                            </div>
                                            <div class="task-comment">
                                                <div class="task-comment-header">
                                                    <span class="task-comment-author">System</span>
                                                    <span class="task-comment-time">4 days ago</span>
                                                </div>
                                                <div class="task-comment-text">Task created: Campaign exceeded $700 spend threshold with ROAS below 1.0</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="task-add-comment">
                                    <input type="text" class="task-comment-input" placeholder="Add a comment...">
                                    <button class="task-comment-btn">Add</button>
                                </div>
                                <div class="task-actions-row">
                                    <button class="task-action-btn danger"><i class="fas fa-pause"></i> Pause Campaign</button>
                                    <button class="task-action-btn"><i class="fas fa-external-link-alt"></i> View in Facebook</button>
                                    <button class="task-action-btn primary" style="margin-left: auto;"><i class="fas fa-check"></i> Mark Resolved</button>
                                </div>
                            </div>
                        </div>

                        <!-- Task 2 - Critical -->
                        <div class="task-item" data-task-id="2">
                            <div class="task-item-header" onclick="toggleTask(this)">
                                <span class="task-priority critical">Critical</span>
                                <div class="task-info">
                                    <div class="task-title">
                                        United Kingdom
                                        <span class="task-type">Country</span>
                                    </div>
                                    <div class="task-meta">
                                        <span><i class="fas fa-times-circle"></i> No sales after threshold spend</span>
                                        <span><i class="fas fa-clock"></i> 3 days ago</span>
                                    </div>
                                </div>
                                <div class="task-metrics">
                                    <div class="task-metric">
                                        <div class="task-metric-label">Spend</div>
                                        <div class="task-metric-value">$1,240</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">Sales</div>
                                        <div class="task-metric-value" style="color: #dc2626;">$0</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">ROAS</div>
                                        <div class="task-metric-value" style="color: #dc2626;">0.00</div>
                                    </div>
                                </div>
                                <select class="task-status-select" onclick="event.stopPropagation()">
                                    <option value="open" selected>Open</option>
                                    <option value="on-hold">On Hold</option>
                                    <option value="resolved">Resolved</option>
                                </select>
                                <button class="task-expand-btn">
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                            <div class="task-details">
                                <div class="task-details-grid">
                                    <div class="task-detail-section">
                                        <h4>Threshold Details</h4>
                                        <div class="task-threshold-info">
                                            <div class="task-threshold-row">
                                                <span>Spend Threshold</span>
                                                <span><strong>$700.00</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Current Spend</span>
                                                <span style="color: #dc2626;"><strong>$1,240.00</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Target ROAS</span>
                                                <span><strong>1.0</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Current ROAS</span>
                                                <span style="color: #dc2626;"><strong>0.00</strong></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="task-detail-section">
                                        <h4>Comments</h4>
                                        <div class="task-comments">
                                            <div class="task-comment">
                                                <div class="task-comment-header">
                                                    <span class="task-comment-author">System</span>
                                                    <span class="task-comment-time">3 days ago</span>
                                                </div>
                                                <div class="task-comment-text">Task created: Country exceeded $700 spend with 0 sales</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="task-add-comment">
                                    <input type="text" class="task-comment-input" placeholder="Add a comment...">
                                    <button class="task-comment-btn">Add</button>
                                </div>
                                <div class="task-actions-row">
                                    <button class="task-action-btn danger"><i class="fas fa-ban"></i> Exclude Country</button>
                                    <button class="task-action-btn"><i class="fas fa-external-link-alt"></i> View in Facebook</button>
                                    <button class="task-action-btn primary" style="margin-left: auto;"><i class="fas fa-check"></i> Mark Resolved</button>
                                </div>
                            </div>
                        </div>

                        <!-- Task 3 - Warning -->
                        <div class="task-item" data-task-id="3">
                            <div class="task-item-header" onclick="toggleTask(this)">
                                <span class="task-priority warning">Warning</span>
                                <div class="task-info">
                                    <div class="task-title">
                                        Interest - Tech Entrepreneurs
                                        <span class="task-type">Ad Set</span>
                                    </div>
                                    <div class="task-meta">
                                        <span><i class="fas fa-chart-line"></i> ROAS below target threshold</span>
                                        <span><i class="fas fa-clock"></i> 1 day ago</span>
                                    </div>
                                </div>
                                <div class="task-metrics">
                                    <div class="task-metric">
                                        <div class="task-metric-label">Spend</div>
                                        <div class="task-metric-value">$920</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">Sales</div>
                                        <div class="task-metric-value">$700</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">ROAS</div>
                                        <div class="task-metric-value" style="color: #f97316;">0.76</div>
                                    </div>
                                </div>
                                <select class="task-status-select" onclick="event.stopPropagation()">
                                    <option value="open" selected>Open</option>
                                    <option value="on-hold">On Hold</option>
                                    <option value="resolved">Resolved</option>
                                </select>
                                <button class="task-expand-btn">
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                            <div class="task-details">
                                <div class="task-details-grid">
                                    <div class="task-detail-section">
                                        <h4>Threshold Details</h4>
                                        <div class="task-threshold-info">
                                            <div class="task-threshold-row">
                                                <span>Spend Threshold</span>
                                                <span><strong>$700.00</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Current Spend</span>
                                                <span style="color: #f97316;"><strong>$920.00</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Target ROAS</span>
                                                <span><strong>1.0</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Current ROAS</span>
                                                <span style="color: #f97316;"><strong>0.76</strong></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="task-detail-section">
                                        <h4>Comments</h4>
                                        <div class="task-comments">
                                            <div class="task-comment">
                                                <div class="task-comment-header">
                                                    <span class="task-comment-author">System</span>
                                                    <span class="task-comment-time">1 day ago</span>
                                                </div>
                                                <div class="task-comment-text">Task created: Ad Set exceeded $700 spend with ROAS 0.76</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="task-add-comment">
                                    <input type="text" class="task-comment-input" placeholder="Add a comment...">
                                    <button class="task-comment-btn">Add</button>
                                </div>
                                <div class="task-actions-row">
                                    <button class="task-action-btn"><i class="fas fa-sliders-h"></i> Adjust Targeting</button>
                                    <button class="task-action-btn"><i class="fas fa-external-link-alt"></i> View in Facebook</button>
                                    <button class="task-action-btn primary" style="margin-left: auto;"><i class="fas fa-check"></i> Mark Resolved</button>
                                </div>
                            </div>
                        </div>

                        <!-- Task 4 - Warning -->
                        <div class="task-item" data-task-id="4">
                            <div class="task-item-header" onclick="toggleTask(this)">
                                <span class="task-priority warning">Warning</span>
                                <div class="task-info">
                                    <div class="task-title">
                                        Video Ad v3 - Feature Demo
                                        <span class="task-type">Ad</span>
                                    </div>
                                    <div class="task-meta">
                                        <span><i class="fas fa-chart-line"></i> ROAS below target threshold</span>
                                        <span><i class="fas fa-clock"></i> 2 hours ago</span>
                                    </div>
                                </div>
                                <div class="task-metrics">
                                    <div class="task-metric">
                                        <div class="task-metric-label">Spend</div>
                                        <div class="task-metric-value">$520</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">Sales</div>
                                        <div class="task-metric-value">$350</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">ROAS</div>
                                        <div class="task-metric-value" style="color: #f97316;">0.67</div>
                                    </div>
                                </div>
                                <select class="task-status-select" onclick="event.stopPropagation()">
                                    <option value="open" selected>Open</option>
                                    <option value="on-hold">On Hold</option>
                                    <option value="resolved">Resolved</option>
                                </select>
                                <button class="task-expand-btn">
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                            <div class="task-details">
                                <div class="task-details-grid">
                                    <div class="task-detail-section">
                                        <h4>Threshold Details</h4>
                                        <div class="task-threshold-info">
                                            <div class="task-threshold-row">
                                                <span>Spend Threshold</span>
                                                <span><strong>$500.00</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Current Spend</span>
                                                <span style="color: #f97316;"><strong>$520.00</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Target ROAS</span>
                                                <span><strong>1.0</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Current ROAS</span>
                                                <span style="color: #f97316;"><strong>0.67</strong></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="task-detail-section">
                                        <h4>Comments</h4>
                                        <div class="task-comments">
                                            <div class="task-comment">
                                                <div class="task-comment-header">
                                                    <span class="task-comment-author">System</span>
                                                    <span class="task-comment-time">2 hours ago</span>
                                                </div>
                                                <div class="task-comment-text">Task created: Ad exceeded $500 spend with ROAS 0.67</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="task-add-comment">
                                    <input type="text" class="task-comment-input" placeholder="Add a comment...">
                                    <button class="task-comment-btn">Add</button>
                                </div>
                                <div class="task-actions-row">
                                    <button class="task-action-btn danger"><i class="fas fa-pause"></i> Pause Ad</button>
                                    <button class="task-action-btn"><i class="fas fa-external-link-alt"></i> View in Facebook</button>
                                    <button class="task-action-btn primary" style="margin-left: auto;"><i class="fas fa-check"></i> Mark Resolved</button>
                                </div>
                            </div>
                        </div>

                        <!-- Task 5 - Warning (On Hold) -->
                        <div class="task-item" data-task-id="5">
                            <div class="task-item-header" onclick="toggleTask(this)">
                                <span class="task-priority warning">Warning</span>
                                <div class="task-info">
                                    <div class="task-title">
                                        Interests - Business Owners
                                        <span class="task-type">Ad Set</span>
                                    </div>
                                    <div class="task-meta">
                                        <span><i class="fas fa-redo"></i> High frequency (2.8)</span>
                                        <span><i class="fas fa-clock"></i> 5 hours ago</span>
                                    </div>
                                </div>
                                <div class="task-metrics">
                                    <div class="task-metric">
                                        <div class="task-metric-label">Spend</div>
                                        <div class="task-metric-value">$650</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">Sales</div>
                                        <div class="task-metric-value">$820</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">ROAS</div>
                                        <div class="task-metric-value" style="color: #f97316;">1.26</div>
                                    </div>
                                </div>
                                <select class="task-status-select" onclick="event.stopPropagation()">
                                    <option value="open">Open</option>
                                    <option value="on-hold" selected>On Hold</option>
                                    <option value="resolved">Resolved</option>
                                </select>
                                <button class="task-expand-btn">
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                            <div class="task-details">
                                <div class="task-details-grid">
                                    <div class="task-detail-section">
                                        <h4>Threshold Details</h4>
                                        <div class="task-threshold-info">
                                            <div class="task-threshold-row">
                                                <span>Frequency Threshold</span>
                                                <span><strong>2.0</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Current Frequency</span>
                                                <span style="color: #f97316;"><strong>2.8</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Impressions</span>
                                                <span><strong>125,430</strong></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="task-detail-section">
                                        <h4>Comments</h4>
                                        <div class="task-comments">
                                            <div class="task-comment">
                                                <div class="task-comment-header">
                                                    <span class="task-comment-author">Sarah M.</span>
                                                    <span class="task-comment-time">3 hours ago</span>
                                                </div>
                                                <div class="task-comment-text">Put on hold. Monitoring for 24 hours to see if frequency drops after new creatives.</div>
                                            </div>
                                            <div class="task-comment">
                                                <div class="task-comment-header">
                                                    <span class="task-comment-author">System</span>
                                                    <span class="task-comment-time">5 hours ago</span>
                                                </div>
                                                <div class="task-comment-text">Task created: Ad Set frequency exceeded 2.0 threshold</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="task-add-comment">
                                    <input type="text" class="task-comment-input" placeholder="Add a comment...">
                                    <button class="task-comment-btn">Add</button>
                                </div>
                                <div class="task-actions-row">
                                    <button class="task-action-btn"><i class="fas fa-image"></i> Refresh Creative</button>
                                    <button class="task-action-btn"><i class="fas fa-external-link-alt"></i> View in Facebook</button>
                                    <button class="task-action-btn primary" style="margin-left: auto;"><i class="fas fa-check"></i> Mark Resolved</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Opportunities Tab Content -->
                <div id="opportunities" class="task-content">
                    <div class="task-list">
                        <!-- Opportunity 1 -->
                        <div class="task-item" data-task-id="6">
                            <div class="task-item-header" onclick="toggleTask(this)">
                                <span class="task-priority opportunity">Opportunity</span>
                                <div class="task-info">
                                    <div class="task-title">
                                        USA - Lifetime Deal
                                        <span class="task-type">Campaign</span>
                                    </div>
                                    <div class="task-meta">
                                        <span><i class="fas fa-arrow-up"></i> High ROAS - Consider budget increase</span>
                                        <span><i class="fas fa-clock"></i> 3 days ago</span>
                                    </div>
                                </div>
                                <div class="task-metrics">
                                    <div class="task-metric">
                                        <div class="task-metric-label">Spend</div>
                                        <div class="task-metric-value">$3,200</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">Sales</div>
                                        <div class="task-metric-value">$8,400</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">ROAS</div>
                                        <div class="task-metric-value" style="color: #22c55e;">2.63</div>
                                    </div>
                                </div>
                                <select class="task-status-select" onclick="event.stopPropagation()">
                                    <option value="open" selected>Open</option>
                                    <option value="on-hold">On Hold</option>
                                    <option value="applied">Applied</option>
                                </select>
                                <button class="task-expand-btn">
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                            <div class="task-details">
                                <div class="task-details-grid">
                                    <div class="task-detail-section">
                                        <h4>Recommendation</h4>
                                        <div class="task-threshold-info">
                                            <div class="task-threshold-row">
                                                <span>Current Budget</span>
                                                <span><strong>$100/day</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Suggested Budget</span>
                                                <span style="color: #22c55e;"><strong>$130/day (+30%)</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Current ROAS</span>
                                                <span style="color: #22c55e;"><strong>2.63</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Potential Extra Revenue</span>
                                                <span style="color: #22c55e;"><strong>+$2,520/week</strong></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="task-detail-section">
                                        <h4>Comments</h4>
                                        <div class="task-comments">
                                            <div class="task-comment">
                                                <div class="task-comment-header">
                                                    <span class="task-comment-author">System</span>
                                                    <span class="task-comment-time">3 days ago</span>
                                                </div>
                                                <div class="task-comment-text">Opportunity detected: Campaign has consistent ROAS above 2.5 for 7 days</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="task-add-comment">
                                    <input type="text" class="task-comment-input" placeholder="Add a comment...">
                                    <button class="task-comment-btn">Add</button>
                                </div>
                                <div class="task-actions-row">
                                    <button class="task-action-btn primary"><i class="fas fa-arrow-up"></i> Increase Budget</button>
                                    <button class="task-action-btn"><i class="fas fa-external-link-alt"></i> View in Facebook</button>
                                    <button class="task-action-btn" style="margin-left: auto;"><i class="fas fa-times"></i> Dismiss</button>
                                </div>
                            </div>
                        </div>

                        <!-- Opportunity 2 -->
                        <div class="task-item" data-task-id="7">
                            <div class="task-item-header" onclick="toggleTask(this)">
                                <span class="task-priority opportunity">Opportunity</span>
                                <div class="task-info">
                                    <div class="task-title">
                                        Lookalike - Top Customers
                                        <span class="task-type">Ad Set</span>
                                    </div>
                                    <div class="task-meta">
                                        <span><i class="fas fa-arrow-up"></i> High ROAS - Consider budget increase</span>
                                        <span><i class="fas fa-clock"></i> 2 days ago</span>
                                    </div>
                                </div>
                                <div class="task-metrics">
                                    <div class="task-metric">
                                        <div class="task-metric-label">Spend</div>
                                        <div class="task-metric-value">$1,850</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">Sales</div>
                                        <div class="task-metric-value">$4,200</div>
                                    </div>
                                    <div class="task-metric">
                                        <div class="task-metric-label">ROAS</div>
                                        <div class="task-metric-value" style="color: #22c55e;">2.27</div>
                                    </div>
                                </div>
                                <select class="task-status-select" onclick="event.stopPropagation()">
                                    <option value="open" selected>Open</option>
                                    <option value="on-hold">On Hold</option>
                                    <option value="applied">Applied</option>
                                </select>
                                <button class="task-expand-btn">
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                            <div class="task-details">
                                <div class="task-details-grid">
                                    <div class="task-detail-section">
                                        <h4>Recommendation</h4>
                                        <div class="task-threshold-info">
                                            <div class="task-threshold-row">
                                                <span>Current Budget</span>
                                                <span><strong>$50/day</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Suggested Budget</span>
                                                <span style="color: #22c55e;"><strong>$65/day (+30%)</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Current ROAS</span>
                                                <span style="color: #22c55e;"><strong>2.27</strong></span>
                                            </div>
                                            <div class="task-threshold-row">
                                                <span>Potential Extra Revenue</span>
                                                <span style="color: #22c55e;"><strong>+$735/week</strong></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="task-detail-section">
                                        <h4>Comments</h4>
                                        <div class="task-comments">
                                            <div class="task-comment">
                                                <div class="task-comment-header">
                                                    <span class="task-comment-author">System</span>
                                                    <span class="task-comment-time">2 days ago</span>
                                                </div>
                                                <div class="task-comment-text">Opportunity detected: Ad Set has consistent ROAS above 2.0 for 5 days</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="task-add-comment">
                                    <input type="text" class="task-comment-input" placeholder="Add a comment...">
                                    <button class="task-comment-btn">Add</button>
                                </div>
                                <div class="task-actions-row">
                                    <button class="task-action-btn primary"><i class="fas fa-arrow-up"></i> Increase Budget</button>
                                    <button class="task-action-btn"><i class="fas fa-external-link-alt"></i> View in Facebook</button>
                                    <button class="task-action-btn" style="margin-left: auto;"><i class="fas fa-times"></i> Dismiss</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="table-pagination">
                    <div class="pagination-left">
                        <span>Rows per page:</span>
                        <select class="pagination-select">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                            <option value="100" selected>100</option>
                        </select>
                    </div>
                    <div class="pagination-center">
                        <span>1-7 of 7</span>
                    </div>
                    <div class="pagination-right">
                        <span>Page:</span>
                        <input type="number" class="pagination-input" value="1" min="1" max="1">
                        <span>of 1</span>
                        <button class="pagination-arrow" disabled><i class="fas fa-chevron-left"></i></button>
                        <button class="pagination-arrow" disabled><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- Campaigns Table -->
            <div id="campaigns-section" class="table-section dashboard-section">
                <div class="table-header">
                    <h3><i class="fas fa-bullhorn"></i> Campaigns <span class="count">5 Active</span></h3>
                    <div class="table-filter">
                        <select id="campaigns-status-filter" class="table-status-filter">
                            <option value="active" selected>Active</option>
                            <option value="paused">Paused</option>
                            <option value="all">All</option>
                        </select>
                        <div class="table-search-wrapper">
                            <i class="fas fa-search table-search-icon"></i>
                            <input type="text" id="campaigns-search" class="table-search-input" placeholder="Search campaigns...">
                        </div>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Status</th>
                            <th>Campaign Name</th>
                            <th>Budget <i class="fas fa-sort sort-icon"></i></th>
                            <th class="sorted">Spent <i class="fas fa-sort-down sort-icon"></i></th>
                            <th>Sales <i class="fas fa-sort sort-icon"></i></th>
                            <th>Revenue <i class="fas fa-sort sort-icon"></i></th>
                            <th>ROAS <i class="fas fa-sort sort-icon"></i></th>
                            <th>Frequency <i class="fas fa-sort sort-icon"></i></th>
                            <th>Outbound Clicks <i class="fas fa-sort sort-icon"></i></th>
                            <th>Reach <i class="fas fa-sort sort-icon"></i></th>
                            <th>Impressions <i class="fas fa-sort sort-icon"></i></th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
                <!-- Pagination -->
                <div class="table-pagination">
                    <div class="pagination-left">
                        <span>Rows per page:</span>
                        <select class="pagination-select">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                            <option value="100" selected>100</option>
                        </select>
                    </div>
                    <div class="pagination-center">
                        <span></span>
                    </div>
                    <div class="pagination-right">
                        <span>Page:</span>
                        <input type="number" class="pagination-input" value="1" min="1" max="1">
                        <span>of 1</span>
                        <button class="pagination-arrow" disabled><i class="fas fa-chevron-left"></i></button>
                        <button class="pagination-arrow" disabled><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- Ad Sets Table -->
            <div id="adsets-section" class="table-section dashboard-section">
                <div class="table-header">
                    <h3><i class="fas fa-layer-group"></i> Ad Sets <span class="count">12 Active</span></h3>
                    <div class="table-filter">
                        <select id="adsets-status-filter" class="table-status-filter">
                            <option value="active" selected>Active</option>
                            <option value="paused">Paused</option>
                            <option value="all">All</option>
                        </select>
                        <select id="adsets-campaign-filter" class="table-status-filter" style="min-width: 170px;">
                            <option value="all">All Campaigns</option>
                        </select>
                        <div class="table-search-wrapper">
                            <i class="fas fa-search table-search-icon"></i>
                            <input type="text" id="adsets-search" class="table-search-input" placeholder="Search ad sets...">
                        </div>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Status</th>
                            <th>Ad Set Name</th>
                            <th>Budget <i class="fas fa-sort sort-icon"></i></th>
                            <th>Spent <i class="fas fa-sort sort-icon"></i></th>
                            <th>Sales <i class="fas fa-sort sort-icon"></i></th>
                            <th>Revenue <i class="fas fa-sort sort-icon"></i></th>
                            <th>ROAS <i class="fas fa-sort sort-icon"></i></th>
                            <th>Frequency <i class="fas fa-sort sort-icon"></i></th>
                            <th>Outbound Clicks <i class="fas fa-sort sort-icon"></i></th>
                            <th>Reach <i class="fas fa-sort sort-icon"></i></th>
                            <th>Impressions <i class="fas fa-sort sort-icon"></i></th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
                <!-- Pagination -->
                <div class="table-pagination">
                    <div class="pagination-left">
                        <span>Rows per page:</span>
                        <select class="pagination-select">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                            <option value="100" selected>100</option>
                        </select>
                    </div>
                    <div class="pagination-center">
                        <span></span>
                    </div>
                    <div class="pagination-right">
                        <span>Page:</span>
                        <input type="number" class="pagination-input" value="1" min="1" max="1">
                        <span>of 1</span>
                        <button class="pagination-arrow" disabled><i class="fas fa-chevron-left"></i></button>
                        <button class="pagination-arrow" disabled><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- Ads Table -->
            <div id="ads-section" class="table-section dashboard-section">
                <div class="table-header">
                    <h3><i class="fas fa-ad"></i> Ads <span class="count">24 Active</span></h3>
                    <div class="table-filter">
                        <select id="ads-status-filter" class="table-status-filter">
                            <option value="active" selected>Active</option>
                            <option value="paused">Paused</option>
                            <option value="all">All</option>
                        </select>
                        <select id="ads-campaign-filter" class="table-status-filter" style="min-width: 170px;">
                            <option value="all">All Campaigns</option>
                        </select>
                        <select id="ads-adset-filter" class="table-status-filter" style="min-width: 170px;">
                            <option value="all">All Ad Sets</option>
                        </select>
                        <div class="table-search-wrapper">
                            <i class="fas fa-search table-search-icon"></i>
                            <input type="text" id="ads-search" class="table-search-input" placeholder="Search ads...">
                        </div>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Status</th>
                            <th>Ad Name</th>
                            <th>Budget <i class="fas fa-sort sort-icon"></i></th>
                            <th>Spent <i class="fas fa-sort sort-icon"></i></th>
                            <th>Sales <i class="fas fa-sort sort-icon"></i></th>
                            <th>Revenue <i class="fas fa-sort sort-icon"></i></th>
                            <th>ROAS <i class="fas fa-sort sort-icon"></i></th>
                            <th>Frequency <i class="fas fa-sort sort-icon"></i></th>
                            <th>Outbound Clicks <i class="fas fa-sort sort-icon"></i></th>
                            <th>Reach <i class="fas fa-sort sort-icon"></i></th>
                            <th>Impressions <i class="fas fa-sort sort-icon"></i></th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
                <!-- Pagination -->
                <div class="table-pagination">
                    <div class="pagination-left">
                        <span>Rows per page:</span>
                        <select class="pagination-select">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                            <option value="100" selected>100</option>
                        </select>
                    </div>
                    <div class="pagination-center">
                        <span></span>
                    </div>
                    <div class="pagination-right">
                        <span>Page:</span>
                        <input type="number" class="pagination-input" value="1" min="1">
                        <span>of 1</span>
                        <button class="pagination-arrow" disabled><i class="fas fa-chevron-left"></i></button>
                        <button class="pagination-arrow"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- Country Performance (Pabbly Data) -->
            <div id="country-section" class="table-section dashboard-section">
                <div class="table-header">
                    <h3>
                        <i class="fas fa-globe"></i> Country Performance
                        <span class="count">From Pabbly</span>
                        <span class="tooltip" style="margin-left: 8px;">
                            <i class="fas fa-info-circle" style="color: var(--text-secondary);"></i>
                            <span class="tooltip-text">Country data is from Pabbly Subscription Billing (actual sales), NOT Facebook pixel. This gives you accurate geographic performance.</span>
                        </span>
                    </h3>
                    <div class="table-filter">
                        <div class="table-search-wrapper">
                            <i class="fas fa-search table-search-icon"></i>
                            <input type="text" id="country-search" class="table-search-input" placeholder="Search country...">
                        </div>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Country</th>
                            <th>Ad Spend <i class="fas fa-sort sort-icon"></i></th>
                            <th>Sales <i class="fas fa-sort sort-icon"></i></th>
                            <th>Revenue <i class="fas fa-sort sort-icon"></i></th>
                            <th>ROAS <i class="fas fa-sort sort-icon"></i></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <div class="name-cell">
                                    <img src="https://flagcdn.com/24x18/us.png" class="country-flag" alt="US">
                                    <span>United States</span>
                                </div>
                            </td>
                            <td>$4,250.00</td>
                            <td>10</td>
                            <td>$7,000.00</td>
                            <td><span class="roas-value good">1.65</span></td>
                        </tr>
                        <tr>
                            <td>
                                <div class="name-cell">
                                    <img src="https://flagcdn.com/24x18/in.png" class="country-flag" alt="IN">
                                    <span>India</span>
                                </div>
                            </td>
                            <td>$2,890.00</td>
                            <td>6</td>
                            <td>$4,200.00</td>
                            <td><span class="roas-value good">1.45</span></td>
                        </tr>
                        <tr>
                            <td>
                                <div class="name-cell">
                                    <img src="https://flagcdn.com/24x18/ca.png" class="country-flag" alt="CA">
                                    <span>Canada</span>
                                </div>
                            </td>
                            <td>$1,563.00</td>
                            <td>4</td>
                            <td>$2,800.00</td>
                            <td><span class="roas-value good">1.79</span></td>
                        </tr>
                        <tr>
                            <td>
                                <div class="name-cell">
                                    <img src="https://flagcdn.com/24x18/au.png" class="country-flag" alt="AU">
                                    <span>Australia</span>
                                </div>
                            </td>
                            <td>$1,900.00</td>
                            <td>3</td>
                            <td>$2,100.00</td>
                            <td><span class="roas-value warning">1.10</span></td>
                        </tr>
                        <tr>
                            <td>
                                <div class="name-cell">
                                    <img src="https://flagcdn.com/24x18/gb.png" class="country-flag" alt="GB">
                                    <span>United Kingdom</span>
                                </div>
                            </td>
                            <td>$1,847.00</td>
                            <td>2</td>
                            <td>$1,400.00</td>
                            <td><span class="roas-value bad">0.76</span></td>
                        </tr>
                    </tbody>
                </table>
                <!-- Pagination -->
                <div class="table-pagination">
                    <div class="pagination-left">
                        <span>Rows per page:</span>
                        <select class="pagination-select">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                            <option value="100" selected>100</option>
                        </select>
                    </div>
                    <div class="pagination-center">
                        <span>1-5 of 5</span>
                    </div>
                    <div class="pagination-right">
                        <span>Page:</span>
                        <input type="number" class="pagination-input" value="1" min="1" max="1">
                        <span>of 1</span>
                        <button class="pagination-arrow" disabled><i class="fas fa-chevron-left"></i></button>
                        <button class="pagination-arrow" disabled><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- Sales by Ad Creative Section (Dashboard) -->
            <div id="sales-creative-section" class="table-section dashboard-section">
                <div class="table-header">
                    <h3><i class="fas fa-palette"></i> Sales by Ad Creative <span class="count">23 Sales</span></h3>
                    <div class="table-filter">
                        <select class="table-status-filter">
                            <option value="all" selected>All Time</option>
                            <option value="today">Today</option>
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                        </select>
                        <div class="table-search-wrapper">
                            <i class="fas fa-search table-search-icon"></i>
                            <input type="text" id="sales-creative-search" class="table-search-input" placeholder="Search by ad, campaign, ad set...">
                        </div>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Creative</th>
                            <th>Ad Name</th>
                            <th>Campaign</th>
                            <th>Ad Set</th>
                            <th>Country</th>
                            <th>Amount</th>
                            <th>Date & Time</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>

                <!-- Pagination -->
                <div class="table-pagination">
                    <div class="pagination-left">
                        <span>Rows per page:</span>
                        <select class="pagination-select">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                            <option value="100" selected>100</option>
                        </select>
                    </div>
                    <div class="pagination-center">
                        <span></span>
                    </div>
                    <div class="pagination-right">
                        <span>Page:</span>
                        <input type="number" class="pagination-input" value="1" min="1" max="3">
                        <span>of 3</span>
                        <button class="pagination-arrow" disabled><i class="fas fa-chevron-left"></i></button>
                        <button class="pagination-arrow"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- Creative Preview Modal -->
            <div id="creative-preview-modal" class="creative-modal">
                <div class="creative-modal-content">
                    <span class="creative-modal-close">&times;</span>
                    <img id="creative-preview-image" src="" alt="Ad Creative Preview">
                </div>
            </div>

            <!-- Facebook Connection Section -->
            <div id="facebook-connection-section" class="table-section dashboard-section">
                <div class="table-header">
                    <h3><i class="fab fa-facebook" style="color: #1877f2;"></i> Facebook Connection</h3>
                </div>
                <div style="padding: 24px;">
                    <p style="color: var(--text-secondary); margin-bottom: 24px;">Connect your Facebook Business Account to sync campaign data automatically.</p>

                    <!-- Connected Account -->
                    <div class="config-section">
                        <h4><i class="fas fa-check-circle" style="color: var(--success-color);"></i> Connected Account</h4>
                        <div style="display: flex; align-items: center; gap: 16px; padding: 16px; background: white; border-radius: 8px; border: 1px solid var(--border-color);">
                            <div style="width: 48px; height: 48px; border-radius: 50%; background: #1877f2; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px;">
                                <i class="fab fa-facebook-f"></i>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; font-size: 16px;">Pabbly Business Account</div>
                                <div style="color: var(--text-secondary); font-size: 13px;">Business ID: 1234567890123456</div>
                                <div style="color: var(--success-color); font-size: 12px; margin-top: 4px;"><i class="fas fa-check-circle"></i> Connected on Jan 15, 2026</div>
                            </div>
                            <button class="btn-secondary"><i class="fas fa-sync-alt"></i> Refresh Token</button>
                            <button class="btn-secondary" style="color: var(--danger-color); border-color: var(--danger-color);"><i class="fas fa-unlink"></i> Disconnect</button>
                        </div>
                    </div>

                    <!-- Ad Accounts -->
                    <div class="config-section">
                        <h4><i class="fas fa-ad"></i> Linked Ad Accounts</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Ad Account Name</th>
                                    <th>Account ID</th>
                                    <th>Status</th>
                                    <th>Last Sync</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Pabbly Connect</strong></td>
                                    <td>act_123456789</td>
                                    <td><span class="status-badge active">Active</span></td>
                                    <td>5 min ago</td>
                                    <td><button class="action-btn view">Configure</button></td>
                                </tr>
                                <tr>
                                    <td><strong>Pabbly Chatflow</strong></td>
                                    <td>act_987654321</td>
                                    <td><span class="status-badge active">Active</span></td>
                                    <td>5 min ago</td>
                                    <td><button class="action-btn view">Configure</button></td>
                                </tr>
                                <tr>
                                    <td><strong>PSB</strong></td>
                                    <td>act_456789123</td>
                                    <td><span class="status-badge active">Active</span></td>
                                    <td>5 min ago</td>
                                    <td><button class="action-btn view">Configure</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Sync Settings -->
                    <div class="config-section">
                        <h4><i class="fas fa-clock"></i> Sync Settings</h4>
                        <div class="config-grid">
                            <div class="config-item">
                                <label>Data Sync Frequency</label>
                                <select class="config-input">
                                    <option>Every 15 minutes</option>
                                    <option selected>Every 30 minutes</option>
                                    <option>Every 1 hour</option>
                                </select>
                                <span class="input-help">How often to fetch data from Facebook API</span>
                            </div>
                            <div class="config-item">
                                <label>Creative Sync Frequency</label>
                                <select class="config-input">
                                    <option>Every 3 hours</option>
                                    <option selected>Every 6 hours</option>
                                    <option>Every 12 hours</option>
                                </select>
                                <span class="input-help">How often to fetch ad images (rate limit safe)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Webhooks and API Section -->
            <div id="webhooks-section" class="table-section dashboard-section">
                <div class="table-header">
                    <h3><i class="fas fa-plug" style="color: var(--primary-color);"></i> Webhook & API</h3>
                </div>

                <!-- Tabs -->
                <div class="tabs-container" style="border-bottom: 2px solid var(--border-color); margin: 0; display: flex; justify-content: space-between; align-items: center; padding-right: 16px;">
                    <div style="display: flex;">
                        <button class="tab-btn active" onclick="switchWebhookTab('webhooks')">
                            <i class="fas fa-plug"></i> Webhooks
                        </button>
                        <button class="tab-btn" onclick="switchWebhookTab('api')">
                            <i class="fas fa-code"></i> API
                        </button>
                    </div>
                    <button onclick="showWebhookForm()" id="add-webhook-btn" class="btn-primary" style="display: flex; align-items: center; gap: 6px;"><i class="fas fa-plus"></i> Add Webhook</button>
                </div>

                <!-- Webhook Tab -->
                <div id="webhooks-tab" class="tab-content active" style="padding: 20px;">
                    <p style="color: var(--text-secondary); margin-bottom: 16px; font-size: 13px;">
                        Receive real-time notifications when specific events happen in your dashboard.
                    </p>

                    <!-- Saved Webhooks List -->
                    <div id="webhooks-list"></div>

                    <!-- Empty state when no webhooks -->
                    <div id="webhooks-empty" style="text-align: center; padding: 40px 20px; color: var(--text-secondary); display: none;">
                        <i class="fas fa-plug" style="font-size: 32px; margin-bottom: 12px; opacity: 0.3;"></i>
                        <p style="margin: 0; font-size: 13px;">No webhooks configured yet. Click <strong>Add Webhook</strong> to get started.</p>
                    </div>

                    <!-- Webhook Form (hidden by default) -->
                    <div id="webhook-form-area" style="display: none; background: #f8f9fa; border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-top: 12px;">
                        <h4 style="margin: 0 0 16px 0; font-size: 14px; color: var(--text-primary);">
                            <i class="fas fa-plug" style="color: var(--primary-color); margin-right: 6px;"></i>
                            <span id="webhook-form-title">Add Webhook</span>
                        </h4>

                        <div style="display: grid; gap: 14px;">
                            <!-- Webhook Name -->
                            <div>
                                <label style="display: block; font-size: 12px; font-weight: 500; margin-bottom: 4px;">
                                    Webhook Name <span style="color: #dc2626;">*</span>
                                </label>
                                <input type="text" id="webhook-name" placeholder="e.g., Google Chat Notifications"
                                    style="width: 100%; padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px; box-sizing: border-box;">
                            </div>

                            <!-- Webhook URL -->
                            <div>
                                <label style="display: block; font-size: 12px; font-weight: 500; margin-bottom: 4px;">
                                    Webhook URL <span style="color: #dc2626;">*</span>
                                </label>
                                <input type="url" id="webhook-url" placeholder="https://example.com/webhook/endpoint"
                                    style="width: 100%; padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px; box-sizing: border-box;">
                                <span style="font-size: 11px; color: var(--text-secondary); margin-top: 4px; display: block;">The endpoint URL where data will be sent when a trigger fires.</span>
                            </div>

                            <!-- Triggers -->
                            <div>
                                <label style="display: block; font-size: 12px; font-weight: 500; margin-bottom: 6px;">
                                    Select Triggers <span style="color: #dc2626;">*</span>
                                </label>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 6px; background: white;">
                                        <input type="checkbox" class="webhook-trigger" value="new_sale" style="accent-color: var(--primary-color);">
                                        <span style="font-size: 12px; font-weight: 500;">New Sale</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 6px; background: white;">
                                        <input type="checkbox" class="webhook-trigger" value="new_lead" style="accent-color: var(--primary-color);">
                                        <span style="font-size: 12px; font-weight: 500;">New Lead Captured</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 6px; background: white;">
                                        <input type="checkbox" class="webhook-trigger" value="overspend_alert" style="accent-color: var(--primary-color);">
                                        <span style="font-size: 12px; font-weight: 500;">Overspend Alert</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 6px; background: white;">
                                        <input type="checkbox" class="webhook-trigger" value="low_roas_alert" style="accent-color: var(--primary-color);">
                                        <span style="font-size: 12px; font-weight: 500;">Low ROAS Alert</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 6px; background: white;">
                                        <input type="checkbox" class="webhook-trigger" value="high_frequency" style="accent-color: var(--primary-color);">
                                        <span style="font-size: 12px; font-weight: 500;">High Ad Frequency</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 6px; background: white;">
                                        <input type="checkbox" class="webhook-trigger" value="daily_report" style="accent-color: var(--primary-color);">
                                        <span style="font-size: 12px; font-weight: 500;">Daily Summary Report</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 6px; background: white;">
                                        <input type="checkbox" class="webhook-trigger" value="pixel_status" style="accent-color: var(--primary-color);">
                                        <span style="font-size: 12px; font-weight: 500;">Pixel Status Change</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 6px; background: white;">
                                        <input type="checkbox" class="webhook-trigger" value="campaign_status" style="accent-color: var(--primary-color);">
                                        <span style="font-size: 12px; font-weight: 500;">Campaign Status Change</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div style="display: flex; justify-content: flex-end; align-items: center; margin-top: 16px; padding-top: 14px; border-top: 1px solid var(--border-color); gap: 10px;">
                            <button type="button" onclick="cancelWebhookForm()" style="padding: 8px 16px; border: 1px solid var(--border-color); background: white; border-radius: 6px; cursor: pointer; font-size: 13px;">
                                Cancel
                            </button>
                            <button type="button" onclick="saveAndTestWebhook()" style="padding: 8px 16px; border: 1px solid var(--primary-color); background: white; color: var(--primary-color); border-radius: 6px; cursor: pointer; font-size: 13px; display: flex; align-items: center; gap: 6px;">
                                <i class="fas fa-paper-plane"></i> Save & Test
                            </button>
                            <button type="button" onclick="saveWebhookSimple()" class="btn-primary" style="padding: 8px 16px; font-size: 13px;">
                                Save Webhook
                            </button>
                        </div>
                    </div>
                </div>

                <!-- API Tab -->
                <div id="api-tab" class="tab-content" style="padding: 20px;">
                    <p style="color: var(--text-secondary); margin-bottom: 16px; font-size: 13px;">
                        Connect this dashboard with your automation tools like Pabbly Connect, Zapier, or any custom integration.
                    </p>

                    <!-- API Key Card -->
                    <div style="border: 1px solid var(--border-color); border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <div style="font-size: 13px; font-weight: 600;">API Key</div>
                            <span class="status-badge active" style="font-size: 11px;">Active</span>
                        </div>
                        <div style="display: flex; gap: 8px; align-items: center; margin-bottom: 8px;">
                            <input type="password" id="api-key-display" value="dbk_demo_a1b2c3d4e5f6g7h8i9j0k1l2m3" readonly
                                style="flex: 1; padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 12px; font-family: monospace; background: #f8f9fa; box-sizing: border-box;">
                            <button onclick="toggleApiKeyVisibility()" id="api-key-toggle-btn" style="padding: 8px 12px; border: 1px solid var(--border-color); background: white; border-radius: 6px; cursor: pointer; font-size: 12px; white-space: nowrap;">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button onclick="copyApiKey()" style="padding: 8px 12px; border: 1px solid var(--border-color); background: white; border-radius: 6px; cursor: pointer; font-size: 12px; white-space: nowrap;">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                            <button onclick="regenerateApiKey()" style="padding: 8px 12px; border: 1px solid #fecaca; background: #fef2f2; color: #dc2626; border-radius: 6px; cursor: pointer; font-size: 12px; white-space: nowrap;">
                                <i class="fas fa-sync-alt"></i> Regenerate
                            </button>
                        </div>
                        <p style="font-size: 11px; color: var(--text-secondary); margin: 0;">
                            Include in request header: <code style="background: #f0f0f0; padding: 2px 6px; border-radius: 3px; font-size: 11px;">Authorization: Bearer YOUR_API_KEY</code>
                        </p>
                    </div>

                    <!-- Base URL -->
                    <div style="border: 1px solid var(--border-color); border-radius: 8px; padding: 12px 16px; margin-bottom: 16px; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">Base URL</div>
                            <code style="font-size: 13px; color: var(--text-primary); font-weight: 500;">https://api.dashboard.pabbly.com/v1</code>
                        </div>
                        <button onclick="navigator.clipboard.writeText('https://api.dashboard.pabbly.com/v1'); this.innerHTML='<i class=\'fas fa-check\'></i>'; setTimeout(()=>this.innerHTML='<i class=\'fas fa-copy\'></i>',1500)" style="padding: 6px 10px; border: 1px solid var(--border-color); background: white; border-radius: 6px; cursor: pointer; font-size: 12px;">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>

                    <!-- Endpoints Table -->
                    <div style="font-size: 13px; font-weight: 600; margin-bottom: 10px;">Available Endpoints</div>
                    <table class="data-table" style="margin-bottom: 16px;">
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Endpoint</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span style="background: #e6f7f1; color: var(--success-color); padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">GET</span></td>
                                <td><code style="font-size: 12px;">/metrics</code></td>
                                <td style="font-size: 12px; color: var(--text-secondary);">Ad spend, revenue, ROAS, leads, and CPL for selected account</td>
                            </tr>
                            <tr>
                                <td><span style="background: #e6f7f1; color: var(--success-color); padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">GET</span></td>
                                <td><code style="font-size: 12px;">/campaigns</code></td>
                                <td style="font-size: 12px; color: var(--text-secondary);">All campaigns with spend, revenue, ROAS, and status</td>
                            </tr>
                            <tr>
                                <td><span style="background: #e6f7f1; color: var(--success-color); padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">GET</span></td>
                                <td><code style="font-size: 12px;">/adsets</code></td>
                                <td style="font-size: 12px; color: var(--text-secondary);">All ad sets with performance data and budget info</td>
                            </tr>
                            <tr>
                                <td><span style="background: #e6f7f1; color: var(--success-color); padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">GET</span></td>
                                <td><code style="font-size: 12px;">/leads</code></td>
                                <td style="font-size: 12px; color: var(--text-secondary);">All captured leads with date and status</td>
                            </tr>
                            <tr>
                                <td><span style="background: #e6f7f1; color: var(--success-color); padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">GET</span></td>
                                <td><code style="font-size: 12px;">/revenue</code></td>
                                <td style="font-size: 12px; color: var(--text-secondary);">Revenue transactions from Pabbly Subscription Billing</td>
                            </tr>
                            <tr>
                                <td><span style="background: #e6f7f1; color: var(--success-color); padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">GET</span></td>
                                <td><code style="font-size: 12px;">/alerts</code></td>
                                <td style="font-size: 12px; color: var(--text-secondary);">Active alerts for overspending, low ROAS, frequency, etc.</td>
                            </tr>
                            <tr>
                                <td><span style="background: #fff3e0; color: #e65100; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">POST</span></td>
                                <td><code style="font-size: 12px;">/leads</code></td>
                                <td style="font-size: 12px; color: var(--text-secondary);">Add a new lead entry to the dashboard</td>
                            </tr>
                            <tr>
                                <td><span style="background: #fff3e0; color: #e65100; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">POST</span></td>
                                <td><code style="font-size: 12px;">/revenue</code></td>
                                <td style="font-size: 12px; color: var(--text-secondary);">Add a new revenue/sale entry to the dashboard</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Usage Example -->
                    <div style="font-size: 13px; font-weight: 600; margin-bottom: 10px;">Quick Example</div>
                    <div style="background: #1e293b; border-radius: 8px; padding: 14px; overflow-x: auto;">
                        <pre style="margin: 0; color: #e2e8f0; font-size: 12px; line-height: 1.6;"><code><span style="color: #94a3b8;">// Fetch metrics using API</span>
<span style="color: #7dd3fc;">fetch</span>(<span style="color: #86efac;">'https://api.dashboard.pabbly.com/v1/metrics'</span>, {
  <span style="color: #fbbf24;">headers</span>: {
    <span style="color: #86efac;">'Authorization'</span>: <span style="color: #86efac;">'Bearer dbk_demo_a1b2c3...'</span>
  }
})
.<span style="color: #7dd3fc;">then</span>(res => res.<span style="color: #7dd3fc;">json</span>())
.<span style="color: #7dd3fc;">then</span>(data => <span style="color: #7dd3fc;">console</span>.<span style="color: #7dd3fc;">log</span>(data));</code></pre>
                    </div>

                    <!-- Response Example -->
                    <div style="font-size: 13px; font-weight: 600; margin: 16px 0 10px 0;">Sample Response</div>
                    <div style="background: #1e293b; border-radius: 8px; padding: 14px; overflow-x: auto;">
                        <pre style="margin: 0; color: #e2e8f0; font-size: 12px; line-height: 1.6;"><code>{
  <span style="color: #86efac;">"status"</span>: <span style="color: #86efac;">"success"</span>,
  <span style="color: #86efac;">"data"</span>: {
    <span style="color: #86efac;">"ad_spend"</span>: <span style="color: #fbbf24;">336.00</span>,
    <span style="color: #86efac;">"revenue"</span>: <span style="color: #fbbf24;">1999.00</span>,
    <span style="color: #86efac;">"roas"</span>: <span style="color: #fbbf24;">5.94</span>,
    <span style="color: #86efac;">"leads"</span>: <span style="color: #fbbf24;">39</span>,
    <span style="color: #86efac;">"cpl"</span>: <span style="color: #fbbf24;">8.62</span>,
    <span style="color: #86efac;">"currency"</span>: <span style="color: #86efac;">"USD"</span>
  }
}</code></pre>
                    </div>
                </div>
            </div>

            <!-- Alert Thresholds Section -->
            <div id="alert-thresholds-section" class="table-section dashboard-section">
                <div class="table-header">
                    <h3><i class="fas fa-bell" style="color: var(--primary-color);"></i> Alert & Budget Settings</h3>
                </div>
                <div style="padding: 24px;">
                    <p style="color: var(--text-secondary); margin-bottom: 24px;">
                        Set global threshold rules that apply to ALL campaigns, ad sets, ads, and countries.
                        Monitoring activates after spend exceeds threshold. Alert triggers when: <strong>ROAS < Target ROAS</strong> (continuous monitoring using lifetime cumulative data)
                    </p>

                    <!-- Threshold Rules Table -->
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Level</th>
                                <th>Description</th>
                                <th>Spend Threshold</th>
                                <th>ROAS Target</th>
                                <th>Time Window</th>
                                <th>Alert Rule</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <i class="fas fa-bullhorn" style="color: var(--primary-color); font-size: 18px;"></i>
                                        <strong>Campaigns</strong>
                                    </div>
                                </td>
                                <td style="color: var(--text-secondary);">Applies to all campaigns</td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 4px;">
                                        <span>$</span>
                                        <input type="number" class="config-input" value="1400" style="width: 100px;">
                                    </div>
                                </td>
                                <td>
                                    <input type="number" class="config-input" value="1.0" step="0.1" style="width: 80px;">
                                </td>
                                <td>
                                    <span class="status-badge status-active">Lifetime</span>
                                </td>
                                <td style="color: var(--text-secondary); font-size: 13px;">
                                    After spend > $1,400, if ROAS < 1.0 â†’ Alert
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <i class="fas fa-layer-group" style="color: var(--primary-color); font-size: 18px;"></i>
                                        <strong>Ad Sets</strong>
                                    </div>
                                </td>
                                <td style="color: var(--text-secondary);">Applies to all ad sets</td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 4px;">
                                        <span>$</span>
                                        <input type="number" class="config-input" value="700" style="width: 100px;">
                                    </div>
                                </td>
                                <td>
                                    <input type="number" class="config-input" value="1.0" step="0.1" style="width: 80px;">
                                </td>
                                <td>
                                    <span class="status-badge status-active">Lifetime</span>
                                </td>
                                <td style="color: var(--text-secondary); font-size: 13px;">
                                    After spend > $700, if ROAS < 1.0 â†’ Alert
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <i class="fas fa-ad" style="color: var(--primary-color); font-size: 18px;"></i>
                                        <strong>Ads</strong>
                                    </div>
                                </td>
                                <td style="color: var(--text-secondary);">Applies to all ads</td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 4px;">
                                        <span>$</span>
                                        <input type="number" class="config-input" value="350" style="width: 100px;">
                                    </div>
                                </td>
                                <td>
                                    <input type="number" class="config-input" value="1.0" step="0.1" style="width: 80px;">
                                </td>
                                <td>
                                    <span class="status-badge status-active">Lifetime</span>
                                </td>
                                <td style="color: var(--text-secondary); font-size: 13px;">
                                    After spend > $350, if ROAS < 1.0 â†’ Alert
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <i class="fas fa-globe" style="color: var(--primary-color); font-size: 18px;"></i>
                                        <strong>Country Performance</strong>
                                    </div>
                                </td>
                                <td style="color: var(--text-secondary);">Applies to all countries</td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 4px;">
                                        <span>$</span>
                                        <input type="number" class="config-input" value="500" style="width: 100px;">
                                    </div>
                                </td>
                                <td>
                                    <input type="number" class="config-input" value="1.0" step="0.1" style="width: 80px;">
                                </td>
                                <td>
                                    <span class="status-badge status-active">Lifetime</span>
                                </td>
                                <td style="color: var(--text-secondary); font-size: 13px;">
                                    After spend > $500, if ROAS < 1.0 → Alert
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <i class="fas fa-redo-alt" style="color: var(--primary-color); font-size: 18px;"></i>
                                        <strong>Frequency</strong>
                                    </div>
                                </td>
                                <td style="color: var(--text-secondary);">Applies to all levels</td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 4px;">
                                        <span>&gt;</span>
                                        <input type="number" id="frequency-threshold-value" class="config-input" value="3" min="1" step="0.5" style="width: 100px;">
                                    </div>
                                </td>
                                <td>
                                    <span style="color: var(--text-secondary); font-size: 13px;">—</span>
                                </td>
                                <td>
                                    <span class="status-badge status-active">Lifetime</span>
                                </td>
                                <td style="color: var(--text-secondary); font-size: 13px;">
                                    If frequency &gt; 3, trigger alert
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Notification Settings -->
                    <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid var(--border-color);">
                        <h4 style="margin-bottom: 16px;"><i class="fas fa-bell"></i> Notification Settings</h4>
                        <div style="display: flex; flex-direction: column; gap: 12px;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="checkbox" checked>
                                <span>Send Google Chat notifications when thresholds are exceeded</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="checkbox" checked>
                                <span>Show in-app alerts for threshold breaches</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="checkbox">
                                <span>Send daily summary email</span>
                            </label>
                        </div>
                    </div>

                    <div style="margin-top: 24px; display: flex; gap: 12px;">
                        <button class="btn-primary" onclick="saveAlertSettings()"><i class="fas fa-save"></i> Save Settings</button>
                        <button class="btn-secondary"><i class="fas fa-undo"></i> Reset to Defaults</button>
                    </div>
                </div>
            </div>

            <!-- User Management Section -->
            <div id="user-management-section" class="table-section dashboard-section">
                <div class="table-header">
                    <h3><i class="fas fa-user-cog" style="color: var(--primary-color);"></i> User Management</h3>
                    <button class="btn-primary" onclick="openAddUserModal()"><i class="fas fa-plus"></i> Add User</button>
                </div>
                <div style="padding: 24px;">
                    <p style="color: var(--text-secondary); margin-bottom: 24px;">Manage team members and their access permissions.</p>

                    <!-- Users Table -->
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Email</th>
                                <th>Access Type</th>
                                <th>Ad Accounts</th>
                                <th>Page Access</th>
                                <th>Last Active</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="users-tbody">
                            <tr>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <div style="width: 36px; height: 36px; border-radius: 50%; background: var(--primary-color); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600;">JD</div>
                                        <div>
                                            <div style="font-weight: 600;">John Doe</div>
                                            <div style="font-size: 12px; color: var(--text-secondary);">Owner</div>
                                        </div>
                                    </div>
                                </td>
                                <td>john@pabbly.com</td>
                                <td><span class="status-badge active">Full Access</span></td>
                                <td>All Accounts</td>
                                <td><span style="font-size: 12px; color: var(--text-secondary);">All Pages</span></td>
                                <td>Just now</td>
                                <td><span style="color: var(--text-secondary); font-size: 12px;">Owner</span></td>
                            </tr>
                            <tr>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <div style="width: 36px; height: 36px; border-radius: 50%; background: #6366f1; color: white; display: flex; align-items: center; justify-content: center; font-weight: 600;">SM</div>
                                        <div>
                                            <div style="font-weight: 600;">Sarah Miller</div>
                                        </div>
                                    </div>
                                </td>
                                <td>sarah@pabbly.com</td>
                                <td><span class="status-badge active">Full Access</span></td>
                                <td>Pabbly Connect, Pabbly Chatflow</td>
                                <td><span style="font-size: 12px; color: var(--text-secondary);">All Pages</span></td>
                                <td>2 hours ago</td>
                                <td>
                                    <div class="action-menu">
                                        <button class="action-menu-btn" onclick="toggleActionMenu(this)"><i class="fas fa-ellipsis-v"></i></button>
                                        <div class="action-menu-dropdown">
                                            <button class="action-menu-item" onclick="editUser(this)"><i class="fas fa-edit"></i> Edit</button>
                                            <button class="action-menu-item delete" onclick="removeUser(this)"><i class="fas fa-trash"></i> Remove</button>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <div style="width: 36px; height: 36px; border-radius: 50%; background: #f59e0b; color: white; display: flex; align-items: center; justify-content: center; font-weight: 600;">MK</div>
                                        <div>
                                            <div style="font-weight: 600;">Mike Kumar</div>
                                        </div>
                                    </div>
                                </td>
                                <td>mike@pabbly.com</td>
                                <td><span class="status-badge" style="background: #f0f2f5; color: var(--text-secondary);">Read Access</span></td>
                                <td>Pabbly Connect</td>
                                <td><span style="font-size: 12px; color: var(--text-secondary);">Overview Metrics, Campaigns, Alerts</span></td>
                                <td>1 day ago</td>
                                <td>
                                    <div class="action-menu">
                                        <button class="action-menu-btn" onclick="toggleActionMenu(this)"><i class="fas fa-ellipsis-v"></i></button>
                                        <div class="action-menu-dropdown">
                                            <button class="action-menu-item" onclick="editUser(this)"><i class="fas fa-edit"></i> Edit</button>
                                            <button class="action-menu-item delete" onclick="removeUser(this)"><i class="fas fa-trash"></i> Remove</button>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Access Type Info -->
                    <div style="margin-top: 20px; display: flex; gap: 16px;">
                        <div style="flex: 1; padding: 16px; background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px;">
                            <div style="font-weight: 600; font-size: 13px; color: #166534; margin-bottom: 4px;"><i class="fas fa-unlock"></i> Full Access</div>
                            <div style="font-size: 12px; color: #166534;">Can view and edit selected pages for assigned ad accounts. Page access is configurable per user.</div>
                        </div>
                        <div style="flex: 1; padding: 16px; background: #f8fafc; border: 1px solid var(--border-color); border-radius: 8px;">
                            <div style="font-weight: 600; font-size: 13px; color: var(--text-secondary); margin-bottom: 4px;"><i class="fas fa-eye"></i> Read Access</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Can only view selected pages (read-only). Page access is configurable per user.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Add User Modal -->
            <div id="add-user-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--card-bg); border-radius: 12px; width: 500px; max-width: 90vw; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                    <div style="padding: 20px 24px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0; font-size: 16px;"><i class="fas fa-user-plus" style="color: var(--primary-color); margin-right: 8px;"></i>Add New User</h3>
                        <button onclick="closeAddUserModal()" style="background: none; border: none; font-size: 20px; cursor: pointer; color: var(--text-secondary);">&times;</button>
                    </div>
                    <form id="add-user-form" onsubmit="submitAddUser(event)" style="padding: 24px;">
                        <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                            <div style="flex: 1;">
                                <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px;">First Name <span style="color: #dc2626;">*</span></label>
                                <input type="text" id="user-first-name" required placeholder="Enter first name" style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px; box-sizing: border-box;">
                            </div>
                            <div style="flex: 1;">
                                <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px;">Last Name <span style="color: #dc2626;">*</span></label>
                                <input type="text" id="user-last-name" required placeholder="Enter last name" style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px; box-sizing: border-box;">
                            </div>
                        </div>
                        <div style="margin-bottom: 16px;">
                            <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px;">Email <span style="color: #dc2626;">*</span></label>
                            <input type="email" id="user-email" required placeholder="Enter email address" style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px; box-sizing: border-box;">
                        </div>
                        <div style="margin-bottom: 16px;">
                            <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px;">Access Type <span style="color: #dc2626;">*</span></label>
                            <div style="display: flex; gap: 12px;">
                                <label style="flex: 1; display: flex; align-items: center; gap: 10px; padding: 12px 16px; border: 2px solid var(--border-color); border-radius: 8px; cursor: pointer; transition: all 0.2s;" id="access-full-label">
                                    <input type="radio" name="access-type" value="full" required onchange="updateAccessStyle()" style="accent-color: var(--primary-color);">
                                    <div>
                                        <div style="font-weight: 600; font-size: 13px;">Full Access</div>
                                        <div style="font-size: 11px; color: var(--text-secondary);">Dashboard, Alerts, Data Management, Settings</div>
                                    </div>
                                </label>
                                <label style="flex: 1; display: flex; align-items: center; gap: 10px; padding: 12px 16px; border: 2px solid var(--border-color); border-radius: 8px; cursor: pointer; transition: all 0.2s;" id="access-read-label">
                                    <input type="radio" name="access-type" value="read" required onchange="updateAccessStyle()" style="accent-color: var(--primary-color);">
                                    <div>
                                        <div style="font-weight: 600; font-size: 13px;">Read Access</div>
                                        <div style="font-size: 11px; color: var(--text-secondary);">Dashboard and Alerts only</div>
                                    </div>
                                </label>
                            </div>
                        </div>
                        <div style="margin-bottom: 16px;">
                            <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px;">Ad Accounts <span style="color: #dc2626;">*</span></label>
                            <div id="ad-account-checkboxes" style="border: 1px solid var(--border-color); border-radius: 6px; padding: 12px; display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="ad-accounts" value="Pabbly Connect" style="accent-color: var(--primary-color);"> Pabbly Connect
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="ad-accounts" value="Pabbly Chatflow" style="accent-color: var(--primary-color);"> Pabbly Chatflow
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="ad-accounts" value="Pabbly Subscription" style="accent-color: var(--primary-color);"> Pabbly Subscription
                                </label>
                            </div>
                        </div>
                        <div style="margin-bottom: 24px;">
                            <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px;">Page Access <span style="color: #dc2626;">*</span></label>
                            <div id="page-access-checkboxes" style="border: 1px solid var(--border-color); border-radius: 6px; padding: 12px; display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px; font-weight: 600; border-bottom: 1px solid var(--border-color); padding-bottom: 8px;">
                                    <input type="checkbox" id="page-select-all" onchange="toggleAllPages(this)" style="accent-color: var(--primary-color);"> Select All
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="page-access" value="Overview Metrics" style="accent-color: var(--primary-color);"> Overview Metrics
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="page-access" value="Campaigns" style="accent-color: var(--primary-color);"> Campaigns
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="page-access" value="Ad Sets" style="accent-color: var(--primary-color);"> Ad Sets
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="page-access" value="Ads" style="accent-color: var(--primary-color);"> Ads
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="page-access" value="Country Performance" style="accent-color: var(--primary-color);"> Country Performance
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="page-access" value="Sales by Ad Creative" style="accent-color: var(--primary-color);"> Sales by Ad Creative
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="page-access" value="Alerts" style="accent-color: var(--primary-color);"> Alerts
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="page-access" value="Data Management" style="accent-color: var(--primary-color);"> Data Management
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="page-access" value="Settings" style="accent-color: var(--primary-color);"> Settings
                                </label>
                            </div>
                        </div>
                        <div style="display: flex; gap: 12px; justify-content: flex-end;">
                            <button type="button" onclick="closeAddUserModal()" style="padding: 10px 20px; border: 1px solid var(--border-color); border-radius: 6px; background: white; font-size: 13px; cursor: pointer;">Cancel</button>
                            <button type="submit" class="btn-primary" style="padding: 10px 20px; font-size: 13px;"><i class="fas fa-plus"></i> Add User</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Edit User Modal -->
            <div id="edit-user-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--card-bg); border-radius: 12px; width: 500px; max-width: 90vw; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                    <div style="padding: 20px 24px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0; font-size: 16px;"><i class="fas fa-user-edit" style="color: var(--primary-color); margin-right: 8px;"></i>Edit User</h3>
                        <button onclick="closeEditUserModal()" style="background: none; border: none; font-size: 20px; cursor: pointer; color: var(--text-secondary);">&times;</button>
                    </div>
                    <form id="edit-user-form" onsubmit="submitEditUser(event)" style="padding: 24px;">
                        <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                            <div style="flex: 1;">
                                <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px;">First Name <span style="color: #dc2626;">*</span></label>
                                <input type="text" id="edit-user-first-name" required style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px; box-sizing: border-box;">
                            </div>
                            <div style="flex: 1;">
                                <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px;">Last Name <span style="color: #dc2626;">*</span></label>
                                <input type="text" id="edit-user-last-name" required style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px; box-sizing: border-box;">
                            </div>
                        </div>
                        <div style="margin-bottom: 16px;">
                            <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px;">Email</label>
                            <input type="email" id="edit-user-email" disabled style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px; background: #f5f5f5; box-sizing: border-box;">
                        </div>
                        <div style="margin-bottom: 16px;">
                            <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px;">Access Type <span style="color: #dc2626;">*</span></label>
                            <div style="display: flex; gap: 12px;">
                                <label style="flex: 1; display: flex; align-items: center; gap: 10px; padding: 12px 16px; border: 2px solid var(--border-color); border-radius: 8px; cursor: pointer;" id="edit-access-full-label">
                                    <input type="radio" name="edit-access-type" value="full" required onchange="updateEditAccessStyle()" style="accent-color: var(--primary-color);">
                                    <div>
                                        <div style="font-weight: 600; font-size: 13px;">Full Access</div>
                                        <div style="font-size: 11px; color: var(--text-secondary);">Dashboard, Alerts, Data Management, Settings</div>
                                    </div>
                                </label>
                                <label style="flex: 1; display: flex; align-items: center; gap: 10px; padding: 12px 16px; border: 2px solid var(--border-color); border-radius: 8px; cursor: pointer;" id="edit-access-read-label">
                                    <input type="radio" name="edit-access-type" value="read" required onchange="updateEditAccessStyle()" style="accent-color: var(--primary-color);">
                                    <div>
                                        <div style="font-weight: 600; font-size: 13px;">Read Access</div>
                                        <div style="font-size: 11px; color: var(--text-secondary);">Dashboard and Alerts only</div>
                                    </div>
                                </label>
                            </div>
                        </div>
                        <div style="margin-bottom: 16px;">
                            <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px;">Ad Accounts <span style="color: #dc2626;">*</span></label>
                            <div id="edit-ad-account-checkboxes" style="border: 1px solid var(--border-color); border-radius: 6px; padding: 12px; display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="edit-ad-accounts" value="Pabbly Connect" style="accent-color: var(--primary-color);"> Pabbly Connect
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="edit-ad-accounts" value="Pabbly Chatflow" style="accent-color: var(--primary-color);"> Pabbly Chatflow
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="edit-ad-accounts" value="Pabbly Subscription" style="accent-color: var(--primary-color);"> Pabbly Subscription
                                </label>
                            </div>
                        </div>
                        <div style="margin-bottom: 24px;">
                            <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px;">Page Access <span style="color: #dc2626;">*</span></label>
                            <div id="edit-page-access-checkboxes" style="border: 1px solid var(--border-color); border-radius: 6px; padding: 12px; display: flex; flex-direction: column; gap: 8px;">
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px; font-weight: 600; border-bottom: 1px solid var(--border-color); padding-bottom: 8px;">
                                    <input type="checkbox" id="edit-page-select-all" onchange="toggleAllEditPages(this)" style="accent-color: var(--primary-color);"> Select All
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="edit-page-access" value="Overview Metrics" style="accent-color: var(--primary-color);"> Overview Metrics
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="edit-page-access" value="Campaigns" style="accent-color: var(--primary-color);"> Campaigns
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="edit-page-access" value="Ad Sets" style="accent-color: var(--primary-color);"> Ad Sets
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="edit-page-access" value="Ads" style="accent-color: var(--primary-color);"> Ads
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="edit-page-access" value="Country Performance" style="accent-color: var(--primary-color);"> Country Performance
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="edit-page-access" value="Sales by Ad Creative" style="accent-color: var(--primary-color);"> Sales by Ad Creative
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="edit-page-access" value="Alerts" style="accent-color: var(--primary-color);"> Alerts
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="edit-page-access" value="Data Management" style="accent-color: var(--primary-color);"> Data Management
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" name="edit-page-access" value="Settings" style="accent-color: var(--primary-color);"> Settings
                                </label>
                            </div>
                        </div>
                        <div style="display: flex; gap: 12px; justify-content: flex-end;">
                            <button type="button" onclick="closeEditUserModal()" style="padding: 10px 20px; border: 1px solid var(--border-color); border-radius: 6px; background: white; font-size: 13px; cursor: pointer;">Cancel</button>
                            <button type="submit" class="btn-primary" style="padding: 10px 20px; font-size: 13px;"><i class="fas fa-save"></i> Save Changes</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Sales Data Section -->
            <div id="pabbly-revenue-section" class="table-section dashboard-section">
                    <div class="table-header">
                        <h3><i class="fas fa-file-invoice-dollar"></i> Sales Data <span class="count">23 Entries</span></h3>
                        <div class="table-filter">
                            <select class="table-status-filter" style="min-width: 130px;">
                                <option>All Time</option>
                                <option>Today</option>
                                <option>This Week</option>
                                <option selected>This Month</option>
                                <option>Last 30 Days</option>
                                <option>Last 90 Days</option>
                            </select>
                            <select class="table-status-filter" id="revenue-country-filter" style="min-width: 150px;">
                                <option value="">All Countries</option>
                                <option value="us">United States</option>
                                <option value="in">India</option>
                                <option value="ca">Canada</option>
                                <option value="gb">United Kingdom</option>
                                <option value="de">Germany</option>
                                <option value="au">Australia</option>
                                <option value="fr">France</option>
                                <option value="nl">Netherlands</option>
                                <option value="br">Brazil</option>
                                <option value="sg">Singapore</option>
                            </select>
                            <div class="table-search-wrapper">
                                <i class="fas fa-search table-search-icon"></i>
                                <input type="text" id="revenue-search" class="table-search-input" placeholder="Search by Transaction ID...">
                            </div>
                            <button class="btn-primary" onclick="openAddRevenueModal()"><i class="fas fa-plus"></i> Add Entry</button>
                        </div>
                    </div>

                <!-- Revenue Table -->
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Date & Time</th>
                            <th>Email</th>
                            <th>Transaction ID</th>
                            <th>Plan</th>
                            <th>Country</th>
                            <th>Amount</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="revenue-transactions-tbody">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>

                <!-- Pagination -->
                <div class="table-pagination">
                    <div class="pagination-left">
                        <span>Rows per page:</span>
                        <select class="pagination-select">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                            <option value="100" selected>100</option>
                        </select>
                    </div>
                    <div class="pagination-center">
                        <span>1-6 of 23</span>
                    </div>
                    <div class="pagination-right">
                        <span>Page:</span>
                        <input type="number" class="pagination-input" value="1" min="1" max="2">
                        <span>of 2</span>
                        <button class="pagination-arrow" disabled><i class="fas fa-chevron-left"></i></button>
                        <button class="pagination-arrow"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- Add Revenue Entry Modal -->
            <div id="add-revenue-modal" class="modal" style="display: none;">
                <div class="modal-overlay" onclick="closeAddRevenueModal()"></div>
                <div class="modal-content" style="max-width: 500px;">
                    <div class="modal-header">
                        <h3 style="margin: 0; font-size: 18px;"><i class="fas fa-plus-circle" style="color: var(--primary-color); margin-right: 8px;"></i>Add Revenue Entry</h3>
                        <button class="modal-close" onclick="closeAddRevenueModal()"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="modal-body" style="padding: 20px;">
                        <form id="add-revenue-form">
                            <div style="display: grid; gap: 16px;">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                    <div>
                                        <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Date <span style="color: #dc2626;">*</span></label>
                                        <input type="date" id="revenue-date" required style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                    </div>
                                    <div>
                                        <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Time <span style="color: #dc2626;">*</span></label>
                                        <input type="time" id="revenue-time" required style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                    </div>
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Transaction ID <span style="color: var(--text-secondary);">(Optional)</span></label>
                                    <input type="text" id="revenue-txn-id" placeholder="e.g., TXN_2026012446" style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Plan Name <span style="color: #dc2626;">*</span></label>
                                    <input type="text" id="revenue-plan" required placeholder="Enter plan name" style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Country <span style="color: #dc2626;">*</span></label>
                                    <input type="text" id="revenue-country" list="country-suggestions" required placeholder="Search or select country..." style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                    <datalist id="country-suggestions">
                                        <option value="Afghanistan">
                                        <option value="Albania">
                                        <option value="Algeria">
                                        <option value="Argentina">
                                        <option value="Australia">
                                        <option value="Austria">
                                        <option value="Bangladesh">
                                        <option value="Belgium">
                                        <option value="Brazil">
                                        <option value="Canada">
                                        <option value="Chile">
                                        <option value="China">
                                        <option value="Colombia">
                                        <option value="Czech Republic">
                                        <option value="Denmark">
                                        <option value="Egypt">
                                        <option value="Finland">
                                        <option value="France">
                                        <option value="Germany">
                                        <option value="Greece">
                                        <option value="Hong Kong">
                                        <option value="Hungary">
                                        <option value="India">
                                        <option value="Indonesia">
                                        <option value="Ireland">
                                        <option value="Israel">
                                        <option value="Italy">
                                        <option value="Japan">
                                        <option value="Kenya">
                                        <option value="Malaysia">
                                        <option value="Mexico">
                                        <option value="Netherlands">
                                        <option value="New Zealand">
                                        <option value="Nigeria">
                                        <option value="Norway">
                                        <option value="Pakistan">
                                        <option value="Peru">
                                        <option value="Philippines">
                                        <option value="Poland">
                                        <option value="Portugal">
                                        <option value="Romania">
                                        <option value="Russia">
                                        <option value="Saudi Arabia">
                                        <option value="Singapore">
                                        <option value="South Africa">
                                        <option value="South Korea">
                                        <option value="Spain">
                                        <option value="Sri Lanka">
                                        <option value="Sweden">
                                        <option value="Switzerland">
                                        <option value="Taiwan">
                                        <option value="Thailand">
                                        <option value="Turkey">
                                        <option value="Ukraine">
                                        <option value="United Arab Emirates">
                                        <option value="United Kingdom">
                                        <option value="United States">
                                        <option value="Vietnam">
                                    </datalist>
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Amount ($) <span style="color: #dc2626;">*</span></label>
                                    <input type="number" id="revenue-amount" required placeholder="e.g., 700" min="0" step="0.01" style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Source</label>
                                    <select id="revenue-source" style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                        <option value="Manual">Manual</option>
                                        <option value="Razorpay">Razorpay</option>
                                        <option value="PayPal">PayPal</option>
                                        <option value="Stripe">Stripe</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer" style="padding: 16px 20px; border-top: 1px solid var(--border-color); display: flex; justify-content: flex-end; gap: 12px;">
                        <button type="button" onclick="closeAddRevenueModal()" style="padding: 10px 20px; border: 1px solid var(--border-color); border-radius: 6px; background: white; font-size: 13px; cursor: pointer;">Cancel</button>
                        <button type="submit" form="add-revenue-form" class="btn-primary" style="padding: 10px 20px;"><i class="fas fa-plus"></i> Add Entry</button>
                    </div>
                </div>
            </div>

            <!-- Edit Revenue Entry Modal -->
            <div id="edit-revenue-modal" class="modal" style="display: none;">
                <div class="modal-overlay" onclick="closeEditRevenueModal()"></div>
                <div class="modal-content" style="max-width: 500px;">
                    <div class="modal-header">
                        <h3 style="margin: 0; font-size: 18px;"><i class="fas fa-edit" style="color: var(--primary-color); margin-right: 8px;"></i>Edit Revenue Entry</h3>
                        <button class="modal-close" onclick="closeEditRevenueModal()"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="modal-body" style="padding: 20px;">
                        <form id="edit-revenue-form">
                            <div style="display: grid; gap: 16px;">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                    <div>
                                        <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Date <span style="color: #dc2626;">*</span></label>
                                        <input type="date" id="edit-revenue-date" required style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                    </div>
                                    <div>
                                        <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Time <span style="color: #dc2626;">*</span></label>
                                        <input type="time" id="edit-revenue-time" required style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                    </div>
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Transaction ID</label>
                                    <input type="text" id="edit-revenue-txn-id" style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Plan Name <span style="color: #dc2626;">*</span></label>
                                    <input type="text" id="edit-revenue-plan" required placeholder="Enter plan name" style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Country <span style="color: #dc2626;">*</span></label>
                                    <input type="text" id="edit-revenue-country" list="country-suggestions" required style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Amount ($) <span style="color: #dc2626;">*</span></label>
                                    <input type="number" id="edit-revenue-amount" required min="0" step="0.01" style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Source</label>
                                    <select id="edit-revenue-source" style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                        <option value="Manual">Manual</option>
                                        <option value="Razorpay">Razorpay</option>
                                        <option value="PayPal">PayPal</option>
                                        <option value="Stripe">Stripe</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer" style="padding: 16px 20px; border-top: 1px solid var(--border-color); display: flex; justify-content: flex-end; gap: 12px;">
                        <button type="button" onclick="closeEditRevenueModal()" style="padding: 10px 20px; border: 1px solid var(--border-color); border-radius: 6px; background: white; font-size: 13px; cursor: pointer;">Cancel</button>
                        <button type="submit" form="edit-revenue-form" class="btn-primary" style="padding: 10px 20px;"><i class="fas fa-save"></i> Save Changes</button>
                    </div>
                </div>
            </div>

            <!-- Delete Confirmation Modal -->
            <div id="delete-confirm-modal" class="modal" style="display: none;">
                <div class="modal-overlay" onclick="closeDeleteModal()"></div>
                <div class="modal-content" style="max-width: 400px;">
                    <div class="modal-header" style="border-bottom: none; padding-bottom: 0;">
                        <h3 style="margin: 0; font-size: 18px;"><i class="fas fa-exclamation-triangle" style="color: #dc2626; margin-right: 8px;"></i>Confirm Delete</h3>
                        <button class="modal-close" onclick="closeDeleteModal()"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="modal-body" style="padding: 20px; text-align: center;">
                        <p style="color: var(--text-secondary); margin: 0 0 8px 0;">Are you sure you want to delete this entry?</p>
                        <p style="font-weight: 600; color: var(--text-color); margin: 0;" id="delete-entry-info">Transaction: TXN_XXXXXXXX</p>
                        <p style="color: #dc2626; font-size: 13px; margin: 16px 0 0 0;"><i class="fas fa-info-circle"></i> This action cannot be undone.</p>
                    </div>
                    <div class="modal-footer" style="padding: 16px 20px; border-top: 1px solid var(--border-color); display: flex; justify-content: center; gap: 12px;">
                        <button type="button" onclick="closeDeleteModal()" style="padding: 10px 24px; border: 1px solid var(--border-color); border-radius: 6px; background: white; font-size: 13px; cursor: pointer;">Cancel</button>
                        <button type="button" onclick="deleteEntry()" style="padding: 10px 24px; border: none; border-radius: 6px; background: #dc2626; color: white; font-size: 13px; cursor: pointer; font-weight: 500;"><i class="fas fa-trash"></i> Delete</button>
                    </div>
                </div>
            </div>

            <!-- Leads Data Section -->
            <div id="leads-data-section" class="table-section dashboard-section">
                <div class="table-header">
                    <h3><i class="fas fa-user-plus" style="color: var(--primary-color);"></i> Leads Data <span class="count">156 Leads</span></h3>
                    <div class="table-filter">
                        <select class="table-status-filter" style="min-width: 130px;">
                            <option>All Time</option>
                            <option>Today</option>
                            <option>This Week</option>
                            <option selected>This Month</option>
                            <option>Last 30 Days</option>
                            <option>Last 90 Days</option>
                        </select>
                        <select class="table-status-filter" id="lead-source-filter" style="min-width: 150px;">
                            <option value="">All Sources</option>
                            <option value="facebook">Facebook Ads</option>
                            <option value="google">Google Ads</option>
                            <option value="organic">Organic</option>
                            <option value="referral">Referral</option>
                            <option value="direct">Direct</option>
                        </select>
                        <div class="table-search-wrapper">
                            <i class="fas fa-search table-search-icon"></i>
                            <input type="text" id="leads-search" class="table-search-input" placeholder="Search leads...">
                        </div>
                        <button class="btn-primary" onclick="openAddLeadModal()"><i class="fas fa-plus"></i> Add Lead</button>
                    </div>
                </div>

                <!-- Leads Table -->
                <table id="leads-table" class="data-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Lead Count</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="leads-tbody">
                        <tr>
                            <td>Jan 24, 2026</td>
                            <td><strong>12</strong></td>
                            <td>
                                <div class="action-menu">
                                    <button class="action-menu-btn" onclick="toggleActionMenu(this)">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <div class="action-menu-dropdown">
                                        <button class="action-menu-item" onclick="editLeadEntry(this)"><i class="fas fa-edit"></i> Edit</button>
                                        <button class="action-menu-item delete" onclick="confirmDeleteLead(this)"><i class="fas fa-trash"></i> Delete</button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Jan 23, 2026</td>
                            <td><strong>18</strong></td>
                            <td>
                                <div class="action-menu">
                                    <button class="action-menu-btn" onclick="toggleActionMenu(this)">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <div class="action-menu-dropdown">
                                        <button class="action-menu-item" onclick="editLeadEntry(this)"><i class="fas fa-edit"></i> Edit</button>
                                        <button class="action-menu-item delete" onclick="confirmDeleteLead(this)"><i class="fas fa-trash"></i> Delete</button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Jan 22, 2026</td>
                            <td><strong>15</strong></td>
                            <td>
                                <div class="action-menu">
                                    <button class="action-menu-btn" onclick="toggleActionMenu(this)">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <div class="action-menu-dropdown">
                                        <button class="action-menu-item" onclick="editLeadEntry(this)"><i class="fas fa-edit"></i> Edit</button>
                                        <button class="action-menu-item delete" onclick="confirmDeleteLead(this)"><i class="fas fa-trash"></i> Delete</button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Jan 21, 2026</td>
                            <td><strong>22</strong></td>
                            <td>
                                <div class="action-menu">
                                    <button class="action-menu-btn" onclick="toggleActionMenu(this)">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <div class="action-menu-dropdown">
                                        <button class="action-menu-item" onclick="editLeadEntry(this)"><i class="fas fa-edit"></i> Edit</button>
                                        <button class="action-menu-item delete" onclick="confirmDeleteLead(this)"><i class="fas fa-trash"></i> Delete</button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Jan 20, 2026</td>
                            <td><strong>9</strong></td>
                            <td>
                                <div class="action-menu">
                                    <button class="action-menu-btn" onclick="toggleActionMenu(this)">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <div class="action-menu-dropdown">
                                        <button class="action-menu-item" onclick="editLeadEntry(this)"><i class="fas fa-edit"></i> Edit</button>
                                        <button class="action-menu-item delete" onclick="confirmDeleteLead(this)"><i class="fas fa-trash"></i> Delete</button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Jan 19, 2026</td>
                            <td><strong>14</strong></td>
                            <td>
                                <div class="action-menu">
                                    <button class="action-menu-btn" onclick="toggleActionMenu(this)">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <div class="action-menu-dropdown">
                                        <button class="action-menu-item" onclick="editLeadEntry(this)"><i class="fas fa-edit"></i> Edit</button>
                                        <button class="action-menu-item delete" onclick="confirmDeleteLead(this)"><i class="fas fa-trash"></i> Delete</button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <!-- Pagination -->
                <div class="table-pagination">
                    <div class="pagination-left">
                        <span>Rows per page:</span>
                        <select class="pagination-select">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                            <option value="100" selected>100</option>
                        </select>
                    </div>
                    <div class="pagination-center">
                        <span>1-6 of 156</span>
                    </div>
                    <div class="pagination-right">
                        <span>Page:</span>
                        <input type="number" class="pagination-input" value="1" min="1" max="8">
                        <span>of 8</span>
                        <button class="pagination-arrow" disabled><i class="fas fa-chevron-left"></i></button>
                        <button class="pagination-arrow"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- Add Lead Modal -->
            <div id="add-lead-modal" class="modal" style="display: none;">
                <div class="modal-overlay" onclick="closeAddLeadModal()"></div>
                <div class="modal-content" style="max-width: 450px;">
                    <div class="modal-header">
                        <h3 style="margin: 0; font-size: 18px;"><i class="fas fa-user-plus" style="color: var(--primary-color); margin-right: 8px;"></i>Add Lead Entry</h3>
                        <button class="modal-close" onclick="closeAddLeadModal()"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="modal-body" style="padding: 20px;">
                        <form id="add-lead-form">
                            <div style="display: grid; gap: 16px;">
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Date <span style="color: #dc2626;">*</span></label>
                                    <input type="date" id="lead-date" required style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Lead Count <span style="color: #dc2626;">*</span></label>
                                    <input type="number" id="lead-count" required min="1" placeholder="Enter number of leads" style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Lead Source <span style="color: #dc2626;">*</span></label>
                                    <select id="lead-source" required style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                        <option value="">Select a source...</option>
                                        <option value="Facebook Ads">Facebook Ads</option>
                                        <option value="Google Ads">Google Ads</option>
                                        <option value="Organic">Organic</option>
                                        <option value="Referral">Referral</option>
                                        <option value="Direct">Direct</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer" style="padding: 16px 20px; border-top: 1px solid var(--border-color); display: flex; gap: 12px; justify-content: flex-end;">
                        <button type="button" onclick="closeAddLeadModal()" style="padding: 10px 20px; border: 1px solid var(--border-color); background: white; border-radius: 6px; cursor: pointer; font-size: 14px;">Cancel</button>
                        <button type="button" onclick="addLeadEntry()" class="btn-primary" style="padding: 10px 20px;">Add Entry</button>
                    </div>
                </div>
            </div>

            <!-- Edit Lead Modal -->
            <div id="edit-lead-modal" class="modal" style="display: none;">
                <div class="modal-overlay" onclick="closeEditLeadModal()"></div>
                <div class="modal-content" style="max-width: 450px;">
                    <div class="modal-header">
                        <h3 style="margin: 0; font-size: 18px;"><i class="fas fa-edit" style="color: var(--primary-color); margin-right: 8px;"></i>Edit Lead Entry</h3>
                        <button class="modal-close" onclick="closeEditLeadModal()"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="modal-body" style="padding: 20px;">
                        <form id="edit-lead-form">
                            <div style="display: grid; gap: 16px;">
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Date <span style="color: #dc2626;">*</span></label>
                                    <input type="date" id="edit-lead-date" required style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Lead Count <span style="color: #dc2626;">*</span></label>
                                    <input type="number" id="edit-lead-count" required min="1" style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                </div>
                                <div>
                                    <label style="display: block; font-size: 13px; font-weight: 500; margin-bottom: 6px; color: var(--text-color);">Lead Source <span style="color: #dc2626;">*</span></label>
                                    <select id="edit-lead-source" required style="width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; font-size: 13px;">
                                        <option value="">Select a source...</option>
                                        <option value="Facebook Ads">Facebook Ads</option>
                                        <option value="Google Ads">Google Ads</option>
                                        <option value="Organic">Organic</option>
                                        <option value="Referral">Referral</option>
                                        <option value="Direct">Direct</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer" style="padding: 16px 20px; border-top: 1px solid var(--border-color); display: flex; gap: 12px; justify-content: flex-end;">
                        <button type="button" onclick="closeEditLeadModal()" style="padding: 10px 20px; border: 1px solid var(--border-color); background: white; border-radius: 6px; cursor: pointer; font-size: 14px;">Cancel</button>
                        <button type="button" onclick="saveLeadEntry()" class="btn-primary" style="padding: 10px 20px;">Save Changes</button>
                    </div>
                </div>
            </div>

            <!-- Delete Lead Confirmation Modal -->
            <div id="delete-lead-modal" class="modal" style="display: none;">
                <div class="modal-overlay" onclick="closeDeleteLeadModal()"></div>
                <div class="modal-content" style="max-width: 400px;">
                    <div class="modal-header">
                        <h3 style="margin: 0; font-size: 18px;"><i class="fas fa-exclamation-triangle" style="color: #dc2626; margin-right: 8px;"></i>Delete Entry</h3>
                        <button class="modal-close" onclick="closeDeleteLeadModal()"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="modal-body" style="padding: 20px;">
                        <p style="margin: 0; color: var(--text-secondary);">Are you sure you want to delete this lead entry? This action cannot be undone.</p>
                    </div>
                    <div class="modal-footer" style="padding: 16px 20px; border-top: 1px solid var(--border-color); display: flex; gap: 12px; justify-content: flex-end;">
                        <button type="button" onclick="closeDeleteLeadModal()" style="padding: 10px 20px; border: 1px solid var(--border-color); background: white; border-radius: 6px; cursor: pointer; font-size: 14px;">Cancel</button>
                        <button type="button" onclick="deleteLeadEntry()" style="padding: 10px 20px; background: #dc2626; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;">Delete</button>
                    </div>
                </div>
            </div>

            <!-- Add/Edit Webhook Modal -->
            <!-- (Webhook modals removed - using inline form instead) -->
        </div>
    </main>

    <script>
        // ==================== MULTI-ACCOUNT DATA STORE ====================
        // Each ad account has its own complete dataset
        const accountData = {
            connect: {
                name: 'Pabbly Connect',
                icon: 'fa-plug',
                color: 'linear-gradient(135deg, #1877f2, #42b72a)',
                accountId: 'act_123456789',
                metrics: {
                    totalSpend: '$12,345.67',
                    totalRevenue: '$16,100',
                    roas: '1.31',
                    totalLeads: '234',
                    costPerLead: '$52.76',
                    pixelStatus: 'Active',
                    totalSales: 27
                },
                timeBasedMetrics: {
                    daily: {
                        spend: 336.00,
                        revenue: 1999.00,
                        roas: 5.94,
                        leads: 39,
                        cpl: 8.61
                    },
                    weekly: {
                        spend: 2100.00,
                        revenue: 8400.00,
                        roas: 4.00,
                        leads: 156,
                        cpl: 13.46
                    },
                    monthly: {
                        spend: 12345.67,
                        revenue: 16100.00,
                        roas: 1.31,
                        leads: 234,
                        cpl: 52.76
                    }
                },
                timeRangeMetrics: {
                    today: { spend: 336.00, revenue: 1999.00, leads: 39, sales: 3 },
                    last7days: { spend: 2100.00, revenue: 8400.00, leads: 156, sales: 12 },
                    last30days: { spend: 12345.67, revenue: 16100.00, leads: 234, sales: 27 },
                    last90days: { spend: 35678.90, revenue: 42350.00, leads: 678, sales: 78 },
                    thismonth: { spend: 8956.45, revenue: 12500.00, leads: 189, sales: 21 },
                    lastmonth: { spend: 11234.56, revenue: 14800.00, leads: 245, sales: 25 }
                },
                campaigns: [
                    { name: 'USA - Lifetime Deal', status: 'Active', budget: '$1,200.00', spend: '$4,523.45', sales: 8, revenue: '$5,600', roas: '1.24', frequency: '1.8', outboundClicks: '3,245', reach: '125,400', impressions: '225,720' },
                    { name: 'EU - Subscription Q1', status: 'Active', budget: '$850.00', spend: '$3,212.89', sales: 5, revenue: '$3,500', roas: '1.09', frequency: '2.1', outboundClicks: '2,456', reach: '78,900', impressions: '165,690' },
                    { name: 'India - Growth', status: 'Active', budget: '$600.00', spend: '$2,156.78', sales: 6, revenue: '$4,200', roas: '1.95', frequency: '1.5', outboundClicks: '2,890', reach: '98,500', impressions: '147,750' },
                    { name: 'APAC - Awareness', status: 'Paused', budget: '$500.00', spend: '$1,890.00', sales: 3, revenue: '$2,100', roas: '1.11', frequency: '2.4', outboundClicks: '1,234', reach: '45,600', impressions: '109,440' },
                    { name: 'Global - Retargeting', status: 'Active', budget: '$200.00', spend: '$562.55', sales: 1, revenue: '$700', roas: '1.24', frequency: '1.2', outboundClicks: '567', reach: '23,400', impressions: '28,080' },
                    { name: 'LATAM - Cold Outreach', status: 'Active', budget: '$750.00', spend: '$2,890.00', sales: 2, revenue: '$1,400', roas: '0.48', frequency: '2.7', outboundClicks: '1,456', reach: '52,300', impressions: '141,210' },
                    { name: 'UK - Brand Awareness', status: 'Active', budget: '$500.00', spend: '$1,650.00', sales: 1, revenue: '$700', roas: '0.42', frequency: '2.3', outboundClicks: '890', reach: '34,700', impressions: '79,810' }
                ],
                adSets: [
                    { name: 'Interests - Tech Entrepreneurs', campaignName: 'USA - Lifetime Deal', status: 'Active', budget: '$600.00', spend: '$2,100.00', sales: 5, revenue: '$3,500', roas: '1.67', frequency: '1.6', outboundClicks: '1,890', reach: '72,500', impressions: '116,000' },
                    { name: 'Lookalike - Purchasers 1%', campaignName: 'USA - Lifetime Deal', status: 'Active', budget: '$400.00', spend: '$1,450.00', sales: 3, revenue: '$2,100', roas: '1.45', frequency: '1.8', outboundClicks: '1,355', reach: '52,900', impressions: '95,220' },
                    { name: 'Interests - Business Owners', campaignName: 'India - Growth', status: 'Active', budget: '$250.00', spend: '$890.00', sales: 2, revenue: '$1,400', roas: '1.57', frequency: '1.4', outboundClicks: '978', reach: '38,200', impressions: '53,480' },
                    { name: 'Cold Audience - LATAM', campaignName: 'LATAM - Cold Outreach', status: 'Active', budget: '$400.00', spend: '$1,560.00', sales: 1, revenue: '$700', roas: '0.45', frequency: '2.9', outboundClicks: '812', reach: '28,900', impressions: '83,810' },
                    { name: 'UK Interests - SMBs', campaignName: 'UK - Brand Awareness', status: 'Active', budget: '$250.00', spend: '$890.00', sales: 0, revenue: '$0', roas: '0.00', frequency: '2.5', outboundClicks: '534', reach: '19,800', impressions: '49,500' },
                    { name: 'Broad - General Audience', campaignName: 'EU - Subscription Q1', status: 'Paused', budget: '$350.00', spend: '$1,200.00', sales: 1, revenue: '$700', roas: '0.58', frequency: '2.8', outboundClicks: '756', reach: '28,500', impressions: '79,800' },
                    { name: 'Retargeting - Website Visitors', campaignName: 'APAC - Awareness', status: 'Paused', budget: '$200.00', spend: '$650.00', sales: 0, revenue: '$0', roas: '0.00', frequency: '3.2', outboundClicks: '423', reach: '15,200', impressions: '48,640' }
                ],
                ads: [
                    { name: 'Video Ad v3 - Feature Demo', campaignName: 'USA - Lifetime Deal', adSetName: 'Interests - Tech Entrepreneurs', status: 'Active', budget: '$350.00', spend: '$1,200.00', sales: 4, revenue: '$2,800.00', roas: '2.33', frequency: '1.5', outboundClicks: '1,124', reach: '42,300', impressions: '63,450' },
                    { name: 'Image Ad - Testimonial', campaignName: 'USA - Lifetime Deal', adSetName: 'Lookalike - Purchasers 1%', status: 'Active', budget: '$250.00', spend: '$850.00', sales: 2, revenue: '$1,400.00', roas: '1.65', frequency: '1.7', outboundClicks: '823', reach: '31,200', impressions: '53,040' },
                    { name: 'Carousel Ad - Features', campaignName: 'India - Growth', adSetName: 'Interests - Business Owners', status: 'Active', budget: '$200.00', spend: '$650.00', sales: 1, revenue: '$700.00', roas: '1.08', frequency: '1.3', outboundClicks: '612', reach: '24,500', impressions: '31,850' },
                    { name: 'UGC Video - Customer Story', campaignName: 'USA - Lifetime Deal', adSetName: 'Interests - Tech Entrepreneurs', status: 'Active', budget: '$300.00', spend: '$1,050.00', sales: 3, revenue: '$2,100.00', roas: '2.00', frequency: '1.4', outboundClicks: '978', reach: '38,600', impressions: '54,040' },
                    { name: 'Reel Ad - Quick Tutorial', campaignName: 'India - Growth', adSetName: 'Interests - Business Owners', status: 'Active', budget: '$180.00', spend: '$520.00', sales: 2, revenue: '$1,400.00', roas: '2.69', frequency: '1.1', outboundClicks: '734', reach: '28,900', impressions: '31,790' },
                    { name: 'Image Ad - Pricing Page', campaignName: 'EU - Subscription Q1', adSetName: 'Broad - General Audience', status: 'Active', budget: '$220.00', spend: '$780.00', sales: 2, revenue: '$1,400.00', roas: '1.79', frequency: '1.6', outboundClicks: '654', reach: '25,100', impressions: '40,160' },
                    { name: 'Story Ad - Limited Offer', campaignName: 'Global - Retargeting', adSetName: 'Retargeting - Website Visitors', status: 'Active', budget: '$150.00', spend: '$420.00', sales: 1, revenue: '$700.00', roas: '1.67', frequency: '1.2', outboundClicks: '389', reach: '15,600', impressions: '18,720' },
                    { name: 'Video Ad v2 - Walkthrough', campaignName: 'USA - Lifetime Deal', adSetName: 'Lookalike - Purchasers 1%', status: 'Active', budget: '$280.00', spend: '$960.00', sales: 3, revenue: '$2,100.00', roas: '2.19', frequency: '1.8', outboundClicks: '1,045', reach: '35,400', impressions: '63,720' },
                    { name: 'Carousel Ad - Use Cases', campaignName: 'EU - Subscription Q1', adSetName: 'Broad - General Audience', status: 'Active', budget: '$190.00', spend: '$590.00', sales: 1, revenue: '$700.00', roas: '1.19', frequency: '1.9', outboundClicks: '478', reach: '18,200', impressions: '34,580' },
                    { name: 'Image Ad - Before/After', campaignName: 'India - Growth', adSetName: 'Interests - Business Owners', status: 'Active', budget: '$160.00', spend: '$480.00', sales: 2, revenue: '$1,400.00', roas: '2.92', frequency: '1.2', outboundClicks: '567', reach: '22,800', impressions: '27,360' },
                    { name: 'LATAM Video - Product Intro', campaignName: 'LATAM - Cold Outreach', adSetName: 'Cold Audience - LATAM', status: 'Active', budget: '$220.00', spend: '$870.00', sales: 0, revenue: '$0.00', roas: '0.00', frequency: '3.0', outboundClicks: '423', reach: '15,200', impressions: '45,600' },
                    { name: 'LATAM Carousel - Pricing', campaignName: 'LATAM - Cold Outreach', adSetName: 'Cold Audience - LATAM', status: 'Active', budget: '$180.00', spend: '$690.00', sales: 1, revenue: '$700.00', roas: '0.72', frequency: '2.8', outboundClicks: '389', reach: '13,700', impressions: '38,360' },
                    { name: 'UK Image - Free Trial', campaignName: 'UK - Brand Awareness', adSetName: 'UK Interests - SMBs', status: 'Active', budget: '$130.00', spend: '$520.00', sales: 0, revenue: '$0.00', roas: '0.00', frequency: '2.5', outboundClicks: '312', reach: '11,400', impressions: '28,500' },
                    { name: 'Static Image - Old Creative', campaignName: 'EU - Subscription Q1', adSetName: 'Broad - General Audience', status: 'Paused', budget: '$150.00', spend: '$450.00', sales: 0, revenue: '$0.00', roas: '0.00', frequency: '2.9', outboundClicks: '345', reach: '12,300', impressions: '35,670' },
                    { name: 'Video Ad v1 - Outdated', campaignName: 'APAC - Awareness', adSetName: 'Retargeting - Website Visitors', status: 'Paused', budget: '$120.00', spend: '$380.00', sales: 0, revenue: '$0.00', roas: '0.00', frequency: '3.5', outboundClicks: '234', reach: '8,900', impressions: '31,150' },
                    { name: 'GIF Ad - Old Promo', campaignName: 'APAC - Awareness', adSetName: 'Retargeting - Website Visitors', status: 'Paused', budget: '$100.00', spend: '$310.00', sales: 0, revenue: '$0.00', roas: '0.00', frequency: '3.1', outboundClicks: '198', reach: '7,200', impressions: '22,320' }
                ],
                countries: [
                    { name: 'United States', flag: 'us', sales: 10, revenue: '$7,000', spend: '$5,234.56', roas: '1.34' },
                    { name: 'United Kingdom', flag: 'gb', sales: 4, revenue: '$2,800', spend: '$2,156.78', roas: '1.30' },
                    { name: 'India', flag: 'in', sales: 6, revenue: '$4,200', spend: '$2,100.00', roas: '2.00' },
                    { name: 'Germany', flag: 'de', sales: 2, revenue: '$1,400', spend: '$1,456.89', roas: '0.96' },
                    { name: 'Canada', flag: 'ca', sales: 1, revenue: '$700', spend: '$897.44', roas: '0.78' }
                ],
                alerts: [
                    { type: 'warning', level: 'Campaign', name: 'EU - Subscription Q1', spend: '$3,212.89', roas: '1.09', threshold: '$2,800' },
                    { type: 'critical', level: 'Ad Set', name: 'Germany - Interests', spend: '$1,456.89', roas: '0.96', threshold: '$1,400' },
                    { type: 'warning', level: 'Country', name: 'Canada', spend: '$897.44', roas: '0.78', threshold: '$700' }
                ],
                recentSales: [
                    { time: '10 min ago', campaign: 'USA - Lifetime Deal', adSet: 'Interests - Tech Entrepreneurs', adName: 'Video Ad v3 - Feature Demo', country: 'United States', amount: '$700' },
                    { time: '2 hours ago', campaign: 'USA - Lifetime Deal', adSet: 'Lookalike - Purchasers 1%', adName: 'Image Ad - Testimonial', country: 'United States', amount: '$700' },
                    { time: '5 hours ago', campaign: 'India - Growth', adSet: 'Interests - Business Owners', adName: 'Carousel Ad - Features', country: 'India', amount: '$700' },
                    { time: '8 hours ago', campaign: 'EU - Subscription Q1', adSet: 'Broad - General Audience', adName: 'Image Ad - Pricing Page', country: 'Germany', amount: '$700' },
                    { time: '12 hours ago', campaign: 'USA - Lifetime Deal', adSet: 'Interests - Tech Entrepreneurs', adName: 'UGC Video - Customer Story', country: 'United States', amount: '$700' },
                    { time: '1 day ago', campaign: 'India - Growth', adSet: 'Interests - Business Owners', adName: 'Reel Ad - Quick Tutorial', country: 'India', amount: '$700' },
                    { time: '1 day ago', campaign: 'Global - Retargeting', adSet: 'Retargeting - Website Visitors', adName: 'Story Ad - Limited Offer', country: 'Canada', amount: '$700' },
                    { time: '2 days ago', campaign: 'USA - Lifetime Deal', adSet: 'Lookalike - Purchasers 1%', adName: 'Video Ad v2 - Walkthrough', country: 'United States', amount: '$700' },
                    { time: '2 days ago', campaign: 'EU - Subscription Q1', adSet: 'Broad - General Audience', adName: 'Carousel Ad - Use Cases', country: 'United Kingdom', amount: '$700' },
                    { time: '3 days ago', campaign: 'India - Growth', adSet: 'Interests - Business Owners', adName: 'Image Ad - Before/After', country: 'India', amount: '$700' },
                    { time: '3 days ago', campaign: 'USA - Lifetime Deal', adSet: 'Interests - Tech Entrepreneurs', adName: 'Video Ad v3 - Feature Demo', country: 'United States', amount: '$700' },
                    { time: '4 days ago', campaign: 'LATAM - Cold Outreach', adSet: 'Cold Audience - LATAM', adName: 'LATAM Carousel - Pricing', country: 'Brazil', amount: '$700' },
                    { time: '5 days ago', campaign: 'USA - Lifetime Deal', adSet: 'Lookalike - Purchasers 1%', adName: 'Image Ad - Testimonial', country: 'United States', amount: '$700' },
                    { time: '5 days ago', campaign: 'India - Growth', adSet: 'Interests - Business Owners', adName: 'Carousel Ad - Features', country: 'India', amount: '$700' },
                    { time: '6 days ago', campaign: 'EU - Subscription Q1', adSet: 'Broad - General Audience', adName: 'Image Ad - Pricing Page', country: 'Germany', amount: '$700' }
                ],
                webhookUrl: 'https://chat.googleapis.com/v1/spaces/ABC123/messages?key=xyz_connect',
                todayRevenue: '$2,100',
                weekRevenue: '$8,400',
                monthRevenue: '$16,100',
                revenueTransactions: [
                    { date: 'Jan 24, 2026 - 10:15 AM', txnId: 'TXN_PC_2026012401', customer: 'john.doe@email.com', product: 'Pabbly Connect', country: 'United States', flag: 'us', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 24, 2026 - 8:30 AM', txnId: 'TXN_PC_2026012402', customer: 'sarah.smith@company.com', product: 'Pabbly Connect', country: 'United States', flag: 'us', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 24, 2026 - 6:45 AM', txnId: 'TXN_PC_2026012403', customer: 'mike.jones@business.co.uk', product: 'Pabbly Connect', country: 'United Kingdom', flag: 'gb', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 23, 2026 - 11:20 PM', txnId: 'TXN_PC_2026012304', customer: 'emma.wilson@startup.ca', product: 'Pabbly Connect', country: 'Canada', flag: 'ca', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 23, 2026 - 9:15 PM', txnId: 'TXN_PC_2026012305', customer: 'hans.mueller@firma.de', product: 'Pabbly Connect', country: 'Germany', flag: 'de', amount: '$700', source: 'Webhook' }
                ],
                leads: [
                    { date: 'Jan 24, 2026', source: 'Facebook Ads', count: 45 },
                    { date: 'Jan 23, 2026', source: 'Facebook Ads', count: 38 },
                    { date: 'Jan 22, 2026', source: 'Google Ads', count: 52 },
                    { date: 'Jan 21, 2026', source: 'Organic', count: 28 },
                    { date: 'Jan 20, 2026', source: 'Facebook Ads', count: 41 },
                    { date: 'Jan 19, 2026', source: 'Referral', count: 22 }
                ],
                todayLeads: 45,
                weekLeads: 156,
                monthLeads: 234
            },
            chatflow: {
                name: 'Pabbly Chatflow',
                icon: 'fa-comments',
                color: 'linear-gradient(135deg, #6366f1, #8b5cf6)',
                accountId: 'act_987654321',
                metrics: {
                    totalSpend: '$8,756.23',
                    totalRevenue: '$11,900',
                    roas: '1.36',
                    totalLeads: '189',
                    costPerLead: '$46.33',
                    pixelStatus: 'Active',
                    totalSales: 18
                },
                timeBasedMetrics: {
                    daily: {
                        spend: 280.00,
                        revenue: 1400.00,
                        roas: 5.00,
                        leads: 32,
                        cpl: 8.75
                    },
                    weekly: {
                        spend: 1750.00,
                        revenue: 5600.00,
                        roas: 3.20,
                        leads: 128,
                        cpl: 13.67
                    },
                    monthly: {
                        spend: 8756.23,
                        revenue: 11900.00,
                        roas: 1.36,
                        leads: 189,
                        cpl: 46.33
                    }
                },
                timeRangeMetrics: {
                    today: { spend: 280.00, revenue: 1400.00, leads: 32, sales: 2 },
                    last7days: { spend: 1750.00, revenue: 5600.00, leads: 128, sales: 8 },
                    last30days: { spend: 8756.23, revenue: 11900.00, leads: 189, sales: 18 },
                    last90days: { spend: 24567.89, revenue: 31200.00, leads: 543, sales: 52 },
                    thismonth: { spend: 6234.78, revenue: 8900.00, leads: 145, sales: 14 },
                    lastmonth: { spend: 7890.45, revenue: 10300.00, leads: 178, sales: 16 }
                },
                campaigns: [
                    { name: 'WhatsApp Marketing - USA', status: 'Active', budget: '$900.00', spend: '$3,245.67', sales: 7, revenue: '$4,900', roas: '1.51', frequency: '1.6', outboundClicks: '2,876', reach: '95,400', impressions: '152,640' },
                    { name: 'Chat Automation - Global', status: 'Active', budget: '$750.00', spend: '$2,890.12', sales: 5, revenue: '$3,500', roas: '1.21', frequency: '1.9', outboundClicks: '2,234', reach: '72,300', impressions: '137,370' },
                    { name: 'Bot Builder - EU', status: 'Active', budget: '$700.00', spend: '$2,620.44', sales: 5, revenue: '$3,500', roas: '1.34', frequency: '1.7', outboundClicks: '2,045', reach: '68,500', impressions: '116,450' },
                    { name: 'LATAM - Chatbot Trial', status: 'Paused', budget: '$300.00', spend: '$890.00', sales: 1, revenue: '$700', roas: '0.79', frequency: '2.6', outboundClicks: '567', reach: '21,200', impressions: '55,120' }
                ],
                adSets: [
                    { name: 'SMB Owners', campaignName: 'WhatsApp Marketing - USA', status: 'Active', budget: '$500.00', spend: '$1,800.00', sales: 4, revenue: '$2,800', roas: '1.56', frequency: '1.5', outboundClicks: '1,654', reach: '56,800', impressions: '85,200' },
                    { name: 'E-commerce', campaignName: 'Chat Automation - Global', status: 'Active', budget: '$400.00', spend: '$1,500.00', sales: 3, revenue: '$2,100', roas: '1.40', frequency: '1.8', outboundClicks: '1,345', reach: '42,500', impressions: '76,500' },
                    { name: 'Tech Startups', campaignName: 'Bot Builder - EU', status: 'Active', budget: '$350.00', spend: '$1,200.00', sales: 2, revenue: '$1,400', roas: '1.17', frequency: '1.6', outboundClicks: '1,123', reach: '38,900', impressions: '62,240' },
                    { name: 'Spanish Speakers', campaignName: 'LATAM - Chatbot Trial', status: 'Paused', budget: '$150.00', spend: '$450.00', sales: 0, revenue: '$0', roas: '0.00', frequency: '2.8', outboundClicks: '312', reach: '11,500', impressions: '32,200' }
                ],
                ads: [
                    { name: 'Demo Video - WhatsApp API', campaignName: 'WhatsApp Marketing - USA', adSetName: 'SMB Owners', status: 'Active', budget: '$280.00', spend: '$950.00', sales: 3, revenue: '$2,100.00', roas: '2.21', frequency: '1.4', outboundClicks: '923', reach: '32,400', impressions: '45,360' },
                    { name: 'Chatbot Preview - Ecommerce', campaignName: 'Chat Automation - Global', adSetName: 'E-commerce', status: 'Active', budget: '$220.00', spend: '$780.00', sales: 2, revenue: '$1,400.00', roas: '1.79', frequency: '1.7', outboundClicks: '756', reach: '24,500', impressions: '41,650' },
                    { name: 'Feature Highlight Reel', campaignName: 'Bot Builder - EU', adSetName: 'Tech Startups', status: 'Active', budget: '$180.00', spend: '$620.00', sales: 1, revenue: '$700.00', roas: '1.13', frequency: '1.5', outboundClicks: '589', reach: '21,300', impressions: '31,950' },
                    { name: 'UGC - Customer Success Story', campaignName: 'WhatsApp Marketing - USA', adSetName: 'SMB Owners', status: 'Active', budget: '$250.00', spend: '$870.00', sales: 2, revenue: '$1,400.00', roas: '1.61', frequency: '1.3', outboundClicks: '812', reach: '29,800', impressions: '38,740' },
                    { name: 'Carousel - Bot Templates', campaignName: 'Bot Builder - EU', adSetName: 'Tech Startups', status: 'Active', budget: '$200.00', spend: '$690.00', sales: 2, revenue: '$1,400.00', roas: '2.03', frequency: '1.6', outboundClicks: '634', reach: '23,400', impressions: '37,440' },
                    { name: 'Image Ad - ROI Calculator', campaignName: 'Chat Automation - Global', adSetName: 'E-commerce', status: 'Active', budget: '$190.00', spend: '$640.00', sales: 1, revenue: '$700.00', roas: '1.09', frequency: '1.8', outboundClicks: '523', reach: '19,600', impressions: '35,280' },
                    { name: 'Video - Live Demo Recording', campaignName: 'WhatsApp Marketing - USA', adSetName: 'SMB Owners', status: 'Active', budget: '$240.00', spend: '$810.00', sales: 2, revenue: '$1,400.00', roas: '1.73', frequency: '1.5', outboundClicks: '745', reach: '27,100', impressions: '40,650' },
                    { name: 'Story Ad - Quick Setup', campaignName: 'Chat Automation - Global', adSetName: 'E-commerce', status: 'Active', budget: '$150.00', spend: '$480.00', sales: 1, revenue: '$700.00', roas: '1.46', frequency: '1.2', outboundClicks: '412', reach: '17,800', impressions: '21,360' },
                    { name: 'Spanish Ad - Chatbot Intro', campaignName: 'LATAM - Chatbot Trial', adSetName: 'Spanish Speakers', status: 'Paused', budget: '$100.00', spend: '$320.00', sales: 0, revenue: '$0.00', roas: '0.00', frequency: '3.1', outboundClicks: '187', reach: '6,800', impressions: '21,080' },
                    { name: 'Image Ad - Old Branding', campaignName: 'LATAM - Chatbot Trial', adSetName: 'Spanish Speakers', status: 'Paused', budget: '$80.00', spend: '$245.00', sales: 0, revenue: '$0.00', roas: '0.00', frequency: '2.8', outboundClicks: '156', reach: '5,400', impressions: '15,120' }
                ],
                countries: [
                    { name: 'United States', flag: 'us', sales: 7, revenue: '$4,900', spend: '$3,456.78', roas: '1.42' },
                    { name: 'Brazil', flag: 'br', sales: 4, revenue: '$2,800', spend: '$1,890.45', roas: '1.48' },
                    { name: 'United Kingdom', flag: 'gb', sales: 3, revenue: '$2,100', spend: '$1,678.90', roas: '1.25' },
                    { name: 'Mexico', flag: 'mx', sales: 2, revenue: '$1,400', spend: '$980.10', roas: '1.43' },
                    { name: 'Spain', flag: 'es', sales: 1, revenue: '$700', spend: '$750.00', roas: '0.93' }
                ],
                alerts: [
                    { type: 'warning', level: 'Country', name: 'Spain', spend: '$750.00', roas: '0.93', threshold: '$700' },
                    { type: 'info', level: 'Campaign', name: 'WhatsApp Marketing - USA', spend: '$3,245.67', roas: '1.51', threshold: 'Budget increase recommended' }
                ],
                recentSales: [
                    { time: '25 min ago', campaign: 'WhatsApp Marketing - USA', adSet: 'SMB Owners', adName: 'Demo Video', country: 'United States', amount: '$700' },
                    { time: '3 hours ago', campaign: 'Chat Automation - Global', adSet: 'E-commerce', adName: 'Chatbot Preview', country: 'Brazil', amount: '$700' },
                    { time: '6 hours ago', campaign: 'Bot Builder - EU', adSet: 'Tech Startups', adName: 'Feature Highlight', country: 'United Kingdom', amount: '$700' },
                    { time: '10 hours ago', campaign: 'WhatsApp Marketing - USA', adSet: 'SMB Owners', adName: 'Chatflow Walkthrough', country: 'United States', amount: '$700' },
                    { time: '1 day ago', campaign: 'Chat Automation - Global', adSet: 'E-commerce', adName: 'Auto-Reply Demo', country: 'India', amount: '$700' },
                    { time: '1 day ago', campaign: 'Bot Builder - EU', adSet: 'Tech Startups', adName: 'Drag & Drop Builder', country: 'Germany', amount: '$700' },
                    { time: '2 days ago', campaign: 'WhatsApp Marketing - USA', adSet: 'SMB Owners', adName: 'ROI Calculator Video', country: 'United States', amount: '$700' },
                    { time: '3 days ago', campaign: 'Chat Automation - Global', adSet: 'E-commerce', adName: 'Chatbot Preview', country: 'Australia', amount: '$700' },
                    { time: '4 days ago', campaign: 'WhatsApp Marketing - USA', adSet: 'SMB Owners', adName: 'Demo Video', country: 'Canada', amount: '$700' },
                    { time: '5 days ago', campaign: 'Bot Builder - EU', adSet: 'Tech Startups', adName: 'Feature Highlight', country: 'United Kingdom', amount: '$700' }
                ],
                webhookUrl: 'https://chat.googleapis.com/v1/spaces/DEF456/messages?key=xyz_chatflow',
                todayRevenue: '$1,400',
                weekRevenue: '$5,600',
                monthRevenue: '$11,900',
                revenueTransactions: [
                    { date: 'Jan 24, 2026 - 9:45 AM', txnId: 'TXN_CF_2026012401', customer: 'carlos.garcia@empresa.mx', product: 'Pabbly Chatflow', country: 'Mexico', flag: 'mx', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 24, 2026 - 7:30 AM', txnId: 'TXN_CF_2026012402', customer: 'maria.silva@negocio.br', product: 'Pabbly Chatflow', country: 'Brazil', flag: 'br', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 23, 2026 - 10:20 PM', txnId: 'TXN_CF_2026012303', customer: 'james.wilson@agency.com', product: 'Pabbly Chatflow', country: 'United States', flag: 'us', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 23, 2026 - 6:15 PM', txnId: 'TXN_CF_2026012304', customer: 'pablo.martinez@comercio.es', product: 'Pabbly Chatflow', country: 'Spain', flag: 'es', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 23, 2026 - 2:45 PM', txnId: 'TXN_CF_2026012305', customer: 'david.brown@tech.co.uk', product: 'Pabbly Chatflow', country: 'United Kingdom', flag: 'gb', amount: '$700', source: 'Webhook' }
                ],
                leads: [
                    { date: 'Jan 24, 2026', source: 'Facebook Ads', count: 32 },
                    { date: 'Jan 23, 2026', source: 'Facebook Ads', count: 28 },
                    { date: 'Jan 22, 2026', source: 'Google Ads', count: 35 },
                    { date: 'Jan 21, 2026', source: 'Organic', count: 22 },
                    { date: 'Jan 20, 2026', source: 'Facebook Ads', count: 40 }
                ],
                todayLeads: 32,
                weekLeads: 117,
                monthLeads: 189
            },
            email: {
                name: 'Pabbly Email Marketing',
                icon: 'fa-envelope',
                color: 'linear-gradient(135deg, #10b981, #059669)',
                accountId: 'act_456789123',
                metrics: {
                    totalSpend: '$5,432.10',
                    totalRevenue: '$7,700',
                    roas: '1.42',
                    totalLeads: '312',
                    costPerLead: '$17.41',
                    pixelStatus: 'Active',
                    totalSales: 12
                },
                timeBasedMetrics: {
                    daily: {
                        spend: 220.00,
                        revenue: 1400.00,
                        roas: 6.36,
                        leads: 58,
                        cpl: 3.79
                    },
                    weekly: {
                        spend: 1050.00,
                        revenue: 4200.00,
                        roas: 4.00,
                        leads: 189,
                        cpl: 5.56
                    },
                    monthly: {
                        spend: 5432.10,
                        revenue: 7700.00,
                        roas: 1.42,
                        leads: 312,
                        cpl: 17.41
                    }
                },
                timeRangeMetrics: {
                    today: { spend: 220.00, revenue: 1400.00, leads: 58, sales: 2 },
                    last7days: { spend: 1050.00, revenue: 4200.00, leads: 189, sales: 6 },
                    last30days: { spend: 5432.10, revenue: 7700.00, leads: 312, sales: 12 },
                    last90days: { spend: 15678.45, revenue: 21500.00, leads: 876, sales: 34 },
                    thismonth: { spend: 3890.67, revenue: 5600.00, leads: 223, sales: 9 },
                    lastmonth: { spend: 4567.89, revenue: 6400.00, leads: 267, sales: 10 }
                },
                campaigns: [
                    { name: 'Email Automation - SMB', status: 'Active', budget: '$800.00', spend: '$2,876.54', sales: 6, revenue: '$4,200', roas: '1.46', frequency: '1.4', outboundClicks: '2,456', reach: '89,200', impressions: '124,880' },
                    { name: 'Newsletter Tools - Creators', status: 'Active', budget: '$700.00', spend: '$2,555.56', sales: 5, revenue: '$3,500', roas: '1.37', frequency: '1.8', outboundClicks: '2,123', reach: '67,400', impressions: '121,320' },
                    { name: 'Cold Email - Enterprise', status: 'Paused', budget: '$400.00', spend: '$1,120.00', sales: 1, revenue: '$700', roas: '0.63', frequency: '2.9', outboundClicks: '678', reach: '23,400', impressions: '67,860' }
                ],
                adSets: [
                    { name: 'Marketers', campaignName: 'Email Automation - SMB', status: 'Active', budget: '$450.00', spend: '$1,500.00', sales: 4, revenue: '$2,800', roas: '1.87', frequency: '1.3', outboundClicks: '1,423', reach: '52,300', impressions: '67,990' },
                    { name: 'Content Creators', campaignName: 'Newsletter Tools - Creators', status: 'Active', budget: '$380.00', spend: '$1,300.00', sales: 3, revenue: '$2,100', roas: '1.62', frequency: '1.6', outboundClicks: '1,234', reach: '42,100', impressions: '67,360' },
                    { name: 'Enterprise IT', campaignName: 'Cold Email - Enterprise', status: 'Paused', budget: '$200.00', spend: '$600.00', sales: 0, revenue: '$0', roas: '0.00', frequency: '3.0', outboundClicks: '389', reach: '12,800', impressions: '38,400' }
                ],
                ads: [
                    { name: 'Email Builder Demo Video', campaignName: 'Email Automation - SMB', adSetName: 'Marketers', status: 'Active', budget: '$250.00', spend: '$800.00', sales: 3, revenue: '$2,100.00', roas: '2.63', frequency: '1.2', outboundClicks: '834', reach: '31,200', impressions: '37,440' },
                    { name: 'Template Gallery Carousel', campaignName: 'Newsletter Tools - Creators', adSetName: 'Content Creators', status: 'Active', budget: '$200.00', spend: '$700.00', sales: 2, revenue: '$1,400.00', roas: '2.00', frequency: '1.5', outboundClicks: '712', reach: '24,500', impressions: '36,750' },
                    { name: 'Drag & Drop Editor Ad', campaignName: 'Email Automation - SMB', adSetName: 'Marketers', status: 'Active', budget: '$210.00', spend: '$680.00', sales: 2, revenue: '$1,400.00', roas: '2.06', frequency: '1.3', outboundClicks: '623', reach: '24,100', impressions: '31,330' },
                    { name: 'Newsletter ROI Calculator', campaignName: 'Newsletter Tools - Creators', adSetName: 'Content Creators', status: 'Active', budget: '$180.00', spend: '$590.00', sales: 1, revenue: '$700.00', roas: '1.19', frequency: '1.6', outboundClicks: '534', reach: '19,800', impressions: '31,680' },
                    { name: 'Image Ad - Email Analytics', campaignName: 'Email Automation - SMB', adSetName: 'Marketers', status: 'Active', budget: '$170.00', spend: '$520.00', sales: 1, revenue: '$700.00', roas: '1.35', frequency: '1.4', outboundClicks: '478', reach: '17,600', impressions: '24,640' },
                    { name: 'Video - Deliverability Tips', campaignName: 'Newsletter Tools - Creators', adSetName: 'Content Creators', status: 'Active', budget: '$160.00', spend: '$490.00', sales: 1, revenue: '$700.00', roas: '1.43', frequency: '1.5', outboundClicks: '423', reach: '16,200', impressions: '24,300' },
                    { name: 'Reel - Email vs Social Media', campaignName: 'Email Automation - SMB', adSetName: 'Marketers', status: 'Active', budget: '$140.00', spend: '$410.00', sales: 1, revenue: '$700.00', roas: '1.71', frequency: '1.1', outboundClicks: '389', reach: '15,400', impressions: '16,940' },
                    { name: 'Story Ad - Free Trial CTA', campaignName: 'Newsletter Tools - Creators', adSetName: 'Content Creators', status: 'Active', budget: '$130.00', spend: '$370.00', sales: 1, revenue: '$700.00', roas: '1.89', frequency: '1.2', outboundClicks: '345', reach: '14,100', impressions: '16,920' },
                    { name: 'Enterprise Features Ad', campaignName: 'Cold Email - Enterprise', adSetName: 'Enterprise IT', status: 'Paused', budget: '$130.00', spend: '$420.00', sales: 0, revenue: '$0.00', roas: '0.00', frequency: '3.2', outboundClicks: '245', reach: '7,800', impressions: '24,960' },
                    { name: 'Cold Email Outreach Video', campaignName: 'Cold Email - Enterprise', adSetName: 'Enterprise IT', status: 'Paused', budget: '$110.00', spend: '$350.00', sales: 0, revenue: '$0.00', roas: '0.00', frequency: '2.9', outboundClicks: '198', reach: '6,500', impressions: '18,850' }
                ],
                countries: [
                    { name: 'United States', flag: 'us', sales: 5, revenue: '$3,500', spend: '$2,345.67', roas: '1.49' },
                    { name: 'India', flag: 'in', sales: 4, revenue: '$2,800', spend: '$1,567.89', roas: '1.79' },
                    { name: 'United Kingdom', flag: 'gb', sales: 2, revenue: '$1,400', spend: '$1,018.54', roas: '1.37' }
                ],
                alerts: [
                    { type: 'info', level: 'Campaign', name: 'Email Automation - SMB', spend: '$2,876.54', roas: '1.46', threshold: 'Performing well' }
                ],
                recentSales: [
                    { time: '45 min ago', campaign: 'Email Automation - SMB', adSet: 'Marketers', adName: 'Email Builder Demo', country: 'United States', amount: '$700' },
                    { time: '4 hours ago', campaign: 'Newsletter Tools - Creators', adSet: 'Content Creators', adName: 'Template Gallery', country: 'India', amount: '$700' },
                    { time: '9 hours ago', campaign: 'Email Automation - SMB', adSet: 'Marketers', adName: 'Drag & Drop Editor', country: 'United States', amount: '$700' },
                    { time: '1 day ago', campaign: 'Newsletter Tools - Creators', adSet: 'Content Creators', adName: 'Subscriber Growth Ad', country: 'United Kingdom', amount: '$700' },
                    { time: '1 day ago', campaign: 'Email Automation - SMB', adSet: 'Marketers', adName: 'Automation Flow Video', country: 'Germany', amount: '$700' },
                    { time: '2 days ago', campaign: 'Newsletter Tools - Creators', adSet: 'Content Creators', adName: 'Template Gallery', country: 'India', amount: '$700' },
                    { time: '3 days ago', campaign: 'Email Automation - SMB', adSet: 'Marketers', adName: 'Email Builder Demo', country: 'Canada', amount: '$700' },
                    { time: '4 days ago', campaign: 'Newsletter Tools - Creators', adSet: 'Content Creators', adName: 'Open Rate Boost Ad', country: 'Australia', amount: '$700' },
                    { time: '5 days ago', campaign: 'Email Automation - SMB', adSet: 'Marketers', adName: 'Drag & Drop Editor', country: 'United States', amount: '$700' }
                ],
                webhookUrl: 'https://chat.googleapis.com/v1/spaces/GHI789/messages?key=xyz_email',
                todayRevenue: '$1,400',
                weekRevenue: '$4,200',
                monthRevenue: '$7,700',
                revenueTransactions: [
                    { date: 'Jan 24, 2026 - 11:30 AM', txnId: 'TXN_EM_2026012401', customer: 'marketing@startup.io', product: 'Pabbly Email Marketing', country: 'United States', flag: 'us', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 24, 2026 - 9:15 AM', txnId: 'TXN_EM_2026012402', customer: 'newsletter@creator.in', product: 'Pabbly Email Marketing', country: 'India', flag: 'in', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 23, 2026 - 7:45 PM', txnId: 'TXN_EM_2026012303', customer: 'campaigns@agency.co.uk', product: 'Pabbly Email Marketing', country: 'United Kingdom', flag: 'gb', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 23, 2026 - 3:20 PM', txnId: 'TXN_EM_2026012304', customer: 'growth@saas.com', product: 'Pabbly Email Marketing', country: 'United States', flag: 'us', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 22, 2026 - 11:00 AM', txnId: 'TXN_EM_2026012205', customer: 'outreach@business.in', product: 'Pabbly Email Marketing', country: 'India', flag: 'in', amount: '$700', source: 'Webhook' }
                ],
                leads: [
                    { date: 'Jan 24, 2026', source: 'Facebook Ads', count: 58, campaign: 'Email Automation - SMB', notes: 'High volume' },
                    { date: 'Jan 23, 2026', source: 'Facebook Ads', count: 62, campaign: 'Newsletter Tools - Creators', notes: 'Content creators' },
                    { date: 'Jan 22, 2026', source: 'Organic', count: 45, campaign: 'N/A', notes: 'SEO traffic' },
                    { date: 'Jan 21, 2026', source: 'Facebook Ads', count: 71, campaign: 'Email Automation - SMB', notes: 'Best performing day' },
                    { date: 'Jan 20, 2026', source: 'Facebook Ads', count: 48, campaign: 'Newsletter Tools - Creators', notes: 'Stable quality' }
                ],
                todayLeads: 58,
                weekLeads: 234,
                monthLeads: 312
            },
            psb: {
                name: 'Pabbly PSB',
                icon: 'fa-credit-card',
                color: 'linear-gradient(135deg, #f59e0b, #ef4444)',
                accountId: 'act_321654987',
                metrics: {
                    totalSpend: '$9,876.54',
                    totalRevenue: '$14,000',
                    roas: '1.42',
                    totalLeads: '156',
                    costPerLead: '$63.31',
                    pixelStatus: 'Active',
                    totalSales: 20
                },
                timeBasedMetrics: {
                    daily: {
                        spend: 410.00,
                        revenue: 2100.00,
                        roas: 5.12,
                        leads: 28,
                        cpl: 14.64
                    },
                    weekly: {
                        spend: 1950.00,
                        revenue: 7000.00,
                        roas: 3.59,
                        leads: 95,
                        cpl: 20.53
                    },
                    monthly: {
                        spend: 9876.54,
                        revenue: 14000.00,
                        roas: 1.42,
                        leads: 156,
                        cpl: 63.31
                    }
                },
                timeRangeMetrics: {
                    today: { spend: 410.00, revenue: 2100.00, leads: 28, sales: 3 },
                    last7days: { spend: 1950.00, revenue: 7000.00, leads: 95, sales: 10 },
                    last30days: { spend: 9876.54, revenue: 14000.00, leads: 156, sales: 20 },
                    last90days: { spend: 28765.43, revenue: 39200.00, leads: 445, sales: 56 },
                    thismonth: { spend: 7123.45, revenue: 10500.00, leads: 112, sales: 15 },
                    lastmonth: { spend: 8901.23, revenue: 12600.00, leads: 134, sales: 18 }
                },
                campaigns: [
                    { name: 'Subscription Billing - SaaS', status: 'Active', budget: '$1,100.00', spend: '$4,123.45', sales: 9, revenue: '$6,300', roas: '1.53', frequency: '1.5', outboundClicks: '3,567', reach: '112,500', impressions: '168,750' },
                    { name: 'Payment Gateway - Global', status: 'Active', budget: '$950.00', spend: '$3,456.78', sales: 6, revenue: '$4,200', roas: '1.22', frequency: '2.0', outboundClicks: '2,789', reach: '76,400', impressions: '152,800' },
                    { name: 'Invoice Management - SMB', status: 'Active', budget: '$550.00', spend: '$1,890.31', sales: 4, revenue: '$2,800', roas: '1.48', frequency: '1.3', outboundClicks: '1,678', reach: '58,200', impressions: '75,660' },
                    { name: 'Recurring Payments - EU', status: 'Paused', budget: '$150.00', spend: '$406.00', sales: 1, revenue: '$700', roas: '1.72', frequency: '1.1', outboundClicks: '456', reach: '18,900', impressions: '20,790' }
                ],
                adSets: [
                    { name: 'SaaS Companies', campaignName: 'Subscription Billing - SaaS', status: 'Active', budget: '$600.00', spend: '$2,200.00', sales: 5, revenue: '$3,500', roas: '1.59', frequency: '1.4', outboundClicks: '2,134', reach: '67,800', impressions: '94,920' },
                    { name: 'E-commerce Stores', campaignName: 'Payment Gateway - Global', status: 'Active', budget: '$500.00', spend: '$1,800.00', sales: 3, revenue: '$2,100', roas: '1.17', frequency: '1.9', outboundClicks: '1,567', reach: '42,300', impressions: '80,370' },
                    { name: 'Small Business', campaignName: 'Invoice Management - SMB', status: 'Active', budget: '$300.00', spend: '$1,000.00', sales: 2, revenue: '$1,400', roas: '1.40', frequency: '1.2', outboundClicks: '987', reach: '34,500', impressions: '41,400' },
                    { name: 'European Businesses', campaignName: 'Recurring Payments - EU', status: 'Paused', budget: '$150.00', spend: '$406.00', sales: 1, revenue: '$700', roas: '1.72', frequency: '1.1', outboundClicks: '456', reach: '18,900', impressions: '20,790' }
                ],
                ads: [
                    { name: 'Billing Demo Video', campaignName: 'Subscription Billing - SaaS', adSetName: 'SaaS Companies', status: 'Active', budget: '$320.00', spend: '$1,100.00', sales: 4, revenue: '$2,800.00', roas: '2.55', frequency: '1.3', outboundClicks: '1,234', reach: '38,500', impressions: '50,050' },
                    { name: 'Payment Flow Image Ad', campaignName: 'Payment Gateway - Global', adSetName: 'E-commerce Stores', status: 'Active', budget: '$260.00', spend: '$900.00', sales: 2, revenue: '$1,400.00', roas: '1.56', frequency: '1.8', outboundClicks: '923', reach: '24,600', impressions: '44,280' },
                    { name: 'Invoice Carousel Ad', campaignName: 'Invoice Management - SMB', adSetName: 'Small Business', status: 'Active', budget: '$150.00', spend: '$500.00', sales: 1, revenue: '$700.00', roas: '1.40', frequency: '1.1', outboundClicks: '534', reach: '19,200', impressions: '21,120' },
                    { name: 'UGC - SaaS Founder Review', campaignName: 'Subscription Billing - SaaS', adSetName: 'SaaS Companies', status: 'Active', budget: '$290.00', spend: '$980.00', sales: 3, revenue: '$2,100.00', roas: '2.14', frequency: '1.4', outboundClicks: '1,089', reach: '34,200', impressions: '47,880' },
                    { name: 'Reel - Checkout in 60 Sec', campaignName: 'Payment Gateway - Global', adSetName: 'E-commerce Stores', status: 'Active', budget: '$220.00', spend: '$740.00', sales: 2, revenue: '$1,400.00', roas: '1.89', frequency: '1.5', outboundClicks: '812', reach: '26,300', impressions: '39,450' },
                    { name: 'Image - Invoice Templates', campaignName: 'Invoice Management - SMB', adSetName: 'Small Business', status: 'Active', budget: '$170.00', spend: '$540.00', sales: 1, revenue: '$700.00', roas: '1.30', frequency: '1.2', outboundClicks: '467', reach: '18,100', impressions: '21,720' },
                    { name: 'Video - Auto Recurring Setup', campaignName: 'Subscription Billing - SaaS', adSetName: 'SaaS Companies', status: 'Active', budget: '$250.00', spend: '$850.00', sales: 2, revenue: '$1,400.00', roas: '1.65', frequency: '1.6', outboundClicks: '934', reach: '30,100', impressions: '48,160' },
                    { name: 'Carousel - Payment Methods', campaignName: 'Payment Gateway - Global', adSetName: 'E-commerce Stores', status: 'Active', budget: '$200.00', spend: '$670.00', sales: 1, revenue: '$700.00', roas: '1.04', frequency: '1.7', outboundClicks: '578', reach: '20,800', impressions: '35,360' },
                    { name: 'Story Ad - Free Trial', campaignName: 'Invoice Management - SMB', adSetName: 'Small Business', status: 'Active', budget: '$130.00', spend: '$390.00', sales: 1, revenue: '$700.00', roas: '1.79', frequency: '1.0', outboundClicks: '356', reach: '14,800', impressions: '14,800' },
                    { name: 'EU Recurring Video', campaignName: 'Recurring Payments - EU', adSetName: 'European Businesses', status: 'Paused', budget: '$100.00', spend: '$280.00', sales: 1, revenue: '$700.00', roas: '2.50', frequency: '1.0', outboundClicks: '312', reach: '12,400', impressions: '12,400' },
                    { name: 'SEPA Payment Ad - Old', campaignName: 'Recurring Payments - EU', adSetName: 'European Businesses', status: 'Paused', budget: '$80.00', spend: '$210.00', sales: 0, revenue: '$0.00', roas: '0.00', frequency: '2.6', outboundClicks: '178', reach: '5,900', impressions: '15,340' }
                ],
                countries: [
                    { name: 'United States', flag: 'us', sales: 8, revenue: '$5,600', spend: '$4,234.56', roas: '1.32' },
                    { name: 'Australia', flag: 'au', sales: 5, revenue: '$3,500', spend: '$2,345.67', roas: '1.49' },
                    { name: 'United Kingdom', flag: 'gb', sales: 4, revenue: '$2,800', spend: '$1,890.31', roas: '1.48' },
                    { name: 'Germany', flag: 'de', sales: 2, revenue: '$1,400', spend: '$906.00', roas: '1.55' },
                    { name: 'France', flag: 'fr', sales: 1, revenue: '$700', spend: '$500.00', roas: '1.40' }
                ],
                alerts: [
                    { type: 'info', level: 'Campaign', name: 'Subscription Billing - SaaS', spend: '$4,123.45', roas: '1.53', threshold: 'Top performer - increase budget' },
                    { type: 'warning', level: 'Campaign', name: 'Payment Gateway - Global', spend: '$3,456.78', roas: '1.22', threshold: '$2,800' }
                ],
                recentSales: [
                    { time: '15 min ago', campaign: 'Subscription Billing - SaaS', adSet: 'SaaS Founders', adName: 'Billing Dashboard Demo', country: 'United States', amount: '$700' },
                    { time: '1 hour ago', campaign: 'Payment Gateway - Global', adSet: 'E-commerce', adName: 'Payment Flow Video', country: 'Australia', amount: '$700' },
                    { time: '3 hours ago', campaign: 'Invoice Management - SMB', adSet: 'Small Business', adName: 'Invoice Generator', country: 'United Kingdom', amount: '$700' },
                    { time: '7 hours ago', campaign: 'Subscription Billing - SaaS', adSet: 'SaaS Founders', adName: 'Recurring Revenue Ad', country: 'United States', amount: '$700' },
                    { time: '12 hours ago', campaign: 'Payment Gateway - Global', adSet: 'E-commerce', adName: 'Checkout Integration', country: 'India', amount: '$700' },
                    { time: '1 day ago', campaign: 'Invoice Management - SMB', adSet: 'Small Business', adName: 'Auto Invoice Video', country: 'Germany', amount: '$700' },
                    { time: '1 day ago', campaign: 'Subscription Billing - SaaS', adSet: 'SaaS Founders', adName: 'Billing Dashboard Demo', country: 'Canada', amount: '$700' },
                    { time: '2 days ago', campaign: 'Payment Gateway - Global', adSet: 'E-commerce', adName: 'Multi-Currency Ad', country: 'Brazil', amount: '$700' },
                    { time: '3 days ago', campaign: 'Invoice Management - SMB', adSet: 'Small Business', adName: 'Invoice Generator', country: 'United States', amount: '$700' },
                    { time: '4 days ago', campaign: 'Subscription Billing - SaaS', adSet: 'SaaS Founders', adName: 'Recurring Revenue Ad', country: 'Australia', amount: '$700' },
                    { time: '5 days ago', campaign: 'Payment Gateway - Global', adSet: 'E-commerce', adName: 'Payment Flow Video', country: 'United Kingdom', amount: '$700' },
                    { time: '6 days ago', campaign: 'Invoice Management - SMB', adSet: 'Small Business', adName: 'Tax Compliance Ad', country: 'India', amount: '$700' }
                ],
                webhookUrl: 'https://chat.googleapis.com/v1/spaces/JKL012/messages?key=xyz_psb',
                todayRevenue: '$2,100',
                weekRevenue: '$7,000',
                monthRevenue: '$14,000',
                revenueTransactions: [
                    { date: 'Jan 24, 2026 - 10:45 AM', txnId: 'TXN_PSB_2026012401', customer: 'billing@saascompany.com', product: 'Pabbly PSB', country: 'United States', flag: 'us', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 24, 2026 - 8:20 AM', txnId: 'TXN_PSB_2026012402', customer: 'subscriptions@tech.au', product: 'Pabbly PSB', country: 'Australia', flag: 'au', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 24, 2026 - 5:30 AM', txnId: 'TXN_PSB_2026012403', customer: 'payments@ecommerce.co.uk', product: 'Pabbly PSB', country: 'United Kingdom', flag: 'gb', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 23, 2026 - 9:15 PM', txnId: 'TXN_PSB_2026012304', customer: 'invoicing@startup.de', product: 'Pabbly PSB', country: 'Germany', flag: 'de', amount: '$700', source: 'Webhook' },
                    { date: 'Jan 23, 2026 - 4:45 PM', txnId: 'TXN_PSB_2026012305', customer: 'recurring@business.fr', product: 'Pabbly PSB', country: 'France', flag: 'fr', amount: '$700', source: 'Webhook' }
                ],
                leads: [
                    { date: 'Jan 24, 2026', source: 'Facebook Ads', count: 28, campaign: 'Subscription Billing - SaaS', notes: 'SaaS founders' },
                    { date: 'Jan 23, 2026', source: 'Facebook Ads', count: 32, campaign: 'Payment Gateway - Global', notes: 'E-commerce' },
                    { date: 'Jan 22, 2026', source: 'Facebook Ads', count: 25, campaign: 'Invoice Management - SMB', notes: 'Small business' },
                    { date: 'Jan 21, 2026', source: 'Organic', count: 18, campaign: 'N/A', notes: 'Direct traffic' },
                    { date: 'Jan 20, 2026', source: 'Facebook Ads', count: 35, campaign: 'Subscription Billing - SaaS', notes: 'High intent' }
                ],
                todayLeads: 28,
                weekLeads: 103,
                monthLeads: 156
            }
        };

        // Current active account
        let currentAccount = 'connect';

        // Current status filters for each table (independent filtering)
        let campaignsStatusFilter = 'active';
        let adSetsStatusFilter = 'active';
        let adsStatusFilter = 'active';
        let adSetsCampaignFilter = 'all';
        let adsCampaignFilter = 'all';
        let adsAdSetFilter = 'all';
        let campaignsSearchQuery = '';
        let adSetsSearchQuery = '';
        let adsSearchQuery = '';
        let countrySearchQuery = '';
        let salesCreativeSearchQuery = '';

        // ==================== WEBHOOK DATA STORE ====================
        // Saved webhooks list
        let savedWebhooks = [
            {
                id: 'wh_001',
                name: 'Google Chat - Sales Alerts',
                url: 'https://chat.googleapis.com/v1/spaces/AAAA1234/messages?key=AIzaSyBxxx',
                triggers: ['new_sale', 'overspend_alert', 'low_roas_alert']
            },
            {
                id: 'wh_002',
                name: 'Slack - Lead Notifications',
                url: 'https://hooks.slack.com/services/T00000/B00000/XXXXXXXXXXXXXXX',
                triggers: ['new_lead', 'daily_report']
            },
            {
                id: 'wh_003',
                name: 'Pabbly Connect - Automation',
                url: 'https://connect.pabbly.com/workflow/sendwebhookdata/abcdef123456',
                triggers: ['new_sale', 'new_lead', 'campaign_status', 'pixel_status']
            }
        ];
        let editingWebhookId = null;

        // Trigger labels map
        const triggerLabels = {
            'new_sale': 'New Sale',
            'new_lead': 'New Lead Captured',
            'overspend_alert': 'Overspend Alert',
            'low_roas_alert': 'Low ROAS Alert',
            'high_frequency': 'High Ad Frequency',
            'daily_report': 'Daily Summary Report',
            'pixel_status': 'Pixel Status Change',
            'campaign_status': 'Campaign Status Change'
        };

        // Update table count display
        function updateTableCount(sectionSelector, count, filter) {
            const section = document.querySelector(sectionSelector);
            if (section) {
                const countSpan = section.querySelector('.count');
                if (countSpan) {
                    const statusLabel = filter === 'all' ? 'Total' : filter.charAt(0).toUpperCase() + filter.slice(1);
                    countSpan.textContent = count + ' ' + statusLabel;
                }
            }
        }

        // Toggle Account Dropdown
        function toggleAccountDropdown() {
            const dropdown = document.getElementById('accountDropdown');
            const btn = document.querySelector('.account-switcher-btn');
            dropdown.classList.toggle('show');
            btn.classList.toggle('open');
        }

        // Switch Account - Updates ALL dashboard data
        function switchAccount(accountName, accountType) {
            currentAccount = accountType;
            const data = accountData[accountType];

            // Update button text
            document.getElementById('currentAccountName').textContent = accountName;

            // Update active state in dropdown
            document.querySelectorAll('.account-option').forEach(option => {
                option.classList.remove('active');
            });
            event.currentTarget.classList.add('active');

            // Update icon
            const iconMap = {
                'connect': 'fa-plug',
                'chatflow': 'fa-comments',
                'email': 'fa-envelope',
                'psb': 'fa-credit-card'
            };
            const accountIcon = document.querySelector('.account-switcher-btn .account-icon i');
            accountIcon.className = 'fas ' + iconMap[accountType];

            // Update icon background
            const iconDiv = document.querySelector('.account-switcher-btn .account-icon');
            iconDiv.style.background = data.color;

            // Close dropdown
            document.getElementById('accountDropdown').classList.remove('show');
            document.querySelector('.account-switcher-btn').classList.remove('open');

            // Update all dashboard data
            updateDashboardData(data);
        }

        // Handle Time Range Change
        function handleTimeRangeChange() {
            const timeRange = document.getElementById('time-range-selector').value;
            const data = accountData[currentAccount];

            // Get metrics based on time range
            let metricsToShow;
            switch(timeRange) {
                case 'today':
                    metricsToShow = data.timeRangeMetrics?.today || data.timeBasedMetrics?.daily;
                    break;
                case 'last7days':
                    metricsToShow = data.timeRangeMetrics?.last7days || data.timeBasedMetrics?.weekly;
                    break;
                case 'last30days':
                    metricsToShow = data.timeRangeMetrics?.last30days || data.timeBasedMetrics?.monthly;
                    break;
                case 'last90days':
                    metricsToShow = data.timeRangeMetrics?.last90days || data.timeBasedMetrics?.monthly;
                    break;
                case 'thismonth':
                    metricsToShow = data.timeRangeMetrics?.thismonth || data.timeBasedMetrics?.monthly;
                    break;
                case 'lastmonth':
                    metricsToShow = data.timeRangeMetrics?.lastmonth || data.timeBasedMetrics?.monthly;
                    break;
                default:
                    metricsToShow = data.timeBasedMetrics?.monthly;
            }

            // Update only the metrics cards, not the bottom tables
            if (metricsToShow) {
                updateMetricsCardsFromTimeRange(metricsToShow);
            }

            // Update last synced time
            updateLastSyncedTime();
        }

        // Refresh Dashboard Data
        function refreshDashboardData() {
            const data = accountData[currentAccount];
            const timeRange = document.getElementById('time-range-selector').value;

            // Show loading state
            const refreshBtn = event.currentTarget;
            const icon = refreshBtn.querySelector('i');
            icon.classList.add('fa-spin');
            document.getElementById('last-synced-time').textContent = 'Syncing...';

            // Simulate API call
            setTimeout(() => {
                // Update metrics based on current time range
                handleTimeRangeChange();

                // Update other sections
                updateTimeBasedTables(data.timeBasedMetrics);

                // Stop loading
                icon.classList.remove('fa-spin');
                updateLastSyncedTime();
            }, 800);
        }

        // Update last synced time
        function updateLastSyncedTime() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
            document.getElementById('last-synced-time').textContent = 'Last synced: Just now';
        }

        // Update Metrics Cards from Time Range Data
        function updateMetricsCardsFromTimeRange(metricsData) {
            const cards = document.querySelectorAll('#metrics-section .metric-card');
            if (cards.length >= 5 && metricsData) {
                // Calculate derived values
                const spend = metricsData.spend || 0;
                const revenue = metricsData.revenue || 0;
                const leads = metricsData.leads || 0;
                const sales = metricsData.sales || Math.round(revenue / 700); // Estimate based on avg sale
                const roas = spend > 0 ? (revenue / spend) : 0;
                const cpl = leads > 0 ? (spend / leads) : 0;

                // Format currency
                const formatCurrency = (val) => `$${val.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;

                // Update Total Ad Spend
                cards[0].querySelector('.metric-value').textContent = formatCurrency(spend);

                // Update Total Revenue with Sales Count
                const totalRevenueEl = document.getElementById('total-revenue-value');
                const totalSalesCountEl = document.getElementById('total-sales-count');
                if (totalRevenueEl) totalRevenueEl.textContent = formatCurrency(revenue);
                if (totalSalesCountEl) totalSalesCountEl.textContent = sales;

                // Update ROAS
                const roasValueEl = document.getElementById('roas-value');
                if (roasValueEl) {
                    roasValueEl.textContent = roas.toFixed(2);
                    roasValueEl.style.color = roas >= 1.5 ? 'var(--success-color)' : roas >= 1.0 ? 'var(--warning-color)' : 'var(--danger-color)';
                }

                // Update Total Leads with CPL
                const totalLeadsEl = document.getElementById('total-leads-value');
                const cplEl = document.getElementById('cpl-value');
                if (totalLeadsEl) totalLeadsEl.textContent = leads;
                if (cplEl) cplEl.textContent = formatCurrency(cpl);
            }
        }

        // Update all dashboard sections with account data
        function updateDashboardData(data) {
            // Update Metrics Cards based on selected time range
            handleTimeRangeChange();

            // Update Time-based Tables (always show fixed rolling periods)
            updateTimeBasedTables(data.timeBasedMetrics);

            // Reset campaign/adset filters on account switch
            adSetsCampaignFilter = 'all';
            adsCampaignFilter = 'all';
            adsAdSetFilter = 'all';
            populateFilterDropdowns();

            // Update tables using filter functions
            applyCampaignsFilter();
            applyAdSetsFilter();
            applyAdsFilter();

            // Update Countries Table
            updateCountriesTable(data.countries);

            // Update Alerts
            updateAlerts(data.alerts, data.name);

            // Update Recent Sales
            updateRecentSales(data.recentSales);

            // Update Revenue Cards
            updateRevenueCards(data);

            // Update Pabbly Revenue Transactions (Data Management)
            updateRevenueTransactions(data);

            // Update Leads Data (Data Management)
            updateLeadsData(data);

            // Update Settings Account Info
            updateSettingsInfo(data);
        }

        // Update Metrics Cards
        function updateMetricsCards(metrics) {
            const cards = document.querySelectorAll('.metric-card');
            if (cards.length >= 5) {
                // Total Ad Spend
                cards[0].querySelector('.metric-value').textContent = metrics.totalSpend;

                // Total Revenue with Sales Count
                const totalRevenueEl = document.getElementById('total-revenue-value');
                const totalSalesCountEl = document.getElementById('total-sales-count');
                if (totalRevenueEl) totalRevenueEl.textContent = metrics.totalRevenue;
                if (totalSalesCountEl) totalSalesCountEl.textContent = metrics.totalSales || '0';

                // ROAS
                const roasValueEl = document.getElementById('roas-value');
                if (roasValueEl) roasValueEl.textContent = metrics.roas;

                // Total Leads with CPL
                const totalLeadsEl = document.getElementById('total-leads-value');
                const cplEl = document.getElementById('cpl-value');
                if (totalLeadsEl) totalLeadsEl.textContent = metrics.totalLeads;
                if (cplEl) cplEl.textContent = metrics.costPerLead;

                // Pixel status
                const pixelCard = cards[4];
                if (pixelCard) {
                    const pixelStatus = pixelCard.querySelector('.pixel-status span:last-child');
                    if (pixelStatus) pixelStatus.textContent = metrics.pixelStatus;
                }
            }
        }

        // Update Time-based Performance Tables
        function updateTimeBasedTables(timeBasedMetrics) {
            if (!timeBasedMetrics) return;

            // Helper function to format currency
            const formatCurrency = (value) => `$${value.toFixed(2)}`;

            // Helper function to format date
            const formatDate = (date) => {
                const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                return `${months[date.getMonth()]} ${date.getDate()}, ${date.getFullYear()}`;
            };

            const formatDateShort = (date) => {
                const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                return `${months[date.getMonth()]} ${date.getDate()}`;
            };

            // Calculate date ranges
            const today = new Date();

            // Today's date
            const todayDateStr = formatDate(today);

            // Past 7 days
            const weekEnd = new Date(today);
            const weekStart = new Date(today);
            weekStart.setDate(today.getDate() - 6); // Past 7 days including today
            const weekDateStr = `${formatDateShort(weekStart)} - ${formatDateShort(weekEnd)}, ${today.getFullYear()}`;

            // Past 30 days
            const monthEnd = new Date(today);
            const monthStart = new Date(today);
            monthStart.setDate(today.getDate() - 29); // Past 30 days including today
            const monthDateStr = `${formatDateShort(monthStart)} - ${formatDateShort(monthEnd)}, ${today.getFullYear()}`;

            // Update date range displays
            const dailyDateEl = document.getElementById('daily-date-range');
            const weeklyDateEl = document.getElementById('weekly-date-range');
            const monthlyDateEl = document.getElementById('monthly-date-range');

            if (dailyDateEl) dailyDateEl.textContent = todayDateStr;
            if (weeklyDateEl) weeklyDateEl.textContent = weekDateStr;
            if (monthlyDateEl) monthlyDateEl.textContent = monthDateStr;

            // Update Daily Table
            if (timeBasedMetrics.daily) {
                const daily = timeBasedMetrics.daily;
                document.getElementById('daily-spend').textContent = formatCurrency(daily.spend);
                document.getElementById('daily-revenue').textContent = formatCurrency(daily.revenue);
                document.getElementById('daily-roas').textContent = daily.roas.toFixed(2);
                document.getElementById('daily-leads').textContent = daily.leads;
                document.getElementById('daily-cpl').textContent = formatCurrency(daily.cpl);
            }

            // Update Weekly Table
            if (timeBasedMetrics.weekly) {
                const weekly = timeBasedMetrics.weekly;
                document.getElementById('weekly-spend').textContent = formatCurrency(weekly.spend);
                document.getElementById('weekly-revenue').textContent = formatCurrency(weekly.revenue);
                document.getElementById('weekly-roas').textContent = weekly.roas.toFixed(2);
                document.getElementById('weekly-leads').textContent = weekly.leads;
                document.getElementById('weekly-cpl').textContent = formatCurrency(weekly.cpl);
            }

            // Update Monthly Table
            if (timeBasedMetrics.monthly) {
                const monthly = timeBasedMetrics.monthly;
                document.getElementById('monthly-spend').textContent = formatCurrency(monthly.spend);
                document.getElementById('monthly-revenue').textContent = formatCurrency(monthly.revenue);
                document.getElementById('monthly-roas').textContent = monthly.roas.toFixed(2);
                document.getElementById('monthly-leads').textContent = monthly.leads;
                document.getElementById('monthly-cpl').textContent = formatCurrency(monthly.cpl);
            }
        }

        // Update Campaigns Table
        function updateCampaignsTable(campaigns) {
            const tbody = document.querySelector('#campaigns-section tbody');
            if (!tbody) return;

            const sorted = [...campaigns].sort((a, b) => parseFloat(a.roas) - parseFloat(b.roas));
            tbody.innerHTML = sorted.map(campaign => `
                <tr style="${parseFloat(campaign.roas) < 0.5 ? 'background-color: #ffe0e0;' : parseFloat(campaign.roas) < 1 ? 'background-color: #fff5f5;' : ''}">
                    <td><span class="status-badge ${campaign.status.toLowerCase()}">${campaign.status}</span></td>
                    <td><strong>${campaign.name}</strong></td>
                    <td>${campaign.budget || '$0.00'}</td>
                    <td>${campaign.spend}</td>
                    <td>${campaign.sales}</td>
                    <td>${campaign.revenue}</td>
                    <td><span class="roas-value ${parseFloat(campaign.roas) >= 1.5 ? 'good' : parseFloat(campaign.roas) >= 1.0 ? 'warning' : 'bad'}">${campaign.roas}</span></td>
                    <td>${campaign.frequency}</td>
                    <td>${campaign.outboundClicks || '0'}</td>
                    <td>${campaign.reach || '0'}</td>
                    <td>${campaign.impressions || '0'}</td>
                </tr>
            `).join('');
        }

        // Update Ad Sets Table
        function updateAdSetsTable(adSets) {
            const tbody = document.querySelector('#adsets-section tbody');
            if (!tbody) return;

            const sorted = [...adSets].sort((a, b) => parseFloat(a.roas) - parseFloat(b.roas));
            tbody.innerHTML = sorted.map(adSet => `
                <tr style="${parseFloat(adSet.roas) < 0.5 ? 'background-color: #ffe0e0;' : parseFloat(adSet.roas) < 1 ? 'background-color: #fff5f5;' : ''}">
                    <td><span class="status-badge ${adSet.status.toLowerCase()}">${adSet.status}</span></td>
                    <td>
                        <span class="name-with-tooltip" data-tooltip="Campaign: ${adSet.campaignName}">
                            <strong>${adSet.name}</strong>
                        </span>
                    </td>
                    <td>${adSet.budget || '$0.00'}</td>
                    <td>${adSet.spend}</td>
                    <td>${adSet.sales}</td>
                    <td>${adSet.revenue}</td>
                    <td><span class="roas-value ${parseFloat(adSet.roas) >= 1.5 ? 'good' : parseFloat(adSet.roas) >= 1.0 ? 'warning' : 'bad'}">${adSet.roas}</span></td>
                    <td>${adSet.frequency}</td>
                    <td>${adSet.outboundClicks || '0'}</td>
                    <td>${adSet.reach || '0'}</td>
                    <td>${adSet.impressions || '0'}</td>
                </tr>
            `).join('');
        }

        // Update Ads Table
        function updateAdsTable(ads) {
            const tbody = document.querySelector('#ads-section tbody');
            if (!tbody) return;

            const sorted = [...ads].sort((a, b) => parseFloat(a.roas) - parseFloat(b.roas));
            tbody.innerHTML = sorted.map(ad => `
                <tr style="${parseFloat(ad.roas) < 0.5 ? 'background-color: #ffe0e0;' : parseFloat(ad.roas) < 1 ? 'background-color: #fff5f5;' : ''}">
                    <td><span class="status-badge ${ad.status.toLowerCase()}">${ad.status}</span></td>
                    <td>
                        <span class="name-with-tooltip" data-tooltip="Campaign: ${ad.campaignName} | Ad Set: ${ad.adSetName}">
                            <strong>${ad.name}</strong>
                        </span>
                    </td>
                    <td>${ad.budget || '$0.00'}</td>
                    <td>${ad.spend}</td>
                    <td>${ad.sales}</td>
                    <td>${ad.revenue}</td>
                    <td><span class="roas-value ${parseFloat(ad.roas) >= 1.5 ? 'good' : parseFloat(ad.roas) >= 1.0 ? 'warning' : 'bad'}">${ad.roas}</span></td>
                    <td>${ad.frequency}</td>
                    <td>${ad.outboundClicks || '0'}</td>
                    <td>${ad.reach || '0'}</td>
                    <td>${ad.impressions || '0'}</td>
                </tr>
            `).join('');
        }

        // Update Countries Table
        function updateCountriesTable(countries) {
            const tbody = document.querySelector('#country-section tbody');
            if (!tbody) return;

            const sorted = [...countries].sort((a, b) => parseFloat(a.roas) - parseFloat(b.roas));
            tbody.innerHTML = sorted.map(country => `
                <tr style="${parseFloat(country.roas) < 1 ? 'background-color: #fff5f5;' : ''}">
                    <td>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <img src="https://flagcdn.com/24x18/${country.flag}.png" alt="${country.name}">
                            <strong>${country.name}</strong>
                        </div>
                    </td>
                    <td>${country.spend}</td>
                    <td><strong>${country.sales}</strong></td>
                    <td><strong>${country.revenue}</strong></td>
                    <td><span class="roas-value ${parseFloat(country.roas) >= 1.5 ? 'good' : parseFloat(country.roas) >= 1.0 ? 'warning' : 'bad'}">${country.roas}</span></td>
                </tr>
            `).join('');
        }

        function applyCountryFilter() {
            const data = accountData[currentAccount];
            let filtered = data.countries;
            if (countrySearchQuery) {
                filtered = filtered.filter(c => c.name.toLowerCase().includes(countrySearchQuery));
            }
            updateCountriesTable(filtered);
        }

        // Update Alerts Section
        function updateAlerts(alerts, accountName) {
            const alertsList = document.querySelector('#alerts-section .alerts-list, #alerts-section .table-container');
            if (!alertsList) return;

            // Update alert count badge
            const alertBadge = document.querySelector('.nav-item .badge');
            if (alertBadge) alertBadge.textContent = alerts.length;

            // Update alerts header with account name
            const alertsHeader = document.querySelector('#alerts-section .table-header h3');
            if (alertsHeader) {
                const countSpan = alertsHeader.querySelector('.count');
                if (countSpan) countSpan.textContent = alerts.length + ' Active';
            }
        }

        // Update Recent Sales
        function updateRecentSales(sales) {
            const salesSection = document.querySelector('#sales-creative-section tbody');
            if (!salesSection) return;

            salesSection.innerHTML = sales.map((sale, index) => {
                const flagMap = { 'United States': 'us', 'India': 'in', 'Brazil': 'br', 'United Kingdom': 'gb', 'Australia': 'au', 'Germany': 'de', 'Canada': 'ca', 'Spain': 'es', 'France': 'fr' };
                const flag = flagMap[sale.country] || 'us';
                return `
                <tr>
                    <td>
                        <div style="width: 28px; height: 28px; border-radius: 4px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 12px;">
                            <i class="fas fa-image"></i>
                        </div>
                    </td>
                    <td><strong>${sale.adName}</strong></td>
                    <td>${sale.campaign}</td>
                    <td>${sale.adSet}</td>
                    <td>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <img src="https://flagcdn.com/24x18/${flag}.png" alt="${sale.country}">
                            ${sale.country}
                        </div>
                    </td>
                    <td><strong style="color: #22c55e;">${sale.amount}</strong></td>
                    <td style="color: var(--text-secondary);">${sale.time}</td>
                </tr>
            `}).join('');
        }

        function applySalesCreativeFilter() {
            const data = accountData[currentAccount];
            let filtered = data.recentSales;
            if (salesCreativeSearchQuery) {
                filtered = filtered.filter(s =>
                    s.adName.toLowerCase().includes(salesCreativeSearchQuery) ||
                    s.campaign.toLowerCase().includes(salesCreativeSearchQuery) ||
                    s.adSet.toLowerCase().includes(salesCreativeSearchQuery)
                );
            }
            updateRecentSales(filtered);
        }

        // Update Revenue Cards in Pabbly Revenue Section
        function updateRevenueCards(data) {
            const revenueCards = document.querySelectorAll('#pabbly-revenue-section .metric-card, #pabbly-revenue-section [style*="grid-template-columns"] > div');
            // Update the revenue summary cards if they exist
            const todayCard = document.querySelector('#pabbly-revenue-section [style*="grid-template-columns"] > div:first-child');
            if (todayCard) {
                const valueEl = todayCard.querySelector('[style*="font-size: 28px"]');
                if (valueEl) valueEl.textContent = data.todayRevenue;
            }
        }

        // Update Settings Info
        function updateSettingsInfo(data) {
            // Update webhook URL display if visible
            const webhookInput = document.querySelector('#settings-section input[placeholder*="webhook"]');
            if (webhookInput) {
                webhookInput.value = data.webhookUrl || '';
            }

            // Update account ID displays
            const accountIdElements = document.querySelectorAll('[data-account-id]');
            accountIdElements.forEach(el => {
                el.textContent = data.accountId;
            });
        }

        // Update Revenue Transactions (Pabbly Sales Data Section)
        function updateRevenueTransactions(data) {
            // Update Revenue Summary Cards using IDs
            const todayEl = document.getElementById('revenue-today');
            const weekEl = document.getElementById('revenue-week');
            const monthEl = document.getElementById('revenue-month');
            const roasEl = document.getElementById('revenue-roas');

            if (todayEl) todayEl.textContent = data.todayRevenue;
            if (weekEl) weekEl.textContent = data.weekRevenue;
            if (monthEl) monthEl.textContent = data.monthRevenue;
            if (roasEl) roasEl.textContent = data.metrics.roas;

            // Update Revenue Transactions Table using ID
            const tbody = document.getElementById('revenue-transactions-tbody');
            if (tbody && data.revenueTransactions) {
                tbody.innerHTML = data.revenueTransactions.map(txn => `
                    <tr>
                        <td style="white-space: nowrap;">${txn.date}</td>
                        <td><span style="font-size: 13px;">${txn.customer}</span></td>
                        <td><code style="background: #f3f4f6; padding: 2px 6px; border-radius: 4px; font-size: 12px;">${txn.txnId}</code></td>
                        <td><strong>${txn.product}</strong></td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 6px;">
                                <img src="https://flagcdn.com/24x18/${txn.flag}.png" alt="${txn.country}">
                                ${txn.country}
                            </div>
                        </td>
                        <td><strong style="color: #166534;">${txn.amount}</strong></td>
                        <td>
                            <div class="action-menu">
                                <button class="action-menu-btn" onclick="toggleActionMenu(this)">
                                    <i class="fas fa-ellipsis-v"></i>
                                </button>
                                <div class="action-menu-dropdown">
                                    <button class="action-menu-item" onclick="editRevenueEntry(this)"><i class="fas fa-edit"></i> Edit</button>
                                    <button class="action-menu-item delete" onclick="confirmDeleteEntry(this)"><i class="fas fa-trash"></i> Delete</button>
                                </div>
                            </div>
                        </td>
                    </tr>
                `).join('');
            }

            // Update transaction count in pagination using ID
            const paginationText = document.getElementById('revenue-pagination-text');
            if (paginationText && data.revenueTransactions) {
                paginationText.textContent = `Showing 1-${Math.min(5, data.revenueTransactions.length)} of ${data.revenueTransactions.length} transactions`;
            }
        }

        // Update Leads Data Section
        function updateLeadsData(data) {
            // Update header lead count
            const leadsSection = document.getElementById('leads-data-section');
            if (leadsSection) {
                const headerSpan = leadsSection.querySelector('.table-header span[style*="color: var(--text-secondary)"]');
                if (headerSpan) {
                    headerSpan.innerHTML = `<i class="fas fa-users"></i> ${data.monthLeads} leads this month`;
                }
            }

            // Update Leads Summary Cards using IDs
            const todayEl = document.getElementById('leads-today');
            const weekEl = document.getElementById('leads-week');
            const monthEl = document.getElementById('leads-month');
            const cplEl = document.getElementById('leads-cpl');

            if (todayEl) todayEl.textContent = data.todayLeads;
            if (weekEl) weekEl.textContent = data.weekLeads;
            if (monthEl) monthEl.textContent = data.monthLeads;
            if (cplEl) cplEl.textContent = data.metrics.costPerLead;

            // Update Leads Table using ID
            const tbody = document.getElementById('leads-tbody');
            if (tbody && data.leads) {
                tbody.innerHTML = data.leads.map(lead => {
                    return `
                    <tr>
                        <td>${lead.date}</td>
                        <td><strong>${lead.count}</strong></td>
                        <td>
                            <div class="action-menu">
                                <button class="action-menu-btn" onclick="toggleActionMenu(this)">
                                    <i class="fas fa-ellipsis-v"></i>
                                </button>
                                <div class="action-menu-dropdown">
                                    <button class="action-menu-item" onclick="editLeadEntry(this)"><i class="fas fa-edit"></i> Edit</button>
                                    <button class="action-menu-item delete" onclick="confirmDeleteLead(this)"><i class="fas fa-trash"></i> Delete</button>
                                </div>
                            </div>
                        </td>
                    </tr>
                `}).join('');
            }
        }

        // Close account dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const switcher = document.querySelector('.account-switcher');
            if (!switcher.contains(event.target)) {
                document.getElementById('accountDropdown').classList.remove('show');
                document.querySelector('.account-switcher-btn').classList.remove('open');
            }
        });

        // Switch Tabs
        // Show Section (for navigation between dashboard sections)
        function showSection(sectionId, clickedElement) {
            console.log('showSection called with:', sectionId);

            // Dashboard sections that should show the filter bar (Time Range, Refresh)
            const dashboardSections = [
                'metrics-section',
                'campaigns-section',
                'adsets-section',
                'ads-section',
                'country-section',
                'sales-creative-section'
            ];

            const isDashboardSection = dashboardSections.includes(sectionId);
            const filterBar = document.querySelector('.filter-bar');
            const metricsSection = document.getElementById('metrics-section');

            // Show filter bar ONLY for dashboard sections
            if (filterBar) {
                filterBar.style.display = isDashboardSection ? 'flex' : 'none';
            }

            // Hide all dashboard sections first
            document.querySelectorAll('.dashboard-section').forEach(section => {
                section.classList.remove('active');
                section.style.display = 'none';
            });

            // Overview Metrics page: show metrics cards + related sections
            if (sectionId === 'metrics-section') {
                if (metricsSection) {
                    metricsSection.style.display = 'grid';
                    metricsSection.classList.add('active');
                }
                ['custom-range-header', 'snapshot-header', 'time-based-tables'].forEach(id => {
                    const el = document.getElementById(id);
                    if (el) {
                        el.classList.add('active');
                        el.style.display = 'block';
                    }
                });
            }

            // Show the selected section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
                if (sectionId === 'metrics-section') {
                    targetSection.style.display = 'grid';
                } else {
                    targetSection.style.display = 'block';
                }
                console.log('Section found and activated:', sectionId);
            } else {
                console.error('Section not found:', sectionId);
            }

            // Remove active class from all menu elements
            document.querySelectorAll('.submenu-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelectorAll('.nav-item-parent').forEach(item => {
                item.classList.remove('active');
            });

            // Add active class to clicked element and its parent group
            if (clickedElement) {
                clickedElement.classList.add('active');
                const parentGroup = clickedElement.closest('.nav-menu-group');
                if (parentGroup) {
                    const parentItem = parentGroup.querySelector('.nav-item-parent');
                    if (parentItem) parentItem.classList.add('active');
                }
            }

            // Scroll to top of content area
            const dashboardContent = document.querySelector('.dashboard-content');
            if (dashboardContent) {
                dashboardContent.scrollTop = 0;
            }
        }

        // Task Management Functions
        function switchTaskTab(tabId) {
            // Hide all task content
            document.querySelectorAll('.task-content').forEach(content => {
                content.classList.remove('active');
            });

            // Show selected tab content
            const targetContent = document.getElementById(tabId);
            if (targetContent) {
                targetContent.classList.add('active');
            }

            // Update tab button styles
            document.querySelectorAll('.task-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Add active class to clicked tab
            event.target.closest('.task-tab').classList.add('active');
        }

        function toggleTask(headerElement) {
            const taskItem = headerElement.closest('.task-item');
            taskItem.classList.toggle('expanded');
        }

        // Show Threshold Tab (for switching between Campaign/Ad Set/Ads/Country tabs)
        function showThresholdTab(tabId, clickedButton) {
            // Hide all threshold content
            document.querySelectorAll('.threshold-content').forEach(content => {
                content.style.display = 'none';
                content.classList.remove('active');
            });

            // Show the selected tab content
            const targetTab = document.getElementById(tabId);
            if (targetTab) {
                targetTab.style.display = 'block';
                targetTab.classList.add('active');
            }

            // Update tab button styles
            document.querySelectorAll('.threshold-tab').forEach(tab => {
                tab.style.fontWeight = '500';
                tab.style.color = 'var(--text-secondary)';
                tab.style.borderBottom = 'none';
                tab.classList.remove('active');
            });

            // Style the clicked tab as active
            if (clickedButton) {
                clickedButton.style.fontWeight = '600';
                clickedButton.style.color = 'var(--primary-color)';
                clickedButton.style.borderBottom = '2px solid var(--primary-color)';
                clickedButton.classList.add('active');
            }
        }

        function switchTab(tabId) {
            // Remove active from all tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Hide all tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // Activate clicked tab button
            event.target.closest('.tab-btn').classList.add('active');

            // Show selected tab content
            document.getElementById(tabId).classList.add('active');
        }

        // Toggle Submenu
        function toggleSubmenu(element) {
            const submenu = element.nextElementSibling;
            const isExpanded = element.classList.contains('expanded');

            // Toggle current submenu
            element.classList.toggle('expanded');
            submenu.classList.toggle('open');

            // Update active state
            document.querySelectorAll('.nav-item-parent').forEach(item => {
                if (item !== element) {
                    item.classList.remove('active');
                }
            });
            element.classList.add('active');
        }

        // Toggle Notification Panel
        function toggleNotifications() {
            const panel = document.getElementById('notificationPanel');
            panel.classList.toggle('show');
        }

        // Close notification panel when clicking outside
        document.addEventListener('click', function(event) {
            const panel = document.getElementById('notificationPanel');
            const bellIcon = document.querySelector('.header-icon');

            if (!panel.contains(event.target) && !bellIcon.contains(event.target)) {
                panel.classList.remove('show');
            }
        });

        // Add Revenue Entry Modal Functions
        function openAddRevenueModal() {
            const modal = document.getElementById('add-revenue-modal');
            modal.style.display = 'flex';

            // Set current date and time
            const now = new Date();
            const dateInput = document.getElementById('revenue-date');
            const timeInput = document.getElementById('revenue-time');

            // Format date as YYYY-MM-DD
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            dateInput.value = `${year}-${month}-${day}`;

            // Format time as HH:MM
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            timeInput.value = `${hours}:${minutes}`;
        }

        function closeAddRevenueModal() {
            const modal = document.getElementById('add-revenue-modal');
            modal.style.display = 'none';
            document.getElementById('add-revenue-form').reset();
        }

        // Action Menu Functions
        let currentEditRow = null;
        let currentDeleteRow = null;

        function toggleActionMenu(button) {
            // Close all other open menus
            document.querySelectorAll('.action-menu.open').forEach(menu => {
                if (menu !== button.parentElement) {
                    menu.classList.remove('open');
                }
            });
            // Toggle current menu
            button.parentElement.classList.toggle('open');
        }

        // Close action menus when clicking outside
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.action-menu')) {
                document.querySelectorAll('.action-menu.open').forEach(menu => {
                    menu.classList.remove('open');
                });
            }
        });

        // Edit Revenue Entry
        function editRevenueEntry(button) {
            const row = button.closest('tr');
            currentEditRow = row;

            // Get data from row
            const cells = row.querySelectorAll('td');
            const dateText = cells[0].querySelector('div').textContent;
            const timeText = cells[0].querySelectorAll('div')[1].textContent;
            const txnId = cells[1].querySelector('code').textContent;
            const plan = cells[2].querySelector('strong').textContent;
            const country = cells[3].textContent.trim();
            const amount = cells[4].querySelector('strong').textContent.replace('$', '').replace(',', '');
            const source = cells[5].querySelector('span').textContent;

            // Parse date (e.g., "Jan 24, 2026" to "2026-01-24")
            const dateParts = dateText.match(/(\w+)\s+(\d+),\s+(\d+)/);
            if (dateParts) {
                const months = { Jan: '01', Feb: '02', Mar: '03', Apr: '04', May: '05', Jun: '06', Jul: '07', Aug: '08', Sep: '09', Oct: '10', Nov: '11', Dec: '12' };
                const formattedDate = `${dateParts[3]}-${months[dateParts[1]]}-${dateParts[2].padStart(2, '0')}`;
                document.getElementById('edit-revenue-date').value = formattedDate;
            }

            // Parse time (e.g., "3:45 PM" to "15:45")
            const timeParts = timeText.match(/(\d+):(\d+)\s*(AM|PM)/i);
            if (timeParts) {
                let hours = parseInt(timeParts[1]);
                if (timeParts[3].toUpperCase() === 'PM' && hours !== 12) hours += 12;
                if (timeParts[3].toUpperCase() === 'AM' && hours === 12) hours = 0;
                document.getElementById('edit-revenue-time').value = `${String(hours).padStart(2, '0')}:${timeParts[2]}`;
            }

            document.getElementById('edit-revenue-txn-id').value = txnId;
            document.getElementById('edit-revenue-plan').value = plan;
            document.getElementById('edit-revenue-country').value = country;
            document.getElementById('edit-revenue-amount').value = parseFloat(amount);
            document.getElementById('edit-revenue-source').value = source;

            // Close action menu and show modal
            button.closest('.action-menu').classList.remove('open');
            document.getElementById('edit-revenue-modal').style.display = 'flex';
        }

        function closeEditRevenueModal() {
            document.getElementById('edit-revenue-modal').style.display = 'none';
            document.getElementById('edit-revenue-form').reset();
            currentEditRow = null;
        }

        // Delete Entry
        function confirmDeleteEntry(button) {
            const row = button.closest('tr');
            currentDeleteRow = row;

            const txnId = row.querySelectorAll('td')[1].querySelector('code').textContent;
            const plan = row.querySelectorAll('td')[2].querySelector('strong').textContent;

            document.getElementById('delete-entry-info').innerHTML = `<strong>${plan}</strong><br><span style="font-size: 12px; color: var(--text-secondary);">${txnId}</span>`;

            // Close action menu and show modal
            button.closest('.action-menu').classList.remove('open');
            document.getElementById('delete-confirm-modal').style.display = 'flex';
        }

        function closeDeleteModal() {
            document.getElementById('delete-confirm-modal').style.display = 'none';
            currentDeleteRow = null;
        }

        function deleteEntry() {
            if (currentDeleteRow) {
                currentDeleteRow.remove();
                closeDeleteModal();
                // Update entry count (optional)
                const countSpan = document.querySelector('#pabbly-revenue-section .table-header .count');
                if (countSpan) {
                    const currentCount = parseInt(countSpan.textContent) || 23;
                    countSpan.textContent = `${currentCount - 1} Entries`;
                }
            }
        }

        // ==================== LEAD MANAGEMENT FUNCTIONS ====================
        let currentEditLeadRow = null;
        let currentDeleteLeadRow = null;

        function openAddLeadModal() {
            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('lead-date').value = today;
            document.getElementById('lead-count').value = '';
            document.getElementById('lead-source').value = '';
            document.getElementById('add-lead-modal').style.display = 'flex';
        }

        function closeAddLeadModal() {
            document.getElementById('add-lead-modal').style.display = 'none';
        }

        function addLeadEntry() {
            const date = document.getElementById('lead-date').value;
            const count = document.getElementById('lead-count').value;
            const source = document.getElementById('lead-source').value;

            if (!date || !count || !source) {
                alert('Please fill in all required fields');
                return;
            }

            // Format date
            const dateObj = new Date(date);
            const formattedDate = dateObj.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });

            // Create new row
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td>${formattedDate}</td>
                <td><strong>${count}</strong></td>
                <td>
                    <div class="action-menu">
                        <button class="action-menu-btn" onclick="toggleActionMenu(this)">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                        <div class="action-menu-dropdown">
                            <button class="action-menu-item" onclick="editLeadEntry(this)"><i class="fas fa-edit"></i> Edit</button>
                            <button class="action-menu-item delete" onclick="confirmDeleteLead(this)"><i class="fas fa-trash"></i> Delete</button>
                        </div>
                    </div>
                </td>
            `;

            // Add to top of table
            const tbody = document.getElementById('leads-tbody');
            tbody.insertBefore(newRow, tbody.firstChild);

            // Update lead count
            const countSpan = document.querySelector('#leads-data-section .table-header .count');
            if (countSpan) {
                const currentCount = parseInt(countSpan.textContent) || 156;
                countSpan.textContent = `${currentCount + 1} Leads`;
            }

            closeAddLeadModal();
        }

        function editLeadEntry(button) {
            const row = button.closest('tr');
            currentEditLeadRow = row;

            // Close the action menu
            button.closest('.action-menu').classList.remove('open');

            // Get current values from the row
            const cells = row.querySelectorAll('td');
            const dateText = cells[0].textContent.trim();
            const count = cells[1].textContent.trim();

            // Parse date to input format
            const dateObj = new Date(dateText);
            const formattedDate = dateObj.toISOString().split('T')[0];

            // Populate the edit form
            document.getElementById('edit-lead-date').value = formattedDate;
            document.getElementById('edit-lead-count').value = count;

            // Show the edit modal
            document.getElementById('edit-lead-modal').style.display = 'flex';
        }

        function closeEditLeadModal() {
            document.getElementById('edit-lead-modal').style.display = 'none';
            currentEditLeadRow = null;
        }

        function saveLeadEntry() {
            if (!currentEditLeadRow) return;

            const date = document.getElementById('edit-lead-date').value;
            const count = document.getElementById('edit-lead-count').value;

            if (!date || !count) {
                alert('Please fill in all required fields');
                return;
            }

            // Format date
            const dateObj = new Date(date);
            const formattedDate = dateObj.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });

            // Update the row
            const cells = currentEditLeadRow.querySelectorAll('td');
            cells[0].textContent = formattedDate;
            cells[1].innerHTML = `<strong>${count}</strong>`;

            closeEditLeadModal();
        }

        function confirmDeleteLead(button) {
            const row = button.closest('tr');
            currentDeleteLeadRow = row;

            // Close the action menu
            button.closest('.action-menu').classList.remove('open');

            // Show delete confirmation modal
            document.getElementById('delete-lead-modal').style.display = 'flex';
        }

        function closeDeleteLeadModal() {
            document.getElementById('delete-lead-modal').style.display = 'none';
            currentDeleteLeadRow = null;
        }

        function deleteLeadEntry() {
            if (currentDeleteLeadRow) {
                currentDeleteLeadRow.remove();
                closeDeleteLeadModal();
                // Update lead count
                const countSpan = document.querySelector('#leads-data-section .table-header .count');
                if (countSpan) {
                    const currentCount = parseInt(countSpan.textContent) || 156;
                    countSpan.textContent = `${currentCount - 1} Leads`;
                }
            }
        }

        // ==================== USER MANAGEMENT FUNCTIONS ====================
        let currentEditUserRow = null;

        function openAddUserModal() {
            document.getElementById('add-user-form').reset();
            updateAccessStyle();
            document.getElementById('add-user-modal').style.display = 'flex';
        }

        function closeAddUserModal() {
            document.getElementById('add-user-modal').style.display = 'none';
        }

        function toggleAllPages(selectAllCb) {
            document.querySelectorAll('input[name="page-access"]').forEach(cb => { cb.checked = selectAllCb.checked; });
        }
        function toggleAllEditPages(selectAllCb) {
            document.querySelectorAll('input[name="edit-page-access"]').forEach(cb => { cb.checked = selectAllCb.checked; });
        }

        function updateAccessStyle() {
            const fullRadio = document.querySelector('input[name="access-type"][value="full"]');
            const readRadio = document.querySelector('input[name="access-type"][value="read"]');
            document.getElementById('access-full-label').style.borderColor = fullRadio.checked ? 'var(--primary-color)' : 'var(--border-color)';
            document.getElementById('access-read-label').style.borderColor = readRadio.checked ? 'var(--primary-color)' : 'var(--border-color)';
        }

        function updateEditAccessStyle() {
            const fullRadio = document.querySelector('input[name="edit-access-type"][value="full"]');
            const readRadio = document.querySelector('input[name="edit-access-type"][value="read"]');
            document.getElementById('edit-access-full-label').style.borderColor = fullRadio.checked ? 'var(--primary-color)' : 'var(--border-color)';
            document.getElementById('edit-access-read-label').style.borderColor = readRadio.checked ? 'var(--primary-color)' : 'var(--border-color)';
        }

        function getInitials(first, last) {
            return (first.charAt(0) + last.charAt(0)).toUpperCase();
        }

        function getRandomColor() {
            const colors = ['#6366f1', '#f59e0b', '#10b981', '#ef4444', '#8b5cf6', '#ec4899', '#14b8a6'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        function submitAddUser(e) {
            e.preventDefault();
            const firstName = document.getElementById('user-first-name').value.trim();
            const lastName = document.getElementById('user-last-name').value.trim();
            const email = document.getElementById('user-email').value.trim();
            const accessType = document.querySelector('input[name="access-type"]:checked').value;
            const accounts = Array.from(document.querySelectorAll('input[name="ad-accounts"]:checked')).map(cb => cb.value);
            const pages = Array.from(document.querySelectorAll('input[name="page-access"]:checked')).map(cb => cb.value);

            if (accounts.length === 0) {
                alert('Please select at least one ad account.');
                return;
            }
            if (pages.length === 0) {
                alert('Please select at least one page.');
                return;
            }

            const initials = getInitials(firstName, lastName);
            const color = getRandomColor();
            const fullName = firstName + ' ' + lastName;
            const isFullAccess = accessType === 'full';
            const badgeHtml = isFullAccess
                ? '<span class="status-badge active">Full Access</span>'
                : '<span class="status-badge" style="background: #f0f2f5; color: var(--text-secondary);">Read Access</span>';

            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="width: 36px; height: 36px; border-radius: 50%; background: ${color}; color: white; display: flex; align-items: center; justify-content: center; font-weight: 600;">${initials}</div>
                        <div><div style="font-weight: 600;">${fullName}</div></div>
                    </div>
                </td>
                <td>${email}</td>
                <td>${badgeHtml}</td>
                <td>${accounts.join(', ')}</td>
                <td><span style="font-size: 12px; color: var(--text-secondary);">${pages.length === 9 ? 'All Pages' : pages.join(', ')}</span></td>
                <td>Just now</td>
                <td>
                    <div class="action-menu">
                        <button class="action-menu-btn" onclick="toggleActionMenu(this)"><i class="fas fa-ellipsis-v"></i></button>
                        <div class="action-menu-dropdown">
                            <button class="action-menu-item" onclick="editUser(this)"><i class="fas fa-edit"></i> Edit</button>
                            <button class="action-menu-item delete" onclick="removeUser(this)"><i class="fas fa-trash"></i> Remove</button>
                        </div>
                    </div>
                </td>
            `;

            document.getElementById('users-tbody').appendChild(newRow);
            closeAddUserModal();
        }

        function editUser(button) {
            const row = button.closest('tr');
            currentEditUserRow = row;
            button.closest('.action-menu').classList.remove('open');

            const cells = row.querySelectorAll('td');
            const nameEl = cells[0].querySelector('div[style*="font-weight: 600"]');
            const fullName = nameEl ? nameEl.textContent.trim() : '';
            const parts = fullName.split(' ');
            const firstName = parts[0] || '';
            const lastName = parts.slice(1).join(' ') || '';
            const email = cells[1].textContent.trim();
            const accessBadge = cells[2].querySelector('.status-badge').textContent.trim();
            const accountsText = cells[3].textContent.trim();

            document.getElementById('edit-user-first-name').value = firstName;
            document.getElementById('edit-user-last-name').value = lastName;
            document.getElementById('edit-user-email').value = email;

            const isFullAccess = accessBadge === 'Full Access';
            document.querySelector('input[name="edit-access-type"][value="full"]').checked = isFullAccess;
            document.querySelector('input[name="edit-access-type"][value="read"]').checked = !isFullAccess;
            updateEditAccessStyle();

            const accountsList = accountsText.split(',').map(a => a.trim());
            document.querySelectorAll('input[name="edit-ad-accounts"]').forEach(cb => {
                cb.checked = accountsList.includes(cb.value);
            });

            // Parse page access from cell index 4
            const pagesText = cells[4].textContent.trim();
            const allPageValues = ['Overview Metrics','Campaigns','Ad Sets','Ads','Country Performance','Sales by Ad Creative','Alerts','Data Management','Settings'];
            const pagesList = pagesText === 'All Pages' ? allPageValues : pagesText.split(',').map(p => p.trim());
            document.querySelectorAll('input[name="edit-page-access"]').forEach(cb => {
                cb.checked = pagesList.includes(cb.value);
            });
            const editSelectAll = document.getElementById('edit-page-select-all');
            if (editSelectAll) editSelectAll.checked = pagesList.length === allPageValues.length;

            document.getElementById('edit-user-modal').style.display = 'flex';
        }

        function closeEditUserModal() {
            document.getElementById('edit-user-modal').style.display = 'none';
            currentEditUserRow = null;
        }

        function submitEditUser(e) {
            e.preventDefault();
            if (!currentEditUserRow) return;

            const firstName = document.getElementById('edit-user-first-name').value.trim();
            const lastName = document.getElementById('edit-user-last-name').value.trim();
            const accessType = document.querySelector('input[name="edit-access-type"]:checked').value;
            const accounts = Array.from(document.querySelectorAll('input[name="edit-ad-accounts"]:checked')).map(cb => cb.value);
            const pages = Array.from(document.querySelectorAll('input[name="edit-page-access"]:checked')).map(cb => cb.value);

            if (accounts.length === 0) {
                alert('Please select at least one ad account.');
                return;
            }
            if (pages.length === 0) {
                alert('Please select at least one page.');
                return;
            }

            const cells = currentEditUserRow.querySelectorAll('td');
            const fullName = firstName + ' ' + lastName;
            const initials = getInitials(firstName, lastName);
            const isFullAccess = accessType === 'full';

            // Update name
            const nameContainer = cells[0].querySelector('div[style*="font-weight: 600"]');
            if (nameContainer) nameContainer.textContent = fullName;
            const initialsEl = cells[0].querySelector('div[style*="border-radius: 50%"]');
            if (initialsEl) initialsEl.textContent = initials;

            // Update access badge
            cells[2].innerHTML = isFullAccess
                ? '<span class="status-badge active">Full Access</span>'
                : '<span class="status-badge" style="background: #f0f2f5; color: var(--text-secondary);">Read Access</span>';

            // Update accounts
            cells[3].textContent = accounts.join(', ');

            // Update page access
            cells[4].innerHTML = '<span style="font-size: 12px; color: var(--text-secondary);">' + (pages.length === 9 ? 'All Pages' : pages.join(', ')) + '</span>';

            closeEditUserModal();
        }

        function removeUser(button) {
            const row = button.closest('tr');
            button.closest('.action-menu').classList.remove('open');
            if (confirm('Are you sure you want to remove this user?')) {
                row.remove();
            }
        }

        // ==================== FREQUENCY ALERT FUNCTIONS ====================

        // Update the frequency alert rule text in the table when threshold changes
        document.getElementById('frequency-threshold-value').addEventListener('input', function() {
            const val = this.value;
            const ruleCell = this.closest('tr').querySelector('td:last-child');
            if (ruleCell) {
                ruleCell.textContent = 'If frequency > ' + val + ', trigger alert';
            }
        });

        // Check frequency and create alerts (called by monitoring system or manually)
        function checkFrequencyAlerts() {
            const threshold = parseFloat(document.getElementById('frequency-threshold-value').value) || 3;

            // Simulated frequency data from ad accounts
            const frequencyData = [
                { name: 'India - Growth', frequency: 4.2, spend: '$1,200', level: 'Ad Set' },
                { name: 'EU - Subscription Q1', frequency: 3.8, spend: '$890', level: 'Ad Set' },
                { name: 'Video Ad v3 - Feature Demo', frequency: 5.1, spend: '$650', level: 'Ad' }
            ];

            const triggered = frequencyData.filter(item => item.frequency > threshold);

            if (triggered.length === 0) return;

            // Add each triggered item as an alert
            const taskList = document.querySelector('#needs-action .task-list');
            if (!taskList) return;

            triggered.forEach(item => {
                const alertId = 'freq-' + Date.now() + '-' + Math.random().toString(36).substr(2, 5);
                const taskItem = document.createElement('div');
                taskItem.className = 'task-item';
                taskItem.setAttribute('data-task-id', alertId);
                taskItem.innerHTML = `
                    <div class="task-item-header" onclick="toggleTask(this)">
                        <span class="task-priority warning">Warning</span>
                        <div class="task-info">
                            <div class="task-title">
                                ${item.name}
                                <span class="task-type">${item.level}</span>
                            </div>
                            <div class="task-meta">
                                <span><i class="fas fa-redo-alt"></i> High Frequency (${item.frequency.toFixed(1)}) - Threshold: ${threshold}</span>
                                <span><i class="fas fa-clock"></i> Just now</span>
                            </div>
                        </div>
                        <div class="task-metrics">
                            <div class="task-metric">
                                <div class="task-metric-label">Frequency</div>
                                <div class="task-metric-value" style="color: #f59e0b;">${item.frequency.toFixed(1)}</div>
                            </div>
                            <div class="task-metric">
                                <div class="task-metric-label">Spend</div>
                                <div class="task-metric-value">${item.spend}</div>
                            </div>
                        </div>
                        <select class="task-status-select" onclick="event.stopPropagation()">
                            <option value="open" selected>Open</option>
                            <option value="on-hold">On Hold</option>
                            <option value="resolved">Resolved</option>
                        </select>
                        <button class="task-expand-btn">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div class="task-details">
                        <div class="task-details-grid">
                            <div class="task-detail-section">
                                <h4>Frequency Details</h4>
                                <div class="task-threshold-info">
                                    <div class="task-threshold-row">
                                        <span>Frequency Threshold</span>
                                        <span><strong>${threshold}</strong></span>
                                    </div>
                                    <div class="task-threshold-row">
                                        <span>Current Frequency</span>
                                        <span style="color: #f59e0b;"><strong>${item.frequency.toFixed(1)}</strong></span>
                                    </div>
                                    <div class="task-threshold-row">
                                        <span>Total Spend</span>
                                        <span><strong>${item.spend}</strong></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                taskList.insertBefore(taskItem, taskList.firstChild);
            });

            // Update counts
            const needsActionTab = document.querySelector('.task-tab.active .tab-count');
            if (needsActionTab) {
                needsActionTab.textContent = parseInt(needsActionTab.textContent || 0) + triggered.length;
            }
            const alertsHeader = document.querySelector('#alerts-section .table-header .count');
            if (alertsHeader) {
                const current = parseInt(alertsHeader.textContent) || 0;
                alertsHeader.textContent = (current + triggered.length) + ' Open';
            }
            const bellBadge = document.querySelector('.notification-badge');
            if (bellBadge) {
                bellBadge.textContent = parseInt(bellBadge.textContent || 0) + triggered.length;
            }
            const viewAlertsBtn = document.querySelector('#alert-thresholds-section .btn-primary[onclick*="alerts-section"]');
            if (viewAlertsBtn) {
                const current = parseInt(viewAlertsBtn.textContent.match(/\d+/)?.[0] || 0);
                viewAlertsBtn.innerHTML = '<i class="fas fa-bell"></i> View Active Alerts (' + (current + triggered.length) + ')';
            }

            // Toast notification
            const toast = document.createElement('div');
            toast.style.cssText = 'position: fixed; top: 24px; right: 24px; z-index: 9999; background: #f59e0b; color: white; padding: 16px 20px; border-radius: 10px; box-shadow: 0 8px 24px rgba(0,0,0,0.2); display: flex; align-items: center; gap: 12px; font-size: 14px; max-width: 400px; animation: slideInRight 0.3s ease;';
            toast.innerHTML = `
                <i class="fas fa-exclamation-triangle" style="font-size: 20px;"></i>
                <div>
                    <div style="font-weight: 600;">Frequency Alert</div>
                    <div style="font-size: 12px; margin-top: 2px; opacity: 0.9;">${triggered.length} item(s) exceeded frequency of ${threshold}.</div>
                </div>
                <button onclick="this.parentElement.remove()" style="background: none; border: none; color: white; font-size: 18px; cursor: pointer; margin-left: 8px;">&times;</button>
            `;
            document.body.appendChild(toast);
            setTimeout(() => { if (toast.parentElement) { toast.style.opacity = '0'; toast.style.transition = 'opacity 0.3s'; setTimeout(() => toast.remove(), 300); } }, 6000);
        }

        function saveAlertSettings() {
            // Run frequency check with current threshold
            checkFrequencyAlerts();

            // Show save confirmation
            const toast = document.createElement('div');
            toast.style.cssText = 'position: fixed; top: 24px; right: 24px; z-index: 9999; background: #16a34a; color: white; padding: 16px 20px; border-radius: 10px; box-shadow: 0 8px 24px rgba(0,0,0,0.2); display: flex; align-items: center; gap: 12px; font-size: 14px; max-width: 400px; animation: slideInRight 0.3s ease;';
            toast.innerHTML = `
                <i class="fas fa-check-circle" style="font-size: 20px;"></i>
                <div>
                    <div style="font-weight: 600;">Settings Saved</div>
                    <div style="font-size: 12px; margin-top: 2px; opacity: 0.9;">Alert & budget settings have been saved successfully.</div>
                </div>
                <button onclick="this.parentElement.remove()" style="background: none; border: none; color: white; font-size: 18px; cursor: pointer; margin-left: 8px;">&times;</button>
            `;
            document.body.appendChild(toast);
            setTimeout(() => { if (toast.parentElement) { toast.style.opacity = '0'; toast.style.transition = 'opacity 0.3s'; setTimeout(() => toast.remove(), 300); } }, 4000);
        }

        // ==================== WEBHOOK MANAGEMENT FUNCTIONS ====================

        // Switch between Webhooks and API tabs
        function switchWebhookTab(tab) {
            const webhooksTab = document.getElementById('webhooks-tab');
            const apiTab = document.getElementById('api-tab');
            const tabButtons = document.querySelectorAll('#webhooks-section .tab-btn');
            const addBtn = document.getElementById('add-webhook-btn');

            if (tab === 'webhooks') {
                webhooksTab.classList.add('active');
                apiTab.classList.remove('active');
                tabButtons[0].classList.add('active');
                tabButtons[1].classList.remove('active');
                if (addBtn) addBtn.style.display = 'flex';
            } else {
                webhooksTab.classList.remove('active');
                apiTab.classList.add('active');
                tabButtons[0].classList.remove('active');
                tabButtons[1].classList.add('active');
                if (addBtn) addBtn.style.display = 'none';
            }
        }

        // Show webhook form
        function showWebhookForm() {
            editingWebhookId = null;
            document.getElementById('webhook-form-area').style.display = 'block';
            document.getElementById('webhook-form-title').textContent = 'Add Webhook';
            document.getElementById('webhook-name').value = '';
            document.getElementById('webhook-url').value = '';
            document.querySelectorAll('.webhook-trigger').forEach(cb => cb.checked = false);
        }

        // Cancel webhook form
        function cancelWebhookForm() {
            document.getElementById('webhook-form-area').style.display = 'none';
            editingWebhookId = null;
        }

        // Save webhook
        function saveWebhookSimple() {
            const name = document.getElementById('webhook-name').value.trim();
            const url = document.getElementById('webhook-url').value.trim();
            const triggers = Array.from(document.querySelectorAll('.webhook-trigger:checked')).map(cb => cb.value);

            if (!name || !url) {
                alert('Please fill in Webhook Name and URL.');
                return;
            }
            if (triggers.length === 0) {
                alert('Please select at least one trigger.');
                return;
            }

            if (editingWebhookId) {
                const wh = savedWebhooks.find(w => w.id === editingWebhookId);
                if (wh) { wh.name = name; wh.url = url; wh.triggers = triggers; }
            } else {
                savedWebhooks.push({ id: 'wh_' + Date.now(), name, url, triggers });
            }

            editingWebhookId = null;
            document.getElementById('webhook-form-area').style.display = 'none';
            renderWebhooksList();
        }

        // Save and send test
        function saveAndTestWebhook() {
            const name = document.getElementById('webhook-name').value.trim();
            const url = document.getElementById('webhook-url').value.trim();
            const triggers = Array.from(document.querySelectorAll('.webhook-trigger:checked')).map(cb => cb.value);

            if (!name || !url) {
                alert('Please fill in Webhook Name and URL.');
                return;
            }
            if (triggers.length === 0) {
                alert('Please select at least one trigger.');
                return;
            }

            let whId;
            if (editingWebhookId) {
                whId = editingWebhookId;
                const wh = savedWebhooks.find(w => w.id === editingWebhookId);
                if (wh) { wh.name = name; wh.url = url; wh.triggers = triggers; }
            } else {
                whId = 'wh_' + Date.now();
                savedWebhooks.push({ id: whId, name, url, triggers });
            }

            editingWebhookId = null;
            document.getElementById('webhook-form-area').style.display = 'none';
            renderWebhooksList();

            // Send test immediately
            sendTestWebhook(whId);
        }

        // Render all saved webhook cards
        function renderWebhooksList() {
            const container = document.getElementById('webhooks-list');
            const emptyState = document.getElementById('webhooks-empty');
            if (!container) return;

            if (savedWebhooks.length === 0) {
                container.innerHTML = '';
                if (emptyState) emptyState.style.display = 'block';
                return;
            }
            if (emptyState) emptyState.style.display = 'none';

            container.innerHTML = savedWebhooks.map(wh => `
                <div id="wh-card-${wh.id}" style="border: 1px solid var(--border-color); border-radius: 8px; padding: 14px 16px; margin-bottom: 10px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="width: 8px; height: 8px; border-radius: 50%; background: var(--success-color); flex-shrink: 0;"></span>
                            <strong style="font-size: 13px;">${wh.name}</strong>
                        </div>
                        <div style="display: flex; gap: 6px;">
                            <button onclick="sendTestWebhook('${wh.id}')" style="padding: 4px 10px; background: white; border: 1px solid var(--border-color); border-radius: 5px; cursor: pointer; font-size: 11px; display: flex; align-items: center; gap: 4px; color: var(--primary-color);">
                                <i class="fas fa-paper-plane"></i> Test
                            </button>
                            <button onclick="editWebhookById('${wh.id}')" style="padding: 4px 10px; border: 1px solid var(--border-color); background: white; border-radius: 5px; cursor: pointer; font-size: 11px;">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button onclick="deleteWebhookById('${wh.id}')" style="padding: 4px 10px; border: 1px solid #fecaca; background: #fef2f2; color: #dc2626; border-radius: 5px; cursor: pointer; font-size: 11px;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <code style="font-size: 11px; color: var(--text-secondary); word-break: break-all; display: block; margin-bottom: 8px;">${wh.url}</code>
                    <div style="display: flex; flex-wrap: wrap; gap: 4px; align-items: center;">
                        ${wh.triggers.map(t => `<span style="display: inline-block; padding: 2px 8px; background: #e7f3ff; color: var(--primary-color); border-radius: 10px; font-size: 11px; font-weight: 500;">${triggerLabels[t] || t}</span>`).join('')}
                        <span id="test-status-${wh.id}" style="font-size: 11px; color: var(--text-secondary); margin-left: 4px;"></span>
                    </div>
                </div>
            `).join('');
        }

        // Edit webhook by ID
        function editWebhookById(id) {
            const wh = savedWebhooks.find(w => w.id === id);
            if (!wh) return;
            editingWebhookId = id;
            document.getElementById('webhook-form-area').style.display = 'block';
            document.getElementById('webhook-form-title').textContent = 'Edit Webhook';
            document.getElementById('webhook-name').value = wh.name;
            document.getElementById('webhook-url').value = wh.url;
            document.querySelectorAll('.webhook-trigger').forEach(cb => {
                cb.checked = wh.triggers.includes(cb.value);
            });
            // Scroll to form
            document.getElementById('webhook-form-area').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Delete webhook by ID
        function deleteWebhookById(id) {
            if (confirm('Are you sure you want to delete this webhook?')) {
                savedWebhooks = savedWebhooks.filter(w => w.id !== id);
                renderWebhooksList();
            }
        }

        // Send test webhook data
        function sendTestWebhook(id) {
            const wh = savedWebhooks.find(w => w.id === id);
            if (!wh) return;

            const statusEl = document.getElementById('test-status-' + id);
            if (statusEl) {
                statusEl.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
            }

            const testData = {
                event: 'test',
                timestamp: new Date().toISOString(),
                account: currentAccount,
                webhook_name: wh.name,
                message: 'This is a test webhook from Facebook Ads Dashboard',
                sample_data: {
                    campaign: 'USA - Lifetime Deal',
                    ad_spend: '$336.00',
                    revenue: '$1,999.00',
                    roas: 5.94,
                    leads: 39,
                    sale_amount: '$700.00',
                    customer_email: 'john@example.com',
                    alert_type: 'overspending',
                    pixel_status: 'active'
                },
                triggers_enabled: wh.triggers
            };

            console.log('Test webhook sent to:', wh.url);
            console.log('Payload:', JSON.stringify(testData, null, 2));

            setTimeout(() => {
                if (statusEl) {
                    statusEl.innerHTML = '<i class="fas fa-check-circle" style="color: var(--success-color);"></i> <span style="color: var(--success-color);">Test data sent successfully!</span>';
                    setTimeout(() => { statusEl.innerHTML = ''; }, 4000);
                }
            }, 1000);
        }

        // Copy API Key
        function copyApiKey() {
            const apiKey = document.getElementById('api-key-display').value;
            navigator.clipboard.writeText(apiKey).then(() => {
                const btn = event.currentTarget;
                btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                setTimeout(() => { btn.innerHTML = '<i class="fas fa-copy"></i> Copy'; }, 2000);
            });
        }

        function toggleApiKeyVisibility() {
            const input = document.getElementById('api-key-display');
            const btn = document.getElementById('api-key-toggle-btn');
            if (input.type === 'password') {
                input.type = 'text';
                btn.innerHTML = '<i class="fas fa-eye-slash"></i>';
            } else {
                input.type = 'password';
                btn.innerHTML = '<i class="fas fa-eye"></i>';
            }
        }

        function regenerateApiKey() {
            if (!confirm('Are you sure you want to regenerate your API key? The current key will stop working immediately.')) return;
            const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
            let newKey = 'dbk_demo_';
            for (let i = 0; i < 24; i++) newKey += chars.charAt(Math.floor(Math.random() * chars.length));
            document.getElementById('api-key-display').value = newKey;
            document.getElementById('api-key-display').type = 'password';
            document.getElementById('api-key-toggle-btn').innerHTML = '<i class="fas fa-eye"></i>';
        }

        // Render webhooks on page load
        function renderWebhooks() {
            renderWebhooksList();
        }

        // Close modals on Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeAddRevenueModal();
                closeEditRevenueModal();
                closeDeleteModal();
                closeAddLeadModal();
                closeEditLeadModal();
                closeDeleteLeadModal();
                cancelWebhookForm();
            }
        });

        // Table sorting functionality
        document.querySelectorAll('.data-table th').forEach(header => {
            header.addEventListener('click', function() {
                const table = this.closest('table');
                const tbody = table.querySelector('tbody');
                const rows = Array.from(tbody.querySelectorAll('tr'));
                const index = Array.from(this.parentNode.children).indexOf(this);
                const isAscending = this.classList.contains('sorted-asc');

                // Remove sorted class from all headers
                table.querySelectorAll('th').forEach(th => {
                    th.classList.remove('sorted', 'sorted-asc', 'sorted-desc');
                });

                // Sort rows
                rows.sort((a, b) => {
                    const aValue = a.children[index].textContent.trim();
                    const bValue = b.children[index].textContent.trim();

                    // Try to parse as number
                    const aNum = parseFloat(aValue.replace(/[$,]/g, ''));
                    const bNum = parseFloat(bValue.replace(/[$,]/g, ''));

                    if (!isNaN(aNum) && !isNaN(bNum)) {
                        return isAscending ? aNum - bNum : bNum - aNum;
                    }

                    return isAscending ? aValue.localeCompare(bValue) : bValue.localeCompare(aValue);
                });

                // Update header class
                this.classList.add('sorted');
                this.classList.add(isAscending ? 'sorted-desc' : 'sorted-asc');

                // Update sort icon
                const icon = this.querySelector('.sort-icon');
                if (icon) {
                    icon.className = 'fas sort-icon ' + (isAscending ? 'fa-sort-up' : 'fa-sort-down');
                }

                // Reorder rows
                rows.forEach(row => tbody.appendChild(row));
            });
        });


        // Filter change handler for Campaigns table
        document.getElementById('campaigns-status-filter').addEventListener('change', function() {
            campaignsStatusFilter = this.value;
            updateFilterColor(this);
            applyCampaignsFilter();
        });

        // Filter change handler for Ad Sets table
        document.getElementById('adsets-status-filter').addEventListener('change', function() {
            adSetsStatusFilter = this.value;
            updateFilterColor(this);
            applyAdSetsFilter();
        });

        // Campaign filter for Ad Sets table
        document.getElementById('adsets-campaign-filter').addEventListener('change', function() {
            adSetsCampaignFilter = this.value;
            applyAdSetsFilter();
        });

        // Filter change handler for Ads table
        document.getElementById('ads-status-filter').addEventListener('change', function() {
            adsStatusFilter = this.value;
            updateFilterColor(this);
            applyAdsFilter();
        });

        // Campaign filter for Ads table
        document.getElementById('ads-campaign-filter').addEventListener('change', function() {
            adsCampaignFilter = this.value;
            adsAdSetFilter = 'all';
            populateAdsAdSetDropdown();
            applyAdsFilter();
        });

        // Ad Set filter for Ads table
        document.getElementById('ads-adset-filter').addEventListener('change', function() {
            adsAdSetFilter = this.value;
            applyAdsFilter();
        });

        // Search inputs
        document.getElementById('campaigns-search').addEventListener('input', function() {
            campaignsSearchQuery = this.value.toLowerCase().trim();
            applyCampaignsFilter();
        });

        document.getElementById('adsets-search').addEventListener('input', function() {
            adSetsSearchQuery = this.value.toLowerCase().trim();
            applyAdSetsFilter();
        });

        document.getElementById('ads-search').addEventListener('input', function() {
            adsSearchQuery = this.value.toLowerCase().trim();
            applyAdsFilter();
        });

        document.getElementById('country-search').addEventListener('input', function() {
            countrySearchQuery = this.value.toLowerCase().trim();
            applyCountryFilter();
        });

        document.getElementById('sales-creative-search').addEventListener('input', function() {
            salesCreativeSearchQuery = this.value.toLowerCase().trim();
            applySalesCreativeFilter();
        });

        // Sales Data (Revenue) search
        document.getElementById('revenue-search').addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();
            const rows = document.querySelectorAll('#revenue-transactions-tbody tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(query) ? '' : 'none';
            });
        });

        // Leads Data search
        document.getElementById('leads-search').addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();
            const rows = document.querySelectorAll('#leads-tbody tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(query) ? '' : 'none';
            });
        });

        // Update filter dropdown color based on selected value
        function updateFilterColor(selectElement) {
            selectElement.classList.remove('filter-active', 'filter-paused', 'filter-all');
            selectElement.classList.add('filter-' + selectElement.value);
        }

        // Apply Campaigns filter
        function applyCampaignsFilter() {
            const data = accountData[currentAccount];
            let filteredCampaigns = filterByStatus(data.campaigns, campaignsStatusFilter);
            if (campaignsSearchQuery) {
                filteredCampaigns = filteredCampaigns.filter(c => c.name.toLowerCase().includes(campaignsSearchQuery));
            }
            updateCampaignsTable(filteredCampaigns);
            updateTableCount('#campaigns-section', filteredCampaigns.length, campaignsStatusFilter);
        }

        // Apply Ad Sets filter
        function applyAdSetsFilter() {
            const data = accountData[currentAccount];
            let filteredAdSets = filterByStatus(data.adSets, adSetsStatusFilter);
            if (adSetsCampaignFilter !== 'all') {
                filteredAdSets = filteredAdSets.filter(a => a.campaignName === adSetsCampaignFilter);
            }
            if (adSetsSearchQuery) {
                filteredAdSets = filteredAdSets.filter(a => a.name.toLowerCase().includes(adSetsSearchQuery));
            }
            updateAdSetsTable(filteredAdSets);
            updateTableCount('#adsets-section', filteredAdSets.length, adSetsStatusFilter);
        }

        // Apply Ads filter
        function applyAdsFilter() {
            const data = accountData[currentAccount];
            let filteredAds = filterByStatus(data.ads, adsStatusFilter);
            if (adsCampaignFilter !== 'all') {
                filteredAds = filteredAds.filter(a => a.campaignName === adsCampaignFilter);
            }
            if (adsAdSetFilter !== 'all') {
                filteredAds = filteredAds.filter(a => a.adSetName === adsAdSetFilter);
            }
            if (adsSearchQuery) {
                filteredAds = filteredAds.filter(a => a.name.toLowerCase().includes(adsSearchQuery));
            }
            updateAdsTable(filteredAds);
            updateTableCount('#ads-section', filteredAds.length, adsStatusFilter);
        }

        // Filter data by status
        function filterByStatus(items, filter) {
            if (filter === 'all') {
                return items;
            }
            return items.filter(item => item.status.toLowerCase() === filter);
        }

        // Populate campaign/ad set filter dropdowns
        function populateFilterDropdowns() {
            const data = accountData[currentAccount];
            const campaignNames = [...new Set(data.campaigns.map(c => c.name))];
            const adSetNames = [...new Set(data.adSets.map(a => a.name))];

            // Ad Sets page &#8212; campaign filter
            const adSetsCampaignEl = document.getElementById('adsets-campaign-filter');
            if (adSetsCampaignEl) {
                adSetsCampaignEl.innerHTML = '<option value="all">All Campaigns</option>' +
                    campaignNames.map(n => `<option value="${n}">${n}</option>`).join('');
                adSetsCampaignEl.value = adSetsCampaignFilter;
            }

            // Ads page &#8212; campaign filter
            const adsCampaignEl = document.getElementById('ads-campaign-filter');
            if (adsCampaignEl) {
                adsCampaignEl.innerHTML = '<option value="all">All Campaigns</option>' +
                    campaignNames.map(n => `<option value="${n}">${n}</option>`).join('');
                adsCampaignEl.value = adsCampaignFilter;
            }

            // Ads page &#8212; ad set filter (scoped to selected campaign)
            populateAdsAdSetDropdown();
        }

        function populateAdsAdSetDropdown() {
            const data = accountData[currentAccount];
            let adSetNames;
            if (adsCampaignFilter === 'all') {
                adSetNames = [...new Set(data.adSets.map(a => a.name))];
            } else {
                adSetNames = [...new Set(data.adSets.filter(a => a.campaignName === adsCampaignFilter).map(a => a.name))];
            }
            const adsAdSetEl = document.getElementById('ads-adset-filter');
            if (adsAdSetEl) {
                adsAdSetEl.innerHTML = '<option value="all">All Ad Sets</option>' +
                    adSetNames.map(n => `<option value="${n}">${n}</option>`).join('');
                adsAdSetEl.value = adsAdSetFilter;
            }
        }

        // Other filter change handlers (Time Range, etc.)
        document.querySelectorAll('.filter-select:not(#status-filter)').forEach(select => {
            select.addEventListener('change', function() {
                // In a real app, this would trigger a data refresh
                console.log('Filter changed:', this.value);
            });
        });

        // ========== AUTH SYSTEM ==========
        // Seed admin account if not present
        (function seedAdmin() {
            let users = JSON.parse(localStorage.getItem('fb_dash_users') || '[]');
            if (!users.find(u => u.email === 'admin@pabbly.com')) {
                users.push({ name: 'Admin', email: 'admin@pabbly.com', password: 'Admin@123' });
                localStorage.setItem('fb_dash_users', JSON.stringify(users));
            }
        })();

        function showLogin() {
            document.getElementById('login-form').style.display = 'block';
            document.getElementById('signup-form').style.display = 'none';
            document.querySelector('.auth-logo p').textContent = 'Sign in to your account';
        }

        function showSignup() {
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('signup-form').style.display = 'block';
            document.querySelector('.auth-logo p').textContent = 'Create a new account';
        }

        function handleLogin() {
            const email = document.getElementById('login-email').value.trim();
            const password = document.getElementById('login-password').value;
            const errorEl = document.getElementById('login-error');
            errorEl.style.display = 'none';

            if (!email || !password) {
                errorEl.textContent = 'Please fill in all fields.';
                errorEl.style.display = 'block';
                return;
            }

            const users = JSON.parse(localStorage.getItem('fb_dash_users') || '[]');
            const user = users.find(u => u.email === email && u.password === password);
            if (!user) {
                errorEl.textContent = 'Invalid email or password.';
                errorEl.style.display = 'block';
                return;
            }

            localStorage.setItem('fb_dash_session', JSON.stringify({ name: user.name, email: user.email }));
            showDashboard(user);
        }

        function handleSignup() {
            const name = document.getElementById('signup-name').value.trim();
            const email = document.getElementById('signup-email').value.trim();
            const password = document.getElementById('signup-password').value;
            const confirm = document.getElementById('signup-confirm').value;
            const errorEl = document.getElementById('signup-error');
            errorEl.style.display = 'none';

            if (!name || !email || !password || !confirm) {
                errorEl.textContent = 'Please fill in all fields.';
                errorEl.style.display = 'block';
                return;
            }
            if (password !== confirm) {
                errorEl.textContent = 'Passwords do not match.';
                errorEl.style.display = 'block';
                return;
            }
            if (password.length < 6) {
                errorEl.textContent = 'Password must be at least 6 characters.';
                errorEl.style.display = 'block';
                return;
            }

            let users = JSON.parse(localStorage.getItem('fb_dash_users') || '[]');
            if (users.find(u => u.email === email)) {
                errorEl.textContent = 'An account with this email already exists.';
                errorEl.style.display = 'block';
                return;
            }

            users.push({ name, email, password });
            localStorage.setItem('fb_dash_users', JSON.stringify(users));
            localStorage.setItem('fb_dash_session', JSON.stringify({ name, email }));
            showDashboard({ name, email });
        }

        function handleGoogleSSO() {
            alert('Google SSO requires a backend server with OAuth configuration. This feature is not available on static hosting.');
        }

        function showDashboard(user) {
            document.getElementById('auth-screen').style.display = 'none';
            document.querySelector('.sidebar').style.display = '';
            document.querySelector('.main-content').style.display = '';

            // Update avatar initials
            const initials = user.name.split(' ').map(w => w[0]).join('').toUpperCase().slice(0, 2);
            document.getElementById('userAvatar').textContent = initials;
            document.getElementById('user-menu-email').textContent = user.email;
        }

        function signOut() {
            localStorage.removeItem('fb_dash_session');
            document.getElementById('auth-screen').style.display = 'flex';
            document.querySelector('.sidebar').style.display = 'none';
            document.querySelector('.main-content').style.display = 'none';
            document.getElementById('userMenuDropdown').classList.remove('show');
            // Clear form fields
            document.getElementById('login-email').value = '';
            document.getElementById('login-password').value = '';
            showLogin();
        }

        function toggleUserMenu() {
            document.getElementById('userMenuDropdown').classList.toggle('show');
        }

        // Close user menu on outside click
        document.addEventListener('click', function(e) {
            const wrapper = document.querySelector('.user-menu-wrapper');
            if (wrapper && !wrapper.contains(e.target)) {
                document.getElementById('userMenuDropdown').classList.remove('show');
            }
        });

        // Allow Enter key on login/signup forms
        document.getElementById('login-password').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') handleLogin();
        });
        document.getElementById('signup-confirm').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') handleSignup();
        });

        // Auth check on page load
        (function initAuth() {
            const session = JSON.parse(localStorage.getItem('fb_dash_session') || 'null');
            if (session) {
                showDashboard(session);
            } else {
                document.getElementById('auth-screen').style.display = 'flex';
                document.querySelector('.sidebar').style.display = 'none';
                document.querySelector('.main-content').style.display = 'none';
            }
        })();

        // Initialize dashboard with current account data and filters on page load
        (function initializeDashboard() {
            const data = accountData[currentAccount];

            // Apply initial filter colors
            const campaignsFilter = document.getElementById('campaigns-status-filter');
            const adSetsFilter = document.getElementById('adsets-status-filter');
            const adsFilter = document.getElementById('ads-status-filter');

            updateFilterColor(campaignsFilter);
            updateFilterColor(adSetsFilter);
            updateFilterColor(adsFilter);

            // Populate filter dropdowns and apply initial filters
            populateFilterDropdowns();
            applyCampaignsFilter();
            applyAdSetsFilter();
            applyAdsFilter();

            // Update other sections
            updateMetricsCards(data.metrics);
            updateTimeBasedTables(data.timeBasedMetrics);
            updateCountriesTable(data.countries);
            updateAlerts(data.alerts, data.name);
            updateRecentSales(data.recentSales);
            updateRevenueCards(data);
            updateRevenueTransactions(data);
            updateLeadsData(data);

            // Initialize webhooks
            renderWebhooks();
        })();

        // Creative Preview Modal Functionality
        (function() {
            const modal = document.getElementById('creative-preview-modal');
            const modalImage = document.getElementById('creative-preview-image');
            const modalClose = document.querySelector('.creative-modal-close');

            // Open modal when clicking on creative thumbnail
            document.querySelectorAll('.creative-thumbnail').forEach(thumbnail => {
                thumbnail.addEventListener('click', function() {
                    const previewUrl = this.getAttribute('data-preview');
                    if (previewUrl && modal && modalImage) {
                        modalImage.src = previewUrl;
                        modal.classList.add('show');
                    }
                });
            });

            // Close modal when clicking the close button
            if (modalClose) {
                modalClose.addEventListener('click', function() {
                    modal.classList.remove('show');
                });
            }

            // Close modal when clicking outside the image
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        modal.classList.remove('show');
                    }
                });
            }

            // Close modal with Escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && modal && modal.classList.contains('show')) {
                    modal.classList.remove('show');
                }
            });
        })();

    </script>
</body>
</html>
